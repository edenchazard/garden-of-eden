var Hd=Object.create;var ha=Object.defineProperty;var Gd=Object.getOwnPropertyDescriptor;var Vd=Object.getOwnPropertyNames;var Qd=Object.getPrototypeOf,Yd=Object.prototype.hasOwnProperty;var Z=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var da=(e,t)=>()=>(e&&(t=e(e=0)),t);var D=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Xd=(e,t)=>{for(var r in t)ha(e,r,{get:t[r],enumerable:!0})},Jd=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Vd(t))!Yd.call(e,a)&&a!==r&&ha(e,a,{get:()=>t[a],enumerable:!(o=Gd(t,a))||o.enumerable});return e};var qc=(e,t,r)=>(r=e!=null?Hd(Qd(e)):{},Jd(t||!e||!e.__esModule?ha(r,"default",{value:e,enumerable:!0}):r,e));var Ge=D((Aw,Oc)=>{"use strict";var Lc=function(e){return typeof e<"u"&&e!==null},Kd=function(e){return typeof e=="object"},Zd=function(e){return Object.prototype.toString.call(e)==="[object Object]"},em=function(e){return typeof e=="function"},tm=function(e){return typeof e=="boolean"},rm=function(e){return e instanceof Buffer},nm=function(e){if(Lc(e))switch(e.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},om=function(e){return e instanceof ArrayBuffer},im=function(e){return typeof e=="string"&&e.length>0},am=function(e){return typeof e=="number"&&!Number.isNaN(e)},sm=function(e){return Number.isInteger(e)},lm=function(e,t,r){return e>=t&&e<=r},cm=function(e,t){return t.includes(e)},um=function(e,t,r){return new Error(`Expected ${t} for ${e} but received ${r} of type ${typeof r}`)},fm=function(e,t){return t.message=e.message,t};Oc.exports={defined:Lc,object:Kd,plainObject:Zd,fn:em,bool:tm,buffer:rm,typedArray:nm,arrayBuffer:om,string:im,number:am,integer:sm,inRange:lm,inArray:cm,invalidParameterError:um,nativeError:fm}});var $c=D((Cw,Fc)=>{"use strict";var jc=()=>process.platform==="linux",io=null,hm=()=>{if(!io)if(jc()&&process.report){let e=process.report.excludeNetwork;process.report.excludeNetwork=!0,io=process.report.getReport(),process.report.excludeNetwork=e}else io={};return io};Fc.exports={isLinux:jc,getReport:hm}});var Mc=D((xw,Nc)=>{"use strict";var Dc=Z("fs"),dm="/usr/bin/ldd",mm=e=>Dc.readFileSync(e,"utf-8"),pm=e=>new Promise((t,r)=>{Dc.readFile(e,"utf-8",(o,a)=>{o?r(o):t(a)})});Nc.exports={LDD_PATH:dm,readFileSync:mm,readFile:pm}});var so=D((Iw,ou)=>{"use strict";var zc=Z("child_process"),{isLinux:yr,getReport:Uc}=$c(),{LDD_PATH:ao,readFile:Hc,readFileSync:Gc}=Mc(),Ve,Qe,Vc="getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true",xt="",Qc=()=>xt||new Promise(e=>{zc.exec(Vc,(t,r)=>{xt=t?" ":r,e(xt)})}),Yc=()=>{if(!xt)try{xt=zc.execSync(Vc,{encoding:"utf8"})}catch{xt=" "}return xt},It="glibc",Xc=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,br="musl",gm=e=>e.includes("libc.musl-")||e.includes("ld-musl-"),Jc=()=>{let e=Uc();return e.header&&e.header.glibcVersionRuntime?It:Array.isArray(e.sharedObjects)&&e.sharedObjects.some(gm)?br:null},Kc=e=>{let[t,r]=e.split(/[\r\n]+/);return t&&t.includes(It)?It:r&&r.includes(br)?br:null},Zc=e=>e.includes("musl")?br:e.includes("GNU C Library")?It:null,bm=async()=>{if(Ve!==void 0)return Ve;Ve=null;try{let e=await Hc(ao);Ve=Zc(e)}catch{}return Ve},ym=()=>{if(Ve!==void 0)return Ve;Ve=null;try{let e=Gc(ao);Ve=Zc(e)}catch{}return Ve},eu=async()=>{let e=null;if(yr()&&(e=await bm(),e||(e=Jc()),!e)){let t=await Qc();e=Kc(t)}return e},tu=()=>{let e=null;if(yr()&&(e=ym(),e||(e=Jc()),!e)){let t=Yc();e=Kc(t)}return e},wm=async()=>yr()&&await eu()!==It,vm=()=>yr()&&tu()!==It,Em=async()=>{if(Qe!==void 0)return Qe;Qe=null;try{let t=(await Hc(ao)).match(Xc);t&&(Qe=t[1])}catch{}return Qe},Sm=()=>{if(Qe!==void 0)return Qe;Qe=null;try{let t=Gc(ao).match(Xc);t&&(Qe=t[1])}catch{}return Qe},ru=()=>{let e=Uc();return e.header&&e.header.glibcVersionRuntime?e.header.glibcVersionRuntime:null},Wc=e=>e.trim().split(/\s+/)[1],nu=e=>{let[t,r,o]=e.split(/[\r\n]+/);return t&&t.includes(It)?Wc(t):r&&o&&r.includes(br)?Wc(o):null},_m=async()=>{let e=null;if(yr()&&(e=await Em(),e||(e=ru()),!e)){let t=await Qc();e=nu(t)}return e},Rm=()=>{let e=null;if(yr()&&(e=Sm(),e||(e=ru()),!e)){let t=Yc();e=nu(t)}return e};ou.exports={GLIBC:It,MUSL:br,family:eu,familySync:tu,isNonGlibcLinux:wm,isNonGlibcLinuxSync:vm,version:_m,versionSync:Rm}});var an=D((kw,iu)=>{var Pm=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};iu.exports=Pm});var lo=D((Bw,au)=>{var Tm="2.0.0",Am=Number.MAX_SAFE_INTEGER||9007199254740991,Cm=16,xm=250,Im=["major","premajor","minor","preminor","patch","prepatch","prerelease"];au.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Cm,MAX_SAFE_BUILD_LENGTH:xm,MAX_SAFE_INTEGER:Am,RELEASE_TYPES:Im,SEMVER_SPEC_VERSION:Tm,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var sn=D((ft,su)=>{var{MAX_SAFE_COMPONENT_LENGTH:ma,MAX_SAFE_BUILD_LENGTH:km,MAX_LENGTH:Bm}=lo(),qm=an();ft=su.exports={};var Lm=ft.re=[],Om=ft.safeRe=[],A=ft.src=[],C=ft.t={},jm=0,pa="[a-zA-Z0-9-]",Fm=[["\\s",1],["\\d",Bm],[pa,km]],$m=e=>{for(let[t,r]of Fm)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e},W=(e,t,r)=>{let o=$m(t),a=jm++;qm(e,a,t),C[e]=a,A[a]=t,Lm[a]=new RegExp(t,r?"g":void 0),Om[a]=new RegExp(o,r?"g":void 0)};W("NUMERICIDENTIFIER","0|[1-9]\\d*");W("NUMERICIDENTIFIERLOOSE","\\d+");W("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${pa}*`);W("MAINVERSION",`(${A[C.NUMERICIDENTIFIER]})\\.(${A[C.NUMERICIDENTIFIER]})\\.(${A[C.NUMERICIDENTIFIER]})`);W("MAINVERSIONLOOSE",`(${A[C.NUMERICIDENTIFIERLOOSE]})\\.(${A[C.NUMERICIDENTIFIERLOOSE]})\\.(${A[C.NUMERICIDENTIFIERLOOSE]})`);W("PRERELEASEIDENTIFIER",`(?:${A[C.NUMERICIDENTIFIER]}|${A[C.NONNUMERICIDENTIFIER]})`);W("PRERELEASEIDENTIFIERLOOSE",`(?:${A[C.NUMERICIDENTIFIERLOOSE]}|${A[C.NONNUMERICIDENTIFIER]})`);W("PRERELEASE",`(?:-(${A[C.PRERELEASEIDENTIFIER]}(?:\\.${A[C.PRERELEASEIDENTIFIER]})*))`);W("PRERELEASELOOSE",`(?:-?(${A[C.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${A[C.PRERELEASEIDENTIFIERLOOSE]})*))`);W("BUILDIDENTIFIER",`${pa}+`);W("BUILD",`(?:\\+(${A[C.BUILDIDENTIFIER]}(?:\\.${A[C.BUILDIDENTIFIER]})*))`);W("FULLPLAIN",`v?${A[C.MAINVERSION]}${A[C.PRERELEASE]}?${A[C.BUILD]}?`);W("FULL",`^${A[C.FULLPLAIN]}$`);W("LOOSEPLAIN",`[v=\\s]*${A[C.MAINVERSIONLOOSE]}${A[C.PRERELEASELOOSE]}?${A[C.BUILD]}?`);W("LOOSE",`^${A[C.LOOSEPLAIN]}$`);W("GTLT","((?:<|>)?=?)");W("XRANGEIDENTIFIERLOOSE",`${A[C.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);W("XRANGEIDENTIFIER",`${A[C.NUMERICIDENTIFIER]}|x|X|\\*`);W("XRANGEPLAIN",`[v=\\s]*(${A[C.XRANGEIDENTIFIER]})(?:\\.(${A[C.XRANGEIDENTIFIER]})(?:\\.(${A[C.XRANGEIDENTIFIER]})(?:${A[C.PRERELEASE]})?${A[C.BUILD]}?)?)?`);W("XRANGEPLAINLOOSE",`[v=\\s]*(${A[C.XRANGEIDENTIFIERLOOSE]})(?:\\.(${A[C.XRANGEIDENTIFIERLOOSE]})(?:\\.(${A[C.XRANGEIDENTIFIERLOOSE]})(?:${A[C.PRERELEASELOOSE]})?${A[C.BUILD]}?)?)?`);W("XRANGE",`^${A[C.GTLT]}\\s*${A[C.XRANGEPLAIN]}$`);W("XRANGELOOSE",`^${A[C.GTLT]}\\s*${A[C.XRANGEPLAINLOOSE]}$`);W("COERCEPLAIN",`(^|[^\\d])(\\d{1,${ma}})(?:\\.(\\d{1,${ma}}))?(?:\\.(\\d{1,${ma}}))?`);W("COERCE",`${A[C.COERCEPLAIN]}(?:$|[^\\d])`);W("COERCEFULL",A[C.COERCEPLAIN]+`(?:${A[C.PRERELEASE]})?(?:${A[C.BUILD]})?(?:$|[^\\d])`);W("COERCERTL",A[C.COERCE],!0);W("COERCERTLFULL",A[C.COERCEFULL],!0);W("LONETILDE","(?:~>?)");W("TILDETRIM",`(\\s*)${A[C.LONETILDE]}\\s+`,!0);ft.tildeTrimReplace="$1~";W("TILDE",`^${A[C.LONETILDE]}${A[C.XRANGEPLAIN]}$`);W("TILDELOOSE",`^${A[C.LONETILDE]}${A[C.XRANGEPLAINLOOSE]}$`);W("LONECARET","(?:\\^)");W("CARETTRIM",`(\\s*)${A[C.LONECARET]}\\s+`,!0);ft.caretTrimReplace="$1^";W("CARET",`^${A[C.LONECARET]}${A[C.XRANGEPLAIN]}$`);W("CARETLOOSE",`^${A[C.LONECARET]}${A[C.XRANGEPLAINLOOSE]}$`);W("COMPARATORLOOSE",`^${A[C.GTLT]}\\s*(${A[C.LOOSEPLAIN]})$|^$`);W("COMPARATOR",`^${A[C.GTLT]}\\s*(${A[C.FULLPLAIN]})$|^$`);W("COMPARATORTRIM",`(\\s*)${A[C.GTLT]}\\s*(${A[C.LOOSEPLAIN]}|${A[C.XRANGEPLAIN]})`,!0);ft.comparatorTrimReplace="$1$2$3";W("HYPHENRANGE",`^\\s*(${A[C.XRANGEPLAIN]})\\s+-\\s+(${A[C.XRANGEPLAIN]})\\s*$`);W("HYPHENRANGELOOSE",`^\\s*(${A[C.XRANGEPLAINLOOSE]})\\s+-\\s+(${A[C.XRANGEPLAINLOOSE]})\\s*$`);W("STAR","(<|>)?=?\\s*\\*");W("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");W("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var co=D((qw,lu)=>{var Dm=Object.freeze({loose:!0}),Nm=Object.freeze({}),Mm=e=>e?typeof e!="object"?Dm:e:Nm;lu.exports=Mm});var hu=D((Lw,fu)=>{var cu=/^[0-9]+$/,uu=(e,t)=>{let r=cu.test(e),o=cu.test(t);return r&&o&&(e=+e,t=+t),e===t?0:r&&!o?-1:o&&!r?1:e<t?-1:1},Wm=(e,t)=>uu(t,e);fu.exports={compareIdentifiers:uu,rcompareIdentifiers:Wm}});var vr=D((Ow,gu)=>{var uo=an(),{MAX_LENGTH:du,MAX_SAFE_INTEGER:fo}=lo(),{safeRe:mu,t:pu}=sn(),zm=co(),{compareIdentifiers:wr}=hu(),ga=class e{constructor(t,r){if(r=zm(r),t instanceof e){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>du)throw new TypeError(`version is longer than ${du} characters`);uo("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let o=t.trim().match(r.loose?mu[pu.LOOSE]:mu[pu.FULL]);if(!o)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+o[1],this.minor=+o[2],this.patch=+o[3],this.major>fo||this.major<0)throw new TypeError("Invalid major version");if(this.minor>fo||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>fo||this.patch<0)throw new TypeError("Invalid patch version");o[4]?this.prerelease=o[4].split(".").map(a=>{if(/^[0-9]+$/.test(a)){let s=+a;if(s>=0&&s<fo)return s}return a}):this.prerelease=[],this.build=o[5]?o[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(uo("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if(typeof t=="string"&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),wr(this.major,t.major)||wr(this.minor,t.minor)||wr(this.patch,t.patch)}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{let o=this.prerelease[r],a=t.prerelease[r];if(uo("prerelease compare",r,o,a),o===void 0&&a===void 0)return 0;if(a===void 0)return 1;if(o===void 0)return-1;if(o===a)continue;return wr(o,a)}while(++r)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let r=0;do{let o=this.build[r],a=t.build[r];if(uo("build compare",r,o,a),o===void 0&&a===void 0)return 0;if(a===void 0)return 1;if(o===void 0)return-1;if(o===a)continue;return wr(o,a)}while(++r)}inc(t,r,o){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,o);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,o);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,o),this.inc("pre",r,o);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,o),this.inc("pre",r,o);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let a=Number(o)?1:0;if(!r&&o===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[a];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(r===this.prerelease.join(".")&&o===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(a)}}if(r){let s=[r,a];o===!1&&(s=[r]),wr(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};gu.exports=ga});var wu=D((jw,yu)=>{var bu=vr(),Um=(e,t,r=!1)=>{if(e instanceof bu)return e;try{return new bu(e,t)}catch(o){if(!r)return null;throw o}};yu.exports=Um});var Eu=D((Fw,vu)=>{var Hm=vr(),Gm=wu(),{safeRe:ho,t:mo}=sn(),Vm=(e,t)=>{if(e instanceof Hm)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let r=null;if(!t.rtl)r=e.match(t.includePrerelease?ho[mo.COERCEFULL]:ho[mo.COERCE]);else{let m=t.includePrerelease?ho[mo.COERCERTLFULL]:ho[mo.COERCERTL],g;for(;(g=m.exec(e))&&(!r||r.index+r[0].length!==e.length);)(!r||g.index+g[0].length!==r.index+r[0].length)&&(r=g),m.lastIndex=g.index+g[1].length+g[2].length;m.lastIndex=-1}if(r===null)return null;let o=r[2],a=r[3]||"0",s=r[4]||"0",c=t.includePrerelease&&r[5]?`-${r[5]}`:"",f=t.includePrerelease&&r[6]?`+${r[6]}`:"";return Gm(`${o}.${a}.${s}${c}${f}`,t)};vu.exports=Vm});var Vt=D(($w,_u)=>{var Su=vr(),Qm=(e,t,r)=>new Su(e,r).compare(new Su(t,r));_u.exports=Qm});var ba=D((Dw,Ru)=>{var Ym=Vt(),Xm=(e,t,r)=>Ym(e,t,r)>=0;Ru.exports=Xm});var Tu=D((Nw,Pu)=>{var ya=class{constructor(){this.max=1e3,this.map=new Map}get(t){let r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){let a=this.map.keys().next().value;this.delete(a)}this.map.set(t,r)}return this}};Pu.exports=ya});var Cu=D((Mw,Au)=>{var Jm=Vt(),Km=(e,t,r)=>Jm(e,t,r)===0;Au.exports=Km});var Iu=D((Ww,xu)=>{var Zm=Vt(),ep=(e,t,r)=>Zm(e,t,r)!==0;xu.exports=ep});var Bu=D((zw,ku)=>{var tp=Vt(),rp=(e,t,r)=>tp(e,t,r)>0;ku.exports=rp});var Lu=D((Uw,qu)=>{var np=Vt(),op=(e,t,r)=>np(e,t,r)<0;qu.exports=op});var ju=D((Hw,Ou)=>{var ip=Vt(),ap=(e,t,r)=>ip(e,t,r)<=0;Ou.exports=ap});var $u=D((Gw,Fu)=>{var sp=Cu(),lp=Iu(),cp=Bu(),up=ba(),fp=Lu(),hp=ju(),dp=(e,t,r,o)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return sp(e,r,o);case"!=":return lp(e,r,o);case">":return cp(e,r,o);case">=":return up(e,r,o);case"<":return fp(e,r,o);case"<=":return hp(e,r,o);default:throw new TypeError(`Invalid operator: ${t}`)}};Fu.exports=dp});var Hu=D((Vw,Uu)=>{var ln=Symbol("SemVer ANY"),Ea=class e{static get ANY(){return ln}constructor(t,r){if(r=Du(r),t instanceof e){if(t.loose===!!r.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),va("comparator",t,r),this.options=r,this.loose=!!r.loose,this.parse(t),this.semver===ln?this.value="":this.value=this.operator+this.semver.version,va("comp",this)}parse(t){let r=this.options.loose?Nu[Mu.COMPARATORLOOSE]:Nu[Mu.COMPARATOR],o=t.match(r);if(!o)throw new TypeError(`Invalid comparator: ${t}`);this.operator=o[1]!==void 0?o[1]:"",this.operator==="="&&(this.operator=""),o[2]?this.semver=new Wu(o[2],this.options.loose):this.semver=ln}toString(){return this.value}test(t){if(va("Comparator.test",t,this.options.loose),this.semver===ln||t===ln)return!0;if(typeof t=="string")try{t=new Wu(t,this.options)}catch{return!1}return wa(t,this.operator,this.semver,this.options)}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new zu(t.value,r).test(this.value):t.operator===""?t.value===""?!0:new zu(this.value,r).test(t.semver):(r=Du(r),r.includePrerelease&&(this.value==="<0.0.0-0"||t.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||wa(this.semver,"<",t.semver,r)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||wa(this.semver,">",t.semver,r)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}};Uu.exports=Ea;var Du=co(),{safeRe:Nu,t:Mu}=sn(),wa=$u(),va=an(),Wu=vr(),zu=Sa()});var Sa=D((Qw,Yu)=>{var mp=/\s+/g,_a=class e{constructor(t,r){if(r=gp(r),t instanceof e)return t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease?t:new e(t.raw,r);if(t instanceof Ra)return this.raw=t.value,this.set=[[t]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=t.trim().replace(mp," "),this.set=this.raw.split("||").map(o=>this.parseRange(o.trim())).filter(o=>o.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let o=this.set[0];if(this.set=this.set.filter(a=>!Vu(a[0])),this.set.length===0)this.set=[o];else if(this.set.length>1){for(let a of this.set)if(a.length===1&&_p(a[0])){this.set=[a];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let t=0;t<this.set.length;t++){t>0&&(this.formatted+="||");let r=this.set[t];for(let o=0;o<r.length;o++)o>0&&(this.formatted+=" "),this.formatted+=r[o].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(t){let o=((this.options.includePrerelease&&Ep)|(this.options.loose&&Sp))+":"+t,a=Gu.get(o);if(a)return a;let s=this.options.loose,c=s?_e[ge.HYPHENRANGELOOSE]:_e[ge.HYPHENRANGE];t=t.replace(c,qp(this.options.includePrerelease)),re("hyphen replace",t),t=t.replace(_e[ge.COMPARATORTRIM],yp),re("comparator trim",t),t=t.replace(_e[ge.TILDETRIM],wp),re("tilde trim",t),t=t.replace(_e[ge.CARETTRIM],vp),re("caret trim",t);let f=t.split(" ").map(y=>Rp(y,this.options)).join(" ").split(/\s+/).map(y=>Bp(y,this.options));s&&(f=f.filter(y=>(re("loose invalid filter",y,this.options),!!y.match(_e[ge.COMPARATORLOOSE])))),re("range list",f);let m=new Map,g=f.map(y=>new Ra(y,this.options));for(let y of g){if(Vu(y))return[y];m.set(y.value,y)}m.size>1&&m.has("")&&m.delete("");let p=[...m.values()];return Gu.set(o,p),p}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some(o=>Qu(o,r)&&t.set.some(a=>Qu(a,r)&&o.every(s=>a.every(c=>s.intersects(c,r)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new bp(t,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(Lp(this.set[r],t,this.options))return!0;return!1}};Yu.exports=_a;var pp=Tu(),Gu=new pp,gp=co(),Ra=Hu(),re=an(),bp=vr(),{safeRe:_e,t:ge,comparatorTrimReplace:yp,tildeTrimReplace:wp,caretTrimReplace:vp}=sn(),{FLAG_INCLUDE_PRERELEASE:Ep,FLAG_LOOSE:Sp}=lo(),Vu=e=>e.value==="<0.0.0-0",_p=e=>e.value==="",Qu=(e,t)=>{let r=!0,o=e.slice(),a=o.pop();for(;r&&o.length;)r=o.every(s=>a.intersects(s,t)),a=o.pop();return r},Rp=(e,t)=>(re("comp",e,t),e=Ap(e,t),re("caret",e),e=Pp(e,t),re("tildes",e),e=xp(e,t),re("xrange",e),e=kp(e,t),re("stars",e),e),be=e=>!e||e.toLowerCase()==="x"||e==="*",Pp=(e,t)=>e.trim().split(/\s+/).map(r=>Tp(r,t)).join(" "),Tp=(e,t)=>{let r=t.loose?_e[ge.TILDELOOSE]:_e[ge.TILDE];return e.replace(r,(o,a,s,c,f)=>{re("tilde",e,o,a,s,c,f);let m;return be(a)?m="":be(s)?m=`>=${a}.0.0 <${+a+1}.0.0-0`:be(c)?m=`>=${a}.${s}.0 <${a}.${+s+1}.0-0`:f?(re("replaceTilde pr",f),m=`>=${a}.${s}.${c}-${f} <${a}.${+s+1}.0-0`):m=`>=${a}.${s}.${c} <${a}.${+s+1}.0-0`,re("tilde return",m),m})},Ap=(e,t)=>e.trim().split(/\s+/).map(r=>Cp(r,t)).join(" "),Cp=(e,t)=>{re("caret",e,t);let r=t.loose?_e[ge.CARETLOOSE]:_e[ge.CARET],o=t.includePrerelease?"-0":"";return e.replace(r,(a,s,c,f,m)=>{re("caret",e,a,s,c,f,m);let g;return be(s)?g="":be(c)?g=`>=${s}.0.0${o} <${+s+1}.0.0-0`:be(f)?s==="0"?g=`>=${s}.${c}.0${o} <${s}.${+c+1}.0-0`:g=`>=${s}.${c}.0${o} <${+s+1}.0.0-0`:m?(re("replaceCaret pr",m),s==="0"?c==="0"?g=`>=${s}.${c}.${f}-${m} <${s}.${c}.${+f+1}-0`:g=`>=${s}.${c}.${f}-${m} <${s}.${+c+1}.0-0`:g=`>=${s}.${c}.${f}-${m} <${+s+1}.0.0-0`):(re("no pr"),s==="0"?c==="0"?g=`>=${s}.${c}.${f}${o} <${s}.${c}.${+f+1}-0`:g=`>=${s}.${c}.${f}${o} <${s}.${+c+1}.0-0`:g=`>=${s}.${c}.${f} <${+s+1}.0.0-0`),re("caret return",g),g})},xp=(e,t)=>(re("replaceXRanges",e,t),e.split(/\s+/).map(r=>Ip(r,t)).join(" ")),Ip=(e,t)=>{e=e.trim();let r=t.loose?_e[ge.XRANGELOOSE]:_e[ge.XRANGE];return e.replace(r,(o,a,s,c,f,m)=>{re("xRange",e,o,a,s,c,f,m);let g=be(s),p=g||be(c),y=p||be(f),E=y;return a==="="&&E&&(a=""),m=t.includePrerelease?"-0":"",g?a===">"||a==="<"?o="<0.0.0-0":o="*":a&&E?(p&&(c=0),f=0,a===">"?(a=">=",p?(s=+s+1,c=0,f=0):(c=+c+1,f=0)):a==="<="&&(a="<",p?s=+s+1:c=+c+1),a==="<"&&(m="-0"),o=`${a+s}.${c}.${f}${m}`):p?o=`>=${s}.0.0${m} <${+s+1}.0.0-0`:y&&(o=`>=${s}.${c}.0${m} <${s}.${+c+1}.0-0`),re("xRange return",o),o})},kp=(e,t)=>(re("replaceStars",e,t),e.trim().replace(_e[ge.STAR],"")),Bp=(e,t)=>(re("replaceGTE0",e,t),e.trim().replace(_e[t.includePrerelease?ge.GTE0PRE:ge.GTE0],"")),qp=e=>(t,r,o,a,s,c,f,m,g,p,y,E)=>(be(o)?r="":be(a)?r=`>=${o}.0.0${e?"-0":""}`:be(s)?r=`>=${o}.${a}.0${e?"-0":""}`:c?r=`>=${r}`:r=`>=${r}${e?"-0":""}`,be(g)?m="":be(p)?m=`<${+g+1}.0.0-0`:be(y)?m=`<${g}.${+p+1}.0-0`:E?m=`<=${g}.${p}.${y}-${E}`:e?m=`<${g}.${p}.${+y+1}-0`:m=`<=${m}`,`${r} ${m}`.trim()),Lp=(e,t,r)=>{for(let o=0;o<e.length;o++)if(!e[o].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let o=0;o<e.length;o++)if(re(e[o].semver),e[o].semver!==Ra.ANY&&e[o].semver.prerelease.length>0){let a=e[o].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch)return!0}return!1}return!0}});var Ju=D((Yw,Xu)=>{var Op=Sa(),jp=(e,t,r)=>{try{t=new Op(t,r)}catch{return!1}return t.test(e)};Xu.exports=jp});var Pa=D((Xw,Fp)=>{Fp.exports={name:"sharp",description:"High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images",version:"0.33.5",author:"Lovell Fuller <npm@lovell.info>",homepage:"https://sharp.pixelplumbing.com",contributors:["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unneb\xE4ck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix B\xFCnemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","J\xE9r\xE9my Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kot\u011B\u0161ovec <jarda.kotesovec@gmail.com>","Kenric D'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Chouci\xF1o <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugu\xE9 <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com>","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>","Dennis Beatty <dennis@dcbeatty.com>","Ingvar Stepanyan <me@rreverser.com>","Don Denton <don@happycollision.com>"],scripts:{install:"node install/check",clean:"rm -rf src/build/ .nyc_output/ coverage/ test/fixtures/output.*",test:"npm run test-lint && npm run test-unit && npm run test-licensing && npm run test-types","test-lint":"semistandard && cpplint","test-unit":"nyc --reporter=lcov --reporter=text --check-coverage --branches=100 mocha","test-licensing":'license-checker --production --summary --onlyAllow="Apache-2.0;BSD;ISC;LGPL-3.0-or-later;MIT"',"test-leak":"./test/leak/leak.sh","test-types":"tsd","package-from-local-build":"node npm/from-local-build","package-from-github-release":"node npm/from-github-release","docs-build":"node docs/build && node docs/search-index/build","docs-serve":"cd docs && npx serve","docs-publish":"cd docs && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},type:"commonjs",main:"lib/index.js",types:"lib/index.d.ts",files:["install","lib","src/*.{cc,h,gyp}"],repository:{type:"git",url:"git://github.com/lovell/sharp.git"},keywords:["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],dependencies:{color:"^4.2.3","detect-libc":"^2.0.3",semver:"^7.6.3"},optionalDependencies:{"@img/sharp-darwin-arm64":"0.33.5","@img/sharp-darwin-x64":"0.33.5","@img/sharp-libvips-darwin-arm64":"1.0.4","@img/sharp-libvips-darwin-x64":"1.0.4","@img/sharp-libvips-linux-arm":"1.0.5","@img/sharp-libvips-linux-arm64":"1.0.4","@img/sharp-libvips-linux-s390x":"1.0.4","@img/sharp-libvips-linux-x64":"1.0.4","@img/sharp-libvips-linuxmusl-arm64":"1.0.4","@img/sharp-libvips-linuxmusl-x64":"1.0.4","@img/sharp-linux-arm":"0.33.5","@img/sharp-linux-arm64":"0.33.5","@img/sharp-linux-s390x":"0.33.5","@img/sharp-linux-x64":"0.33.5","@img/sharp-linuxmusl-arm64":"0.33.5","@img/sharp-linuxmusl-x64":"0.33.5","@img/sharp-wasm32":"0.33.5","@img/sharp-win32-ia32":"0.33.5","@img/sharp-win32-x64":"0.33.5"},devDependencies:{"@emnapi/runtime":"^1.2.0","@img/sharp-libvips-dev":"1.0.4","@img/sharp-libvips-dev-wasm32":"1.0.5","@img/sharp-libvips-win32-ia32":"1.0.4","@img/sharp-libvips-win32-x64":"1.0.4","@types/node":"*",async:"^3.2.5",cc:"^3.0.1",emnapi:"^1.2.0","exif-reader":"^2.0.1","extract-zip":"^2.0.1",icc:"^3.0.0","jsdoc-to-markdown":"^8.0.3","license-checker":"^25.0.1",mocha:"^10.7.3","node-addon-api":"^8.1.0",nyc:"^17.0.0",prebuild:"^13.0.1",semistandard:"^17.0.0","tar-fs":"^3.0.6",tsd:"^0.31.1"},license:"Apache-2.0",engines:{node:"^18.17.0 || ^20.3.0 || >=21.0.0"},config:{libvips:">=8.15.3"},funding:{url:"https://opencollective.com/libvips"},binary:{napi_versions:[9]},semistandard:{env:["mocha"]},cc:{linelength:"120",filter:["build/include"]},nyc:{include:["lib"]},tsd:{directory:"test/types/"}}});var Aa=D((Jw,lf)=>{"use strict";var{spawnSync:po}=Z("node:child_process"),{createHash:$p}=Z("node:crypto"),tf=Eu(),Dp=ba(),Np=Ju(),Ku=so(),{config:Mp,engines:Zu,optionalDependencies:Wp}=Pa(),zp=process.env.npm_package_config_libvips||Mp.libvips,rf=tf(zp).version,Up=["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-ia32","win32-x64"],go={encoding:"utf8",shell:!0},Hp=e=>{e instanceof Error?console.error(`sharp: Installation error: ${e.message}`):console.log(`sharp: ${e}`)},nf=()=>Ku.isNonGlibcLinuxSync()?Ku.familySync():"",Gp=()=>`${process.platform}${nf()}-${process.arch}`,Er=()=>{if(of())return"wasm32";let{npm_config_arch:e,npm_config_platform:t,npm_config_libc:r}=process.env,o=typeof r=="string"?r:nf();return`${t||process.platform}${o}-${e||process.arch}`},Vp=()=>{try{return Z(`@img/sharp-libvips-dev-${Er()}/include`)}catch{try{return Z("@img/sharp-libvips-dev/include")}catch{}}return""},Qp=()=>{try{return Z("@img/sharp-libvips-dev/cplusplus")}catch{}return""},Yp=()=>{try{return Z(`@img/sharp-libvips-dev-${Er()}/lib`)}catch{try{return Z(`@img/sharp-libvips-${Er()}/lib`)}catch{}}return""},Xp=()=>{if(process.release?.name==="node"&&process.versions&&!Np(process.versions.node,Zu.node))return{found:process.versions.node,expected:Zu.node}},of=()=>{let{CC:e}=process.env;return!!(e&&e.endsWith("/emcc"))},Jp=()=>process.platform==="darwin"&&process.arch==="x64"?(po("sysctl sysctl.proc_translated",go).stdout||"").trim()==="sysctl.proc_translated: 1":!1,ef=e=>$p("sha512").update(e).digest("hex"),Kp=()=>{try{let e=ef(`imgsharp-libvips-${Er()}`),t=tf(Wp[`@img/sharp-libvips-${Er()}`]).version;return ef(`${e}npm:${t}`).slice(0,10)}catch{}return""},Zp=()=>po(`node-gyp rebuild --directory=src ${of()?"--nodedir=emscripten":""}`,{...go,stdio:"inherit"}).status,af=()=>process.platform!=="win32"?(po("pkg-config --modversion vips-cpp",{...go,env:{...process.env,PKG_CONFIG_PATH:sf()}}).stdout||"").trim():"",sf=()=>process.platform!=="win32"?[(po('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',go).stdout||"").trim(),process.env.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":"):"",Ta=(e,t,r)=>(r&&r(`Detected ${t}, skipping search for globally-installed libvips`),e),eg=e=>{if(process.env.SHARP_IGNORE_GLOBAL_LIBVIPS)return Ta(!1,"SHARP_IGNORE_GLOBAL_LIBVIPS",e);if(process.env.SHARP_FORCE_GLOBAL_LIBVIPS)return Ta(!0,"SHARP_FORCE_GLOBAL_LIBVIPS",e);if(Jp())return Ta(!1,"Rosetta",e);let t=af();return!!t&&Dp(t,rf)};lf.exports={minimumLibvipsVersion:rf,prebuiltPlatforms:Up,buildPlatformArch:Er,buildSharpLibvipsIncludeDir:Vp,buildSharpLibvipsCPlusPlusDir:Qp,buildSharpLibvipsLibDir:Yp,isUnsupportedNodeRuntime:Xp,runtimePlatformArch:Gp,log:Hp,yarnLocator:Kp,spawnRebuild:Zp,globalLibvipsVersion:af,pkgConfigPath:sf,useGlobalLibvips:eg}});var cn=D((Zw,uf)=>{"use strict";var{familySync:tg,versionSync:rg}=so(),{runtimePlatformArch:ng,isUnsupportedNodeRuntime:cf,prebuiltPlatforms:og,minimumLibvipsVersion:ig}=Aa(),Qt=ng(),ag=[`../src/build/Release/sharp-${Qt}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${Qt}/sharp.node`,"@img/sharp-wasm32/sharp.node"],Ca,bo=[];for(let e of ag)try{Ca=Z(e);break}catch(t){bo.push(t)}if(Ca)uf.exports=Ca;else{let[e,t,r]=["linux","darwin","win32"].map(s=>Qt.startsWith(s)),o=[`Could not load the "sharp" module using the ${Qt} runtime`];bo.forEach(s=>{s.code!=="MODULE_NOT_FOUND"&&o.push(`${s.code}: ${s.message}`)});let a=bo.map(s=>s.message).join(" ");if(o.push("Possible solutions:"),cf()){let{found:s,expected:c}=cf();o.push("- Please upgrade Node.js:",`    Found ${s}`,`    Requires ${c}`)}else if(og.includes(Qt)){let[s,c]=Qt.split("-"),f=s.endsWith("musl")?" --libc=musl":"";o.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${s.replace("musl","")}${f} --cpu=${c} sharp`)}else o.push(`- Manually install libvips >= ${ig}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32");if(e&&/(symbol not found|CXXABI_)/i.test(a))try{let{config:s}=Z(`@img/sharp-libvips-${Qt}/package`),c=`${tg()} ${rg()}`,f=`${s.musl?"musl":"glibc"} ${s.musl||s.glibc}`;o.push("- Update your OS:",`    Found ${c}`,`    Requires ${f}`)}catch{}throw e&&/\/snap\/core[0-9]{2}/.test(a)&&o.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node"),t&&/Incompatible library version/.test(a)&&o.push("- Update Homebrew:","    brew update && brew upgrade vips"),bo.some(s=>s.code==="ERR_DLOPEN_DISABLED")&&o.push("- Run Node.js without using the --no-addons flag"),r&&/The specified procedure could not be found/.test(a)&&o.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp"),o.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install"),new Error(o.join(`
`))}});var hf=D((tv,ff)=>{"use strict";var sg=Z("node:util"),xa=Z("node:stream"),lg=Ge();cn();var cg=sg.debuglog("sharp"),Yt=function(e,t){if(arguments.length===1&&!lg.defined(e))throw new Error("Invalid input");return this instanceof Yt?(xa.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],useExifOrientation:!1,angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBeforePreExtract:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tint:[-1,0,0,0],flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,precision:"integer",minAmpl:.2,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:-1,trimLineArt:!1,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:!0,resolveWithObject:!1,jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffPredictor:"horizontal",tiffPyramid:!1,tiffMiniswhite:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],debuglog:r=>{this.emit("warning",r),cg(r)},queueListener:function(r){Yt.queue.emit("change",r)}},this.options.input=this._createInputDescriptor(e,t,{allowStream:!0}),this):new Yt(e,t)};Object.setPrototypeOf(Yt.prototype,xa.Duplex.prototype);Object.setPrototypeOf(Yt,xa.Duplex);function ug(){let e=this.constructor.call(),{debuglog:t,queueListener:r,...o}=this.options;return e.options=structuredClone(o),e.options.debuglog=t,e.options.queueListener=r,this._isStreamInput()&&this.on("finish",()=>{this._flattenBufferIn(),e.options.input.buffer=this.options.input.buffer,e.emit("finish")}),e}Object.assign(Yt.prototype,{clone:ug});ff.exports=Yt});var Ia=D((rv,df)=>{"use strict";df.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var pf=D((nv,mf)=>{mf.exports=function(t){return!t||typeof t=="string"?!1:t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&t.constructor.name!=="String")}});var yf=D((ov,bf)=>{"use strict";var fg=pf(),hg=Array.prototype.concat,dg=Array.prototype.slice,gf=bf.exports=function(t){for(var r=[],o=0,a=t.length;o<a;o++){var s=t[o];fg(s)?r=hg.call(r,dg.call(s)):r.push(s)}return r};gf.wrap=function(e){return function(){return e(gf(arguments))}}});var Sf=D((iv,Ef)=>{var un=Ia(),fn=yf(),wf=Object.hasOwnProperty,vf=Object.create(null);for(yo in un)wf.call(un,yo)&&(vf[un[yo]]=yo);var yo,Ce=Ef.exports={to:{},get:{}};Ce.get=function(e){var t=e.substring(0,3).toLowerCase(),r,o;switch(t){case"hsl":r=Ce.get.hsl(e),o="hsl";break;case"hwb":r=Ce.get.hwb(e),o="hwb";break;default:r=Ce.get.rgb(e),o="rgb";break}return r?{model:o,value:r}:null};Ce.get.rgb=function(e){if(!e)return null;var t=/^#([a-f0-9]{3,4})$/i,r=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,o=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,a=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,s=/^(\w+)$/,c=[0,0,0,1],f,m,g;if(f=e.match(r)){for(g=f[2],f=f[1],m=0;m<3;m++){var p=m*2;c[m]=parseInt(f.slice(p,p+2),16)}g&&(c[3]=parseInt(g,16)/255)}else if(f=e.match(t)){for(f=f[1],g=f[3],m=0;m<3;m++)c[m]=parseInt(f[m]+f[m],16);g&&(c[3]=parseInt(g+g,16)/255)}else if(f=e.match(o)){for(m=0;m<3;m++)c[m]=parseInt(f[m+1],0);f[4]&&(f[5]?c[3]=parseFloat(f[4])*.01:c[3]=parseFloat(f[4]))}else if(f=e.match(a)){for(m=0;m<3;m++)c[m]=Math.round(parseFloat(f[m+1])*2.55);f[4]&&(f[5]?c[3]=parseFloat(f[4])*.01:c[3]=parseFloat(f[4]))}else return(f=e.match(s))?f[1]==="transparent"?[0,0,0,0]:wf.call(un,f[1])?(c=un[f[1]],c[3]=1,c):null:null;for(m=0;m<3;m++)c[m]=kt(c[m],0,255);return c[3]=kt(c[3],0,1),c};Ce.get.hsl=function(e){if(!e)return null;var t=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,r=e.match(t);if(r){var o=parseFloat(r[4]),a=(parseFloat(r[1])%360+360)%360,s=kt(parseFloat(r[2]),0,100),c=kt(parseFloat(r[3]),0,100),f=kt(isNaN(o)?1:o,0,1);return[a,s,c,f]}return null};Ce.get.hwb=function(e){if(!e)return null;var t=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,r=e.match(t);if(r){var o=parseFloat(r[4]),a=(parseFloat(r[1])%360+360)%360,s=kt(parseFloat(r[2]),0,100),c=kt(parseFloat(r[3]),0,100),f=kt(isNaN(o)?1:o,0,1);return[a,s,c,f]}return null};Ce.to.hex=function(){var e=fn(arguments);return"#"+wo(e[0])+wo(e[1])+wo(e[2])+(e[3]<1?wo(Math.round(e[3]*255)):"")};Ce.to.rgb=function(){var e=fn(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"};Ce.to.rgb.percent=function(){var e=fn(arguments),t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),o=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+t+"%, "+r+"%, "+o+"%)":"rgba("+t+"%, "+r+"%, "+o+"%, "+e[3]+")"};Ce.to.hsl=function(){var e=fn(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"};Ce.to.hwb=function(){var e=fn(arguments),t="";return e.length>=4&&e[3]!==1&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"};Ce.to.keyword=function(e){return vf[e.slice(0,3)]};function kt(e,t,r){return Math.min(Math.max(t,e),r)}function wo(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}});var ka=D((av,Rf)=>{var hn=Ia(),_f={};for(let e of Object.keys(hn))_f[hn[e]]=e;var k={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};Rf.exports=k;for(let e of Object.keys(k)){if(!("channels"in k[e]))throw new Error("missing channels property: "+e);if(!("labels"in k[e]))throw new Error("missing channel labels property: "+e);if(k[e].labels.length!==k[e].channels)throw new Error("channel and label counts mismatch: "+e);let{channels:t,labels:r}=k[e];delete k[e].channels,delete k[e].labels,Object.defineProperty(k[e],"channels",{value:t}),Object.defineProperty(k[e],"labels",{value:r})}k.rgb.hsl=function(e){let t=e[0]/255,r=e[1]/255,o=e[2]/255,a=Math.min(t,r,o),s=Math.max(t,r,o),c=s-a,f,m;s===a?f=0:t===s?f=(r-o)/c:r===s?f=2+(o-t)/c:o===s&&(f=4+(t-r)/c),f=Math.min(f*60,360),f<0&&(f+=360);let g=(a+s)/2;return s===a?m=0:g<=.5?m=c/(s+a):m=c/(2-s-a),[f,m*100,g*100]};k.rgb.hsv=function(e){let t,r,o,a,s,c=e[0]/255,f=e[1]/255,m=e[2]/255,g=Math.max(c,f,m),p=g-Math.min(c,f,m),y=function(E){return(g-E)/6/p+1/2};return p===0?(a=0,s=0):(s=p/g,t=y(c),r=y(f),o=y(m),c===g?a=o-r:f===g?a=1/3+t-o:m===g&&(a=2/3+r-t),a<0?a+=1:a>1&&(a-=1)),[a*360,s*100,g*100]};k.rgb.hwb=function(e){let t=e[0],r=e[1],o=e[2],a=k.rgb.hsl(e)[0],s=1/255*Math.min(t,Math.min(r,o));return o=1-1/255*Math.max(t,Math.max(r,o)),[a,s*100,o*100]};k.rgb.cmyk=function(e){let t=e[0]/255,r=e[1]/255,o=e[2]/255,a=Math.min(1-t,1-r,1-o),s=(1-t-a)/(1-a)||0,c=(1-r-a)/(1-a)||0,f=(1-o-a)/(1-a)||0;return[s*100,c*100,f*100,a*100]};function mg(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}k.rgb.keyword=function(e){let t=_f[e];if(t)return t;let r=1/0,o;for(let a of Object.keys(hn)){let s=hn[a],c=mg(e,s);c<r&&(r=c,o=a)}return o};k.keyword.rgb=function(e){return hn[e]};k.rgb.xyz=function(e){let t=e[0]/255,r=e[1]/255,o=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,o=o>.04045?((o+.055)/1.055)**2.4:o/12.92;let a=t*.4124+r*.3576+o*.1805,s=t*.2126+r*.7152+o*.0722,c=t*.0193+r*.1192+o*.9505;return[a*100,s*100,c*100]};k.rgb.lab=function(e){let t=k.rgb.xyz(e),r=t[0],o=t[1],a=t[2];r/=95.047,o/=100,a/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,a=a>.008856?a**(1/3):7.787*a+16/116;let s=116*o-16,c=500*(r-o),f=200*(o-a);return[s,c,f]};k.hsl.rgb=function(e){let t=e[0]/360,r=e[1]/100,o=e[2]/100,a,s,c;if(r===0)return c=o*255,[c,c,c];o<.5?a=o*(1+r):a=o+r-o*r;let f=2*o-a,m=[0,0,0];for(let g=0;g<3;g++)s=t+1/3*-(g-1),s<0&&s++,s>1&&s--,6*s<1?c=f+(a-f)*6*s:2*s<1?c=a:3*s<2?c=f+(a-f)*(2/3-s)*6:c=f,m[g]=c*255;return m};k.hsl.hsv=function(e){let t=e[0],r=e[1]/100,o=e[2]/100,a=r,s=Math.max(o,.01);o*=2,r*=o<=1?o:2-o,a*=s<=1?s:2-s;let c=(o+r)/2,f=o===0?2*a/(s+a):2*r/(o+r);return[t,f*100,c*100]};k.hsv.rgb=function(e){let t=e[0]/60,r=e[1]/100,o=e[2]/100,a=Math.floor(t)%6,s=t-Math.floor(t),c=255*o*(1-r),f=255*o*(1-r*s),m=255*o*(1-r*(1-s));switch(o*=255,a){case 0:return[o,m,c];case 1:return[f,o,c];case 2:return[c,o,m];case 3:return[c,f,o];case 4:return[m,c,o];case 5:return[o,c,f]}};k.hsv.hsl=function(e){let t=e[0],r=e[1]/100,o=e[2]/100,a=Math.max(o,.01),s,c;c=(2-r)*o;let f=(2-r)*a;return s=r*a,s/=f<=1?f:2-f,s=s||0,c/=2,[t,s*100,c*100]};k.hwb.rgb=function(e){let t=e[0]/360,r=e[1]/100,o=e[2]/100,a=r+o,s;a>1&&(r/=a,o/=a);let c=Math.floor(6*t),f=1-o;s=6*t-c,c&1&&(s=1-s);let m=r+s*(f-r),g,p,y;switch(c){default:case 6:case 0:g=f,p=m,y=r;break;case 1:g=m,p=f,y=r;break;case 2:g=r,p=f,y=m;break;case 3:g=r,p=m,y=f;break;case 4:g=m,p=r,y=f;break;case 5:g=f,p=r,y=m;break}return[g*255,p*255,y*255]};k.cmyk.rgb=function(e){let t=e[0]/100,r=e[1]/100,o=e[2]/100,a=e[3]/100,s=1-Math.min(1,t*(1-a)+a),c=1-Math.min(1,r*(1-a)+a),f=1-Math.min(1,o*(1-a)+a);return[s*255,c*255,f*255]};k.xyz.rgb=function(e){let t=e[0]/100,r=e[1]/100,o=e[2]/100,a,s,c;return a=t*3.2406+r*-1.5372+o*-.4986,s=t*-.9689+r*1.8758+o*.0415,c=t*.0557+r*-.204+o*1.057,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,c=c>.0031308?1.055*c**(1/2.4)-.055:c*12.92,a=Math.min(Math.max(0,a),1),s=Math.min(Math.max(0,s),1),c=Math.min(Math.max(0,c),1),[a*255,s*255,c*255]};k.xyz.lab=function(e){let t=e[0],r=e[1],o=e[2];t/=95.047,r/=100,o/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116;let a=116*r-16,s=500*(t-r),c=200*(r-o);return[a,s,c]};k.lab.xyz=function(e){let t=e[0],r=e[1],o=e[2],a,s,c;s=(t+16)/116,a=r/500+s,c=s-o/200;let f=s**3,m=a**3,g=c**3;return s=f>.008856?f:(s-16/116)/7.787,a=m>.008856?m:(a-16/116)/7.787,c=g>.008856?g:(c-16/116)/7.787,a*=95.047,s*=100,c*=108.883,[a,s,c]};k.lab.lch=function(e){let t=e[0],r=e[1],o=e[2],a;a=Math.atan2(o,r)*360/2/Math.PI,a<0&&(a+=360);let c=Math.sqrt(r*r+o*o);return[t,c,a]};k.lch.lab=function(e){let t=e[0],r=e[1],a=e[2]/360*2*Math.PI,s=r*Math.cos(a),c=r*Math.sin(a);return[t,s,c]};k.rgb.ansi16=function(e,t=null){let[r,o,a]=e,s=t===null?k.rgb.hsv(e)[2]:t;if(s=Math.round(s/50),s===0)return 30;let c=30+(Math.round(a/255)<<2|Math.round(o/255)<<1|Math.round(r/255));return s===2&&(c+=60),c};k.hsv.ansi16=function(e){return k.rgb.ansi16(k.hsv.rgb(e),e[2])};k.rgb.ansi256=function(e){let t=e[0],r=e[1],o=e[2];return t===r&&r===o?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(o/255*5)};k.ansi16.rgb=function(e){let t=e%10;if(t===0||t===7)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];let r=(~~(e>50)+1)*.5,o=(t&1)*r*255,a=(t>>1&1)*r*255,s=(t>>2&1)*r*255;return[o,a,s]};k.ansi256.rgb=function(e){if(e>=232){let s=(e-232)*10+8;return[s,s,s]}e-=16;let t,r=Math.floor(e/36)/5*255,o=Math.floor((t=e%36)/6)/5*255,a=t%6/5*255;return[r,o,a]};k.rgb.hex=function(e){let r=(((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255)).toString(16).toUpperCase();return"000000".substring(r.length)+r};k.hex.rgb=function(e){let t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let r=t[0];t[0].length===3&&(r=r.split("").map(f=>f+f).join(""));let o=parseInt(r,16),a=o>>16&255,s=o>>8&255,c=o&255;return[a,s,c]};k.rgb.hcg=function(e){let t=e[0]/255,r=e[1]/255,o=e[2]/255,a=Math.max(Math.max(t,r),o),s=Math.min(Math.min(t,r),o),c=a-s,f,m;return c<1?f=s/(1-c):f=0,c<=0?m=0:a===t?m=(r-o)/c%6:a===r?m=2+(o-t)/c:m=4+(t-r)/c,m/=6,m%=1,[m*360,c*100,f*100]};k.hsl.hcg=function(e){let t=e[1]/100,r=e[2]/100,o=r<.5?2*t*r:2*t*(1-r),a=0;return o<1&&(a=(r-.5*o)/(1-o)),[e[0],o*100,a*100]};k.hsv.hcg=function(e){let t=e[1]/100,r=e[2]/100,o=t*r,a=0;return o<1&&(a=(r-o)/(1-o)),[e[0],o*100,a*100]};k.hcg.rgb=function(e){let t=e[0]/360,r=e[1]/100,o=e[2]/100;if(r===0)return[o*255,o*255,o*255];let a=[0,0,0],s=t%1*6,c=s%1,f=1-c,m=0;switch(Math.floor(s)){case 0:a[0]=1,a[1]=c,a[2]=0;break;case 1:a[0]=f,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=c;break;case 3:a[0]=0,a[1]=f,a[2]=1;break;case 4:a[0]=c,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=f}return m=(1-r)*o,[(r*a[0]+m)*255,(r*a[1]+m)*255,(r*a[2]+m)*255]};k.hcg.hsv=function(e){let t=e[1]/100,r=e[2]/100,o=t+r*(1-t),a=0;return o>0&&(a=t/o),[e[0],a*100,o*100]};k.hcg.hsl=function(e){let t=e[1]/100,o=e[2]/100*(1-t)+.5*t,a=0;return o>0&&o<.5?a=t/(2*o):o>=.5&&o<1&&(a=t/(2*(1-o))),[e[0],a*100,o*100]};k.hcg.hwb=function(e){let t=e[1]/100,r=e[2]/100,o=t+r*(1-t);return[e[0],(o-t)*100,(1-o)*100]};k.hwb.hcg=function(e){let t=e[1]/100,o=1-e[2]/100,a=o-t,s=0;return a<1&&(s=(o-a)/(1-a)),[e[0],a*100,s*100]};k.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};k.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};k.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};k.gray.hsl=function(e){return[0,0,e[0]]};k.gray.hsv=k.gray.hsl;k.gray.hwb=function(e){return[0,100,e[0]]};k.gray.cmyk=function(e){return[0,0,0,e[0]]};k.gray.lab=function(e){return[e[0],0,0]};k.gray.hex=function(e){let t=Math.round(e[0]/100*255)&255,o=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(o.length)+o};k.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}});var Tf=D((sv,Pf)=>{var vo=ka();function pg(){let e={},t=Object.keys(vo);for(let r=t.length,o=0;o<r;o++)e[t[o]]={distance:-1,parent:null};return e}function gg(e){let t=pg(),r=[e];for(t[e].distance=0;r.length;){let o=r.pop(),a=Object.keys(vo[o]);for(let s=a.length,c=0;c<s;c++){let f=a[c],m=t[f];m.distance===-1&&(m.distance=t[o].distance+1,m.parent=o,r.unshift(f))}}return t}function bg(e,t){return function(r){return t(e(r))}}function yg(e,t){let r=[t[e].parent,e],o=vo[t[e].parent][e],a=t[e].parent;for(;t[a].parent;)r.unshift(t[a].parent),o=bg(vo[t[a].parent][a],o),a=t[a].parent;return o.conversion=r,o}Pf.exports=function(e){let t=gg(e),r={},o=Object.keys(t);for(let a=o.length,s=0;s<a;s++){let c=o[s];t[c].parent!==null&&(r[c]=yg(c,t))}return r}});var Cf=D((lv,Af)=>{var Ba=ka(),wg=Tf(),Sr={},vg=Object.keys(Ba);function Eg(e){let t=function(...r){let o=r[0];return o==null?o:(o.length>1&&(r=o),e(r))};return"conversion"in e&&(t.conversion=e.conversion),t}function Sg(e){let t=function(...r){let o=r[0];if(o==null)return o;o.length>1&&(r=o);let a=e(r);if(typeof a=="object")for(let s=a.length,c=0;c<s;c++)a[c]=Math.round(a[c]);return a};return"conversion"in e&&(t.conversion=e.conversion),t}vg.forEach(e=>{Sr[e]={},Object.defineProperty(Sr[e],"channels",{value:Ba[e].channels}),Object.defineProperty(Sr[e],"labels",{value:Ba[e].labels});let t=wg(e);Object.keys(t).forEach(o=>{let a=t[o];Sr[e][o]=Sg(a),Sr[e][o].raw=Eg(a)})});Af.exports=Sr});var So=D((cv,If)=>{var _r=Sf(),xe=Cf(),xf=["keyword","gray","hex"],qa={};for(let e of Object.keys(xe))qa[[...xe[e].labels].sort().join("")]=e;var Eo={};function ce(e,t){if(!(this instanceof ce))return new ce(e,t);if(t&&t in xf&&(t=null),t&&!(t in xe))throw new Error("Unknown model: "+t);let r,o;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof ce)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if(typeof e=="string"){let a=_r.get(e);if(a===null)throw new Error("Unable to parse color from string: "+e);this.model=a.model,o=xe[this.model].channels,this.color=a.value.slice(0,o),this.valpha=typeof a.value[o]=="number"?a.value[o]:1}else if(e.length>0){this.model=t||"rgb",o=xe[this.model].channels;let a=Array.prototype.slice.call(e,0,o);this.color=La(a,o),this.valpha=typeof e[o]=="number"?e[o]:1}else if(typeof e=="number")this.model="rgb",this.color=[e>>16&255,e>>8&255,e&255],this.valpha=1;else{this.valpha=1;let a=Object.keys(e);"alpha"in e&&(a.splice(a.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);let s=a.sort().join("");if(!(s in qa))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=qa[s];let{labels:c}=xe[this.model],f=[];for(r=0;r<c.length;r++)f.push(e[c[r]]);this.color=La(f)}if(Eo[this.model])for(o=xe[this.model].channels,r=0;r<o;r++){let a=Eo[this.model][r];a&&(this.color[r]=a(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}ce.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let t=this.model in _r.to?this:this.rgb();t=t.round(typeof e=="number"?e:1);let r=t.valpha===1?t.color:[...t.color,this.valpha];return _r.to[t.model](r)},percentString(e){let t=this.rgb().round(typeof e=="number"?e:1),r=t.valpha===1?t.color:[...t.color,this.valpha];return _r.to.rgb.percent(r)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){let e={},{channels:t}=xe[this.model],{labels:r}=xe[this.model];for(let o=0;o<t;o++)e[r[o]]=this.color[o];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray(){let e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject(){let e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new ce([...this.color.map(Rg(e)),this.valpha],this.model)},alpha(e){return e!==void 0?new ce([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:ie("rgb",0,le(255)),green:ie("rgb",1,le(255)),blue:ie("rgb",2,le(255)),hue:ie(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:ie("hsl",1,le(100)),lightness:ie("hsl",2,le(100)),saturationv:ie("hsv",1,le(100)),value:ie("hsv",2,le(100)),chroma:ie("hcg",1,le(100)),gray:ie("hcg",2,le(100)),white:ie("hwb",1,le(100)),wblack:ie("hwb",2,le(100)),cyan:ie("cmyk",0,le(100)),magenta:ie("cmyk",1,le(100)),yellow:ie("cmyk",2,le(100)),black:ie("cmyk",3,le(100)),x:ie("xyz",0,le(95.047)),y:ie("xyz",1,le(100)),z:ie("xyz",2,le(108.833)),l:ie("lab",0,le(100)),a:ie("lab",1),b:ie("lab",2),keyword(e){return e!==void 0?new ce(e):xe[this.model].keyword(this.color)},hex(e){return e!==void 0?new ce(e):_r.to.hex(this.rgb().round().color)},hexa(e){if(e!==void 0)return new ce(e);let t=this.rgb().round().color,r=Math.round(this.valpha*255).toString(16).toUpperCase();return r.length===1&&(r="0"+r),_r.to.hex(t)+r},rgbNumber(){let e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity(){let e=this.rgb().color,t=[];for(let[r,o]of e.entries()){let a=o/255;t[r]=a<=.04045?a/12.92:((a+.055)/1.055)**2.4}return .2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){let t=this.luminosity(),r=e.luminosity();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},level(e){let t=this.contrast(e);return t>=7?"AAA":t>=4.5?"AA":""},isDark(){let e=this.rgb().color;return(e[0]*2126+e[1]*7152+e[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){let e=this.rgb();for(let t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten(e){let t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken(e){let t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate(e){let t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate(e){let t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten(e){let t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken(e){let t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale(){let e=this.rgb().color,t=e[0]*.3+e[1]*.59+e[2]*.11;return ce.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){let t=this.hsl(),r=t.color[0];return r=(r+e)%360,r=r<0?360+r:r,t.color[0]=r,t},mix(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);let r=e.rgb(),o=this.rgb(),a=t===void 0?.5:t,s=2*a-1,c=r.alpha()-o.alpha(),f=((s*c===-1?s:(s+c)/(1+s*c))+1)/2,m=1-f;return ce.rgb(f*r.red()+m*o.red(),f*r.green()+m*o.green(),f*r.blue()+m*o.blue(),r.alpha()*a+o.alpha()*(1-a))}};for(let e of Object.keys(xe)){if(xf.includes(e))continue;let{channels:t}=xe[e];ce.prototype[e]=function(...r){return this.model===e?new ce(this):r.length>0?new ce(r,e):new ce([...Pg(xe[this.model][e].raw(this.color)),this.valpha],e)},ce[e]=function(...r){let o=r[0];return typeof o=="number"&&(o=La(r,t)),new ce(o,e)}}function _g(e,t){return Number(e.toFixed(t))}function Rg(e){return function(t){return _g(t,e)}}function ie(e,t,r){e=Array.isArray(e)?e:[e];for(let o of e)(Eo[o]||(Eo[o]=[]))[t]=r;return e=e[0],function(o){let a;return o!==void 0?(r&&(o=r(o)),a=this[e](),a.color[t]=o,a):(a=this[e]().color[t],r&&(a=r(a)),a)}}function le(e){return function(t){return Math.max(0,Math.min(e,t))}}function Pg(e){return Array.isArray(e)?e:[e]}function La(e,t){for(let r=0;r<t;r++)typeof e[r]!="number"&&(e[r]=0);return e}If.exports=ce});var qf=D((uv,Bf)=>{"use strict";var Tg=So(),S=Ge(),Bt=cn(),Ag={left:"low",center:"centre",centre:"centre",right:"high"};function kf(e){let{raw:t,density:r,limitInputPixels:o,ignoreIcc:a,unlimited:s,sequentialRead:c,failOn:f,failOnError:m,animated:g,page:p,pages:y,subifd:E}=e;return[t,r,o,a,s,c,f,m,g,p,y,E].some(S.defined)?{raw:t,density:r,limitInputPixels:o,ignoreIcc:a,unlimited:s,sequentialRead:c,failOn:f,failOnError:m,animated:g,page:p,pages:y,subifd:E}:void 0}function Cg(e,t,r){let o={failOn:"warning",limitInputPixels:Math.pow(16383,2),ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(S.string(e))o.file=e;else if(S.buffer(e)){if(e.length===0)throw Error("Input Buffer is empty");o.buffer=e}else if(S.arrayBuffer(e)){if(e.byteLength===0)throw Error("Input bit Array is empty");o.buffer=Buffer.from(e,0,e.byteLength)}else if(S.typedArray(e)){if(e.length===0)throw Error("Input Bit Array is empty");o.buffer=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}else if(S.plainObject(e)&&!S.defined(t))t=e,kf(t)&&(o.buffer=[]);else if(!S.defined(e)&&!S.defined(t)&&S.object(r)&&r.allowStream)o.buffer=[];else throw new Error(`Unsupported input '${e}' of type ${typeof e}${S.defined(t)?` when also providing options of type ${typeof t}`:""}`);if(S.object(t)){if(S.defined(t.failOnError))if(S.bool(t.failOnError))o.failOn=t.failOnError?"warning":"none";else throw S.invalidParameterError("failOnError","boolean",t.failOnError);if(S.defined(t.failOn))if(S.string(t.failOn)&&S.inArray(t.failOn,["none","truncated","error","warning"]))o.failOn=t.failOn;else throw S.invalidParameterError("failOn","one of: none, truncated, error, warning",t.failOn);if(S.defined(t.density))if(S.inRange(t.density,1,1e5))o.density=t.density;else throw S.invalidParameterError("density","number between 1 and 100000",t.density);if(S.defined(t.ignoreIcc))if(S.bool(t.ignoreIcc))o.ignoreIcc=t.ignoreIcc;else throw S.invalidParameterError("ignoreIcc","boolean",t.ignoreIcc);if(S.defined(t.limitInputPixels))if(S.bool(t.limitInputPixels))o.limitInputPixels=t.limitInputPixels?Math.pow(16383,2):0;else if(S.integer(t.limitInputPixels)&&S.inRange(t.limitInputPixels,0,Number.MAX_SAFE_INTEGER))o.limitInputPixels=t.limitInputPixels;else throw S.invalidParameterError("limitInputPixels","positive integer",t.limitInputPixels);if(S.defined(t.unlimited))if(S.bool(t.unlimited))o.unlimited=t.unlimited;else throw S.invalidParameterError("unlimited","boolean",t.unlimited);if(S.defined(t.sequentialRead))if(S.bool(t.sequentialRead))o.sequentialRead=t.sequentialRead;else throw S.invalidParameterError("sequentialRead","boolean",t.sequentialRead);if(S.defined(t.raw))if(S.object(t.raw)&&S.integer(t.raw.width)&&t.raw.width>0&&S.integer(t.raw.height)&&t.raw.height>0&&S.integer(t.raw.channels)&&S.inRange(t.raw.channels,1,4))switch(o.rawWidth=t.raw.width,o.rawHeight=t.raw.height,o.rawChannels=t.raw.channels,o.rawPremultiplied=!!t.raw.premultiplied,e.constructor){case Uint8Array:case Uint8ClampedArray:o.rawDepth="uchar";break;case Int8Array:o.rawDepth="char";break;case Uint16Array:o.rawDepth="ushort";break;case Int16Array:o.rawDepth="short";break;case Uint32Array:o.rawDepth="uint";break;case Int32Array:o.rawDepth="int";break;case Float32Array:o.rawDepth="float";break;case Float64Array:o.rawDepth="double";break;default:o.rawDepth="uchar";break}else throw new Error("Expected width, height and channels for raw pixel input");if(S.defined(t.animated))if(S.bool(t.animated))o.pages=t.animated?-1:1;else throw S.invalidParameterError("animated","boolean",t.animated);if(S.defined(t.pages))if(S.integer(t.pages)&&S.inRange(t.pages,-1,1e5))o.pages=t.pages;else throw S.invalidParameterError("pages","integer between -1 and 100000",t.pages);if(S.defined(t.page))if(S.integer(t.page)&&S.inRange(t.page,0,1e5))o.page=t.page;else throw S.invalidParameterError("page","integer between 0 and 100000",t.page);if(S.defined(t.level))if(S.integer(t.level)&&S.inRange(t.level,0,256))o.level=t.level;else throw S.invalidParameterError("level","integer between 0 and 256",t.level);if(S.defined(t.subifd))if(S.integer(t.subifd)&&S.inRange(t.subifd,-1,1e5))o.subifd=t.subifd;else throw S.invalidParameterError("subifd","integer between -1 and 100000",t.subifd);if(S.defined(t.create))if(S.object(t.create)&&S.integer(t.create.width)&&t.create.width>0&&S.integer(t.create.height)&&t.create.height>0&&S.integer(t.create.channels)){if(o.createWidth=t.create.width,o.createHeight=t.create.height,o.createChannels=t.create.channels,S.defined(t.create.noise)){if(!S.object(t.create.noise))throw new Error("Expected noise to be an object");if(!S.inArray(t.create.noise.type,["gaussian"]))throw new Error("Only gaussian noise is supported at the moment");if(!S.inRange(t.create.channels,1,4))throw S.invalidParameterError("create.channels","number between 1 and 4",t.create.channels);if(o.createNoiseType=t.create.noise.type,S.number(t.create.noise.mean)&&S.inRange(t.create.noise.mean,0,1e4))o.createNoiseMean=t.create.noise.mean;else throw S.invalidParameterError("create.noise.mean","number between 0 and 10000",t.create.noise.mean);if(S.number(t.create.noise.sigma)&&S.inRange(t.create.noise.sigma,0,1e4))o.createNoiseSigma=t.create.noise.sigma;else throw S.invalidParameterError("create.noise.sigma","number between 0 and 10000",t.create.noise.sigma)}else if(S.defined(t.create.background)){if(!S.inRange(t.create.channels,3,4))throw S.invalidParameterError("create.channels","number between 3 and 4",t.create.channels);let a=Tg(t.create.background);o.createBackground=[a.red(),a.green(),a.blue(),Math.round(a.alpha()*255)]}else throw new Error("Expected valid noise or background to create a new input image");delete o.buffer}else throw new Error("Expected valid width, height and channels to create a new input image");if(S.defined(t.text))if(S.object(t.text)&&S.string(t.text.text)){if(o.textValue=t.text.text,S.defined(t.text.height)&&S.defined(t.text.dpi))throw new Error("Expected only one of dpi or height");if(S.defined(t.text.font))if(S.string(t.text.font))o.textFont=t.text.font;else throw S.invalidParameterError("text.font","string",t.text.font);if(S.defined(t.text.fontfile))if(S.string(t.text.fontfile))o.textFontfile=t.text.fontfile;else throw S.invalidParameterError("text.fontfile","string",t.text.fontfile);if(S.defined(t.text.width))if(S.integer(t.text.width)&&t.text.width>0)o.textWidth=t.text.width;else throw S.invalidParameterError("text.width","positive integer",t.text.width);if(S.defined(t.text.height))if(S.integer(t.text.height)&&t.text.height>0)o.textHeight=t.text.height;else throw S.invalidParameterError("text.height","positive integer",t.text.height);if(S.defined(t.text.align))if(S.string(t.text.align)&&S.string(this.constructor.align[t.text.align]))o.textAlign=this.constructor.align[t.text.align];else throw S.invalidParameterError("text.align","valid alignment",t.text.align);if(S.defined(t.text.justify))if(S.bool(t.text.justify))o.textJustify=t.text.justify;else throw S.invalidParameterError("text.justify","boolean",t.text.justify);if(S.defined(t.text.dpi))if(S.integer(t.text.dpi)&&S.inRange(t.text.dpi,1,1e6))o.textDpi=t.text.dpi;else throw S.invalidParameterError("text.dpi","integer between 1 and 1000000",t.text.dpi);if(S.defined(t.text.rgba))if(S.bool(t.text.rgba))o.textRgba=t.text.rgba;else throw S.invalidParameterError("text.rgba","bool",t.text.rgba);if(S.defined(t.text.spacing))if(S.integer(t.text.spacing)&&S.inRange(t.text.spacing,-1e6,1e6))o.textSpacing=t.text.spacing;else throw S.invalidParameterError("text.spacing","integer between -1000000 and 1000000",t.text.spacing);if(S.defined(t.text.wrap))if(S.string(t.text.wrap)&&S.inArray(t.text.wrap,["word","char","word-char","none"]))o.textWrap=t.text.wrap;else throw S.invalidParameterError("text.wrap","one of: word, char, word-char, none",t.text.wrap);delete o.buffer}else throw new Error("Expected a valid string to create an image with text.")}else if(S.defined(t))throw new Error("Invalid input options "+t);return o}function xg(e,t,r){Array.isArray(this.options.input.buffer)?S.buffer(e)?(this.options.input.buffer.length===0&&this.on("finish",()=>{this.streamInFinished=!0}),this.options.input.buffer.push(e),r()):r(new Error("Non-Buffer data on Writable Stream")):r(new Error("Unexpected data on Writable Stream"))}function Ig(){this._isStreamInput()&&(this.options.input.buffer=Buffer.concat(this.options.input.buffer))}function kg(){return Array.isArray(this.options.input.buffer)}function Bg(e){let t=Error();return S.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),Bt.metadata(this.options,(r,o)=>{r?e(S.nativeError(r,t)):e(null,o)})}):Bt.metadata(this.options,(r,o)=>{r?e(S.nativeError(r,t)):e(null,o)}),this):this._isStreamInput()?new Promise((r,o)=>{let a=()=>{this._flattenBufferIn(),Bt.metadata(this.options,(s,c)=>{s?o(S.nativeError(s,t)):r(c)})};this.writableFinished?a():this.once("finish",a)}):new Promise((r,o)=>{Bt.metadata(this.options,(a,s)=>{a?o(S.nativeError(a,t)):r(s)})})}function qg(e){let t=Error();return S.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),Bt.stats(this.options,(r,o)=>{r?e(S.nativeError(r,t)):e(null,o)})}):Bt.stats(this.options,(r,o)=>{r?e(S.nativeError(r,t)):e(null,o)}),this):this._isStreamInput()?new Promise((r,o)=>{this.on("finish",function(){this._flattenBufferIn(),Bt.stats(this.options,(a,s)=>{a?o(S.nativeError(a,t)):r(s)})})}):new Promise((r,o)=>{Bt.stats(this.options,(a,s)=>{a?o(S.nativeError(a,t)):r(s)})})}Bf.exports=function(e){Object.assign(e.prototype,{_inputOptionsFromObject:kf,_createInputDescriptor:Cg,_write:xg,_flattenBufferIn:Ig,_isStreamInput:kg,metadata:Bg,stats:qg}),e.align=Ag}});var Df=D((fv,$f)=>{"use strict";var q=Ge(),Of={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},jf={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},Lf={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},Ff={entropy:16,attention:17},Oa={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3"},Lg={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},Og={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function ja(e){return e.angle%360!==0||e.useExifOrientation===!0||e.rotationAngle!==0}function _o(e){return e.width!==-1||e.height!==-1}function jg(e,t,r){if(_o(this.options)&&this.options.debuglog("ignoring previous resize options"),this.options.widthPost!==-1&&this.options.debuglog("operation order will be: extract, resize, extract"),q.defined(e))if(q.object(e)&&!q.defined(r))r=e;else if(q.integer(e)&&e>0)this.options.width=e;else throw q.invalidParameterError("width","positive integer",e);else this.options.width=-1;if(q.defined(t))if(q.integer(t)&&t>0)this.options.height=t;else throw q.invalidParameterError("height","positive integer",t);else this.options.height=-1;if(q.object(r)){if(q.defined(r.width))if(q.integer(r.width)&&r.width>0)this.options.width=r.width;else throw q.invalidParameterError("width","positive integer",r.width);if(q.defined(r.height))if(q.integer(r.height)&&r.height>0)this.options.height=r.height;else throw q.invalidParameterError("height","positive integer",r.height);if(q.defined(r.fit)){let o=Og[r.fit];if(q.string(o))this.options.canvas=o;else throw q.invalidParameterError("fit","valid fit",r.fit)}if(q.defined(r.position)){let o=q.integer(r.position)?r.position:Ff[r.position]||jf[r.position]||Of[r.position];if(q.integer(o)&&(q.inRange(o,0,8)||q.inRange(o,16,17)))this.options.position=o;else throw q.invalidParameterError("position","valid position/gravity/strategy",r.position)}if(this._setBackgroundColourOption("resizeBackground",r.background),q.defined(r.kernel))if(q.string(Oa[r.kernel]))this.options.kernel=Oa[r.kernel];else throw q.invalidParameterError("kernel","valid kernel name",r.kernel);q.defined(r.withoutEnlargement)&&this._setBooleanOption("withoutEnlargement",r.withoutEnlargement),q.defined(r.withoutReduction)&&this._setBooleanOption("withoutReduction",r.withoutReduction),q.defined(r.fastShrinkOnLoad)&&this._setBooleanOption("fastShrinkOnLoad",r.fastShrinkOnLoad)}return ja(this.options)&&_o(this.options)&&(this.options.rotateBeforePreExtract=!0),this}function Fg(e){if(q.integer(e)&&e>0)this.options.extendTop=e,this.options.extendBottom=e,this.options.extendLeft=e,this.options.extendRight=e;else if(q.object(e)){if(q.defined(e.top))if(q.integer(e.top)&&e.top>=0)this.options.extendTop=e.top;else throw q.invalidParameterError("top","positive integer",e.top);if(q.defined(e.bottom))if(q.integer(e.bottom)&&e.bottom>=0)this.options.extendBottom=e.bottom;else throw q.invalidParameterError("bottom","positive integer",e.bottom);if(q.defined(e.left))if(q.integer(e.left)&&e.left>=0)this.options.extendLeft=e.left;else throw q.invalidParameterError("left","positive integer",e.left);if(q.defined(e.right))if(q.integer(e.right)&&e.right>=0)this.options.extendRight=e.right;else throw q.invalidParameterError("right","positive integer",e.right);if(this._setBackgroundColourOption("extendBackground",e.background),q.defined(e.extendWith))if(q.string(Lf[e.extendWith]))this.options.extendWith=Lf[e.extendWith];else throw q.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",e.extendWith)}else throw q.invalidParameterError("extend","integer or object",e);return this}function $g(e){let t=_o(this.options)||this.options.widthPre!==-1?"Post":"Pre";return this.options[`width${t}`]!==-1&&this.options.debuglog("ignoring previous extract options"),["left","top","width","height"].forEach(function(r){let o=e[r];if(q.integer(o)&&o>=0)this.options[r+(r==="left"||r==="top"?"Offset":"")+t]=o;else throw q.invalidParameterError(r,"integer",o)},this),ja(this.options)&&!_o(this.options)&&(this.options.widthPre===-1||this.options.widthPost===-1)&&(this.options.rotateBeforePreExtract=!0),this}function Dg(e){if(this.options.trimThreshold=10,q.defined(e))if(q.object(e)){if(q.defined(e.background)&&this._setBackgroundColourOption("trimBackground",e.background),q.defined(e.threshold))if(q.number(e.threshold)&&e.threshold>=0)this.options.trimThreshold=e.threshold;else throw q.invalidParameterError("threshold","positive number",e.threshold);q.defined(e.lineArt)&&this._setBooleanOption("trimLineArt",e.lineArt)}else throw q.invalidParameterError("trim","object",e);return ja(this.options)&&(this.options.rotateBeforePreExtract=!0),this}$f.exports=function(e){Object.assign(e.prototype,{resize:jg,extend:Fg,extract:$g,trim:Dg}),e.gravity=Of,e.strategy=Ff,e.kernel=Oa,e.fit=Lg,e.position=jf}});var Mf=D((hv,Nf)=>{"use strict";var J=Ge(),Fa={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function Ng(e){if(!Array.isArray(e))throw J.invalidParameterError("images to composite","array",e);return this.options.composite=e.map(t=>{if(!J.object(t))throw J.invalidParameterError("image to composite","object",t);let r=this._inputOptionsFromObject(t),o={input:this._createInputDescriptor(t.input,r,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(J.defined(t.blend))if(J.string(Fa[t.blend]))o.blend=Fa[t.blend];else throw J.invalidParameterError("blend","valid blend name",t.blend);if(J.defined(t.tile))if(J.bool(t.tile))o.tile=t.tile;else throw J.invalidParameterError("tile","boolean",t.tile);if(J.defined(t.left))if(J.integer(t.left))o.left=t.left;else throw J.invalidParameterError("left","integer",t.left);if(J.defined(t.top))if(J.integer(t.top))o.top=t.top;else throw J.invalidParameterError("top","integer",t.top);if(J.defined(t.top)!==J.defined(t.left))throw new Error("Expected both left and top to be set");if(o.hasOffset=J.integer(t.top)&&J.integer(t.left),J.defined(t.gravity))if(J.integer(t.gravity)&&J.inRange(t.gravity,0,8))o.gravity=t.gravity;else if(J.string(t.gravity)&&J.integer(this.constructor.gravity[t.gravity]))o.gravity=this.constructor.gravity[t.gravity];else throw J.invalidParameterError("gravity","valid gravity",t.gravity);if(J.defined(t.premultiplied))if(J.bool(t.premultiplied))o.premultiplied=t.premultiplied;else throw J.invalidParameterError("premultiplied","boolean",t.premultiplied);return o}),this}Nf.exports=function(e){e.prototype.composite=Ng,e.blend=Fa}});var Uf=D((dv,zf)=>{"use strict";var Mg=So(),w=Ge(),Wf={integer:"integer",float:"float",approximate:"approximate"};function Wg(e,t){if((this.options.useExifOrientation||this.options.angle||this.options.rotationAngle)&&this.options.debuglog("ignoring previous rotate options"),!w.defined(e))this.options.useExifOrientation=!0;else if(w.integer(e)&&!(e%90))this.options.angle=e;else if(w.number(e)){if(this.options.rotationAngle=e,w.object(t)&&t.background){let r=Mg(t.background);this.options.rotationBackground=[r.red(),r.green(),r.blue(),Math.round(r.alpha()*255)]}}else throw w.invalidParameterError("angle","numeric",e);return this}function zg(e){return this.options.flip=w.bool(e)?e:!0,this}function Ug(e){return this.options.flop=w.bool(e)?e:!0,this}function Hg(e,t){let r=[].concat(...e);if(r.length===4&&r.every(w.number))this.options.affineMatrix=r;else throw w.invalidParameterError("matrix","1x4 or 2x2 array",e);if(w.defined(t))if(w.object(t)){if(this._setBackgroundColourOption("affineBackground",t.background),w.defined(t.idx))if(w.number(t.idx))this.options.affineIdx=t.idx;else throw w.invalidParameterError("options.idx","number",t.idx);if(w.defined(t.idy))if(w.number(t.idy))this.options.affineIdy=t.idy;else throw w.invalidParameterError("options.idy","number",t.idy);if(w.defined(t.odx))if(w.number(t.odx))this.options.affineOdx=t.odx;else throw w.invalidParameterError("options.odx","number",t.odx);if(w.defined(t.ody))if(w.number(t.ody))this.options.affineOdy=t.ody;else throw w.invalidParameterError("options.ody","number",t.ody);if(w.defined(t.interpolator))if(w.inArray(t.interpolator,Object.values(this.constructor.interpolators)))this.options.affineInterpolator=t.interpolator;else throw w.invalidParameterError("options.interpolator","valid interpolator name",t.interpolator)}else throw w.invalidParameterError("options","object",t);return this}function Gg(e,t,r){if(!w.defined(e))this.options.sharpenSigma=-1;else if(w.bool(e))this.options.sharpenSigma=e?-1:0;else if(w.number(e)&&w.inRange(e,.01,1e4)){if(this.options.sharpenSigma=e,w.defined(t))if(w.number(t)&&w.inRange(t,0,1e4))this.options.sharpenM1=t;else throw w.invalidParameterError("flat","number between 0 and 10000",t);if(w.defined(r))if(w.number(r)&&w.inRange(r,0,1e4))this.options.sharpenM2=r;else throw w.invalidParameterError("jagged","number between 0 and 10000",r)}else if(w.plainObject(e)){if(w.number(e.sigma)&&w.inRange(e.sigma,1e-6,10))this.options.sharpenSigma=e.sigma;else throw w.invalidParameterError("options.sigma","number between 0.000001 and 10",e.sigma);if(w.defined(e.m1))if(w.number(e.m1)&&w.inRange(e.m1,0,1e6))this.options.sharpenM1=e.m1;else throw w.invalidParameterError("options.m1","number between 0 and 1000000",e.m1);if(w.defined(e.m2))if(w.number(e.m2)&&w.inRange(e.m2,0,1e6))this.options.sharpenM2=e.m2;else throw w.invalidParameterError("options.m2","number between 0 and 1000000",e.m2);if(w.defined(e.x1))if(w.number(e.x1)&&w.inRange(e.x1,0,1e6))this.options.sharpenX1=e.x1;else throw w.invalidParameterError("options.x1","number between 0 and 1000000",e.x1);if(w.defined(e.y2))if(w.number(e.y2)&&w.inRange(e.y2,0,1e6))this.options.sharpenY2=e.y2;else throw w.invalidParameterError("options.y2","number between 0 and 1000000",e.y2);if(w.defined(e.y3))if(w.number(e.y3)&&w.inRange(e.y3,0,1e6))this.options.sharpenY3=e.y3;else throw w.invalidParameterError("options.y3","number between 0 and 1000000",e.y3)}else throw w.invalidParameterError("sigma","number between 0.01 and 10000",e);return this}function Vg(e){if(!w.defined(e))this.options.medianSize=3;else if(w.integer(e)&&w.inRange(e,1,1e3))this.options.medianSize=e;else throw w.invalidParameterError("size","integer between 1 and 1000",e);return this}function Qg(e){let t;if(w.number(e))t=e;else if(w.plainObject(e)){if(!w.number(e.sigma))throw w.invalidParameterError("options.sigma","number between 0.3 and 1000",t);if(t=e.sigma,"precision"in e)if(w.string(Wf[e.precision]))this.options.precision=Wf[e.precision];else throw w.invalidParameterError("precision","one of: integer, float, approximate",e.precision);if("minAmplitude"in e)if(w.number(e.minAmplitude)&&w.inRange(e.minAmplitude,.001,1))this.options.minAmpl=e.minAmplitude;else throw w.invalidParameterError("minAmplitude","number between 0.001 and 1",e.minAmplitude)}if(!w.defined(e))this.options.blurSigma=-1;else if(w.bool(e))this.options.blurSigma=e?-1:0;else if(w.number(t)&&w.inRange(t,.3,1e3))this.options.blurSigma=t;else throw w.invalidParameterError("sigma","number between 0.3 and 1000",t);return this}function Yg(e){return this.options.flatten=w.bool(e)?e:!0,w.object(e)&&this._setBackgroundColourOption("flattenBackground",e.background),this}function Xg(){return this.options.unflatten=!0,this}function Jg(e,t){if(!w.defined(e))this.options.gamma=2.2;else if(w.number(e)&&w.inRange(e,1,3))this.options.gamma=e;else throw w.invalidParameterError("gamma","number between 1.0 and 3.0",e);if(!w.defined(t))this.options.gammaOut=this.options.gamma;else if(w.number(t)&&w.inRange(t,1,3))this.options.gammaOut=t;else throw w.invalidParameterError("gammaOut","number between 1.0 and 3.0",t);return this}function Kg(e){if(this.options.negate=w.bool(e)?e:!0,w.plainObject(e)&&"alpha"in e)if(w.bool(e.alpha))this.options.negateAlpha=e.alpha;else throw w.invalidParameterError("alpha","should be boolean value",e.alpha);return this}function Zg(e){if(w.plainObject(e)){if(w.defined(e.lower))if(w.number(e.lower)&&w.inRange(e.lower,0,99))this.options.normaliseLower=e.lower;else throw w.invalidParameterError("lower","number between 0 and 99",e.lower);if(w.defined(e.upper))if(w.number(e.upper)&&w.inRange(e.upper,1,100))this.options.normaliseUpper=e.upper;else throw w.invalidParameterError("upper","number between 1 and 100",e.upper)}if(this.options.normaliseLower>=this.options.normaliseUpper)throw w.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function eb(e){return this.normalise(e)}function tb(e){if(w.plainObject(e)){if(w.integer(e.width)&&e.width>0)this.options.claheWidth=e.width;else throw w.invalidParameterError("width","integer greater than zero",e.width);if(w.integer(e.height)&&e.height>0)this.options.claheHeight=e.height;else throw w.invalidParameterError("height","integer greater than zero",e.height);if(w.defined(e.maxSlope))if(w.integer(e.maxSlope)&&w.inRange(e.maxSlope,0,100))this.options.claheMaxSlope=e.maxSlope;else throw w.invalidParameterError("maxSlope","integer between 0 and 100",e.maxSlope)}else throw w.invalidParameterError("options","plain object",e);return this}function rb(e){if(!w.object(e)||!Array.isArray(e.kernel)||!w.integer(e.width)||!w.integer(e.height)||!w.inRange(e.width,3,1001)||!w.inRange(e.height,3,1001)||e.height*e.width!==e.kernel.length)throw new Error("Invalid convolution kernel");return w.integer(e.scale)||(e.scale=e.kernel.reduce(function(t,r){return t+r},0)),e.scale<1&&(e.scale=1),w.integer(e.offset)||(e.offset=0),this.options.convKernel=e,this}function nb(e,t){if(!w.defined(e))this.options.threshold=128;else if(w.bool(e))this.options.threshold=e?128:0;else if(w.integer(e)&&w.inRange(e,0,255))this.options.threshold=e;else throw w.invalidParameterError("threshold","integer between 0 and 255",e);return!w.object(t)||t.greyscale===!0||t.grayscale===!0?this.options.thresholdGrayscale=!0:this.options.thresholdGrayscale=!1,this}function ob(e,t,r){if(this.options.boolean=this._createInputDescriptor(e,r),w.string(t)&&w.inArray(t,["and","or","eor"]))this.options.booleanOp=t;else throw w.invalidParameterError("operator","one of: and, or, eor",t);return this}function ib(e,t){if(!w.defined(e)&&w.number(t)?e=1:w.number(e)&&!w.defined(t)&&(t=0),!w.defined(e))this.options.linearA=[];else if(w.number(e))this.options.linearA=[e];else if(Array.isArray(e)&&e.length&&e.every(w.number))this.options.linearA=e;else throw w.invalidParameterError("a","number or array of numbers",e);if(!w.defined(t))this.options.linearB=[];else if(w.number(t))this.options.linearB=[t];else if(Array.isArray(t)&&t.length&&t.every(w.number))this.options.linearB=t;else throw w.invalidParameterError("b","number or array of numbers",t);if(this.options.linearA.length!==this.options.linearB.length)throw new Error("Expected a and b to be arrays of the same length");return this}function ab(e){if(!Array.isArray(e))throw w.invalidParameterError("inputMatrix","array",e);if(e.length!==3&&e.length!==4)throw w.invalidParameterError("inputMatrix","3x3 or 4x4 array",e.length);let t=e.flat().map(Number);if(t.length!==9&&t.length!==16)throw w.invalidParameterError("inputMatrix","cardinality of 9 or 16",t.length);return this.options.recombMatrix=t,this}function sb(e){if(!w.plainObject(e))throw w.invalidParameterError("options","plain object",e);if("brightness"in e)if(w.number(e.brightness)&&e.brightness>=0)this.options.brightness=e.brightness;else throw w.invalidParameterError("brightness","number above zero",e.brightness);if("saturation"in e)if(w.number(e.saturation)&&e.saturation>=0)this.options.saturation=e.saturation;else throw w.invalidParameterError("saturation","number above zero",e.saturation);if("hue"in e)if(w.integer(e.hue))this.options.hue=e.hue%360;else throw w.invalidParameterError("hue","number",e.hue);if("lightness"in e)if(w.number(e.lightness))this.options.lightness=e.lightness;else throw w.invalidParameterError("lightness","number",e.lightness);return this}zf.exports=function(e){Object.assign(e.prototype,{rotate:Wg,flip:zg,flop:Ug,affine:Hg,sharpen:Gg,median:Vg,blur:Qg,flatten:Yg,unflatten:Xg,gamma:Jg,negate:Kg,normalise:Zg,normalize:eb,clahe:tb,convolve:rb,threshold:nb,boolean:ob,linear:ib,recomb:ab,modulate:sb})}});var Vf=D((mv,Gf)=>{"use strict";var lb=So(),ht=Ge(),Hf={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function cb(e){return this._setBackgroundColourOption("tint",e),this}function ub(e){return this.options.greyscale=ht.bool(e)?e:!0,this}function fb(e){return this.greyscale(e)}function hb(e){if(!ht.string(e))throw ht.invalidParameterError("colourspace","string",e);return this.options.colourspacePipeline=e,this}function db(e){return this.pipelineColourspace(e)}function mb(e){if(!ht.string(e))throw ht.invalidParameterError("colourspace","string",e);return this.options.colourspace=e,this}function pb(e){return this.toColourspace(e)}function gb(e,t){if(ht.defined(t))if(ht.object(t)||ht.string(t)){let r=lb(t);this.options[e]=[r.red(),r.green(),r.blue(),Math.round(r.alpha()*255)]}else throw ht.invalidParameterError("background","object or string",t)}Gf.exports=function(e){Object.assign(e.prototype,{tint:cb,greyscale:ub,grayscale:fb,pipelineColourspace:hb,pipelineColorspace:db,toColourspace:mb,toColorspace:pb,_setBackgroundColourOption:gb}),e.colourspace=Hf,e.colorspace=Hf}});var Yf=D((pv,Qf)=>{"use strict";var Ye=Ge(),bb={and:"and",or:"or",eor:"eor"};function yb(){return this.options.removeAlpha=!0,this}function wb(e){if(Ye.defined(e))if(Ye.number(e)&&Ye.inRange(e,0,1))this.options.ensureAlpha=e;else throw Ye.invalidParameterError("alpha","number between 0 and 1",e);else this.options.ensureAlpha=1;return this}function vb(e){let t={red:0,green:1,blue:2,alpha:3};if(Object.keys(t).includes(e)&&(e=t[e]),Ye.integer(e)&&Ye.inRange(e,0,4))this.options.extractChannel=e;else throw Ye.invalidParameterError("channel","integer or one of: red, green, blue, alpha",e);return this}function Eb(e,t){return Array.isArray(e)?e.forEach(function(r){this.options.joinChannelIn.push(this._createInputDescriptor(r,t))},this):this.options.joinChannelIn.push(this._createInputDescriptor(e,t)),this}function Sb(e){if(Ye.string(e)&&Ye.inArray(e,["and","or","eor"]))this.options.bandBoolOp=e;else throw Ye.invalidParameterError("boolOp","one of: and, or, eor",e);return this}Qf.exports=function(e){Object.assign(e.prototype,{removeAlpha:yb,ensureAlpha:wb,extractChannel:vb,joinChannel:Eb,bandbool:Sb}),e.bool=bb}});var th=D((gv,eh)=>{"use strict";var $a=Z("node:path"),h=Ge(),Rr=cn(),Xf=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),_b=/\.(jp[2x]|j2[kc])$/i,Jf=()=>new Error("JP2 output requires libvips with support for OpenJPEG"),Kf=e=>1<<31-Math.clz32(Math.ceil(Math.log2(e)));function Rb(e,t){let r;if(h.string(e)?h.string(this.options.input.file)&&$a.resolve(this.options.input.file)===$a.resolve(e)?r=new Error("Cannot use same file for input and output"):_b.test($a.extname(e))&&!this.constructor.format.jp2k.output.file&&(r=Jf()):r=new Error("Missing output file path"),r)if(h.fn(t))t(r);else return Promise.reject(r);else{this.options.fileOut=e;let o=Error();return this._pipeline(t,o)}return this}function Pb(e,t){h.object(e)?this._setBooleanOption("resolveWithObject",e.resolveWithObject):this.options.resolveWithObject&&(this.options.resolveWithObject=!1),this.options.fileOut="";let r=Error();return this._pipeline(h.fn(e)?e:t,r)}function Tb(){return this.options.keepMetadata|=1,this}function Ab(e){if(h.object(e))for(let[t,r]of Object.entries(e))if(h.object(r))for(let[o,a]of Object.entries(r))if(h.string(a))this.options.withExif[`exif-${t.toLowerCase()}-${o}`]=a;else throw h.invalidParameterError(`${t}.${o}`,"string",a);else throw h.invalidParameterError(t,"object",r);else throw h.invalidParameterError("exif","object",e);return this.options.withExifMerge=!1,this.keepExif()}function Cb(e){return this.withExif(e),this.options.withExifMerge=!0,this}function xb(){return this.options.keepMetadata|=8,this}function Ib(e,t){if(h.string(e))this.options.withIccProfile=e;else throw h.invalidParameterError("icc","string",e);if(this.keepIccProfile(),h.object(t)&&h.defined(t.attach))if(h.bool(t.attach))t.attach||(this.options.keepMetadata&=-9);else throw h.invalidParameterError("attach","boolean",t.attach);return this}function kb(){return this.options.keepMetadata=31,this}function Bb(e){if(this.keepMetadata(),this.withIccProfile("srgb"),h.object(e)){if(h.defined(e.orientation))if(h.integer(e.orientation)&&h.inRange(e.orientation,1,8))this.options.withMetadataOrientation=e.orientation;else throw h.invalidParameterError("orientation","integer between 1 and 8",e.orientation);if(h.defined(e.density))if(h.number(e.density)&&e.density>0)this.options.withMetadataDensity=e.density;else throw h.invalidParameterError("density","positive number",e.density);h.defined(e.icc)&&this.withIccProfile(e.icc),h.defined(e.exif)&&this.withExifMerge(e.exif)}return this}function qb(e,t){let r=Xf.get((h.object(e)&&h.string(e.id)?e.id:e).toLowerCase());if(!r)throw h.invalidParameterError("format",`one of: ${[...Xf.keys()].join(", ")}`,e);return this[r](t)}function Lb(e){if(h.object(e)){if(h.defined(e.quality))if(h.integer(e.quality)&&h.inRange(e.quality,1,100))this.options.jpegQuality=e.quality;else throw h.invalidParameterError("quality","integer between 1 and 100",e.quality);if(h.defined(e.progressive)&&this._setBooleanOption("jpegProgressive",e.progressive),h.defined(e.chromaSubsampling))if(h.string(e.chromaSubsampling)&&h.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jpegChromaSubsampling=e.chromaSubsampling;else throw h.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);let t=h.bool(e.optimizeCoding)?e.optimizeCoding:e.optimiseCoding;if(h.defined(t)&&this._setBooleanOption("jpegOptimiseCoding",t),h.defined(e.mozjpeg))if(h.bool(e.mozjpeg))e.mozjpeg&&(this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3);else throw h.invalidParameterError("mozjpeg","boolean",e.mozjpeg);let r=h.bool(e.trellisQuantization)?e.trellisQuantization:e.trellisQuantisation;h.defined(r)&&this._setBooleanOption("jpegTrellisQuantisation",r),h.defined(e.overshootDeringing)&&this._setBooleanOption("jpegOvershootDeringing",e.overshootDeringing);let o=h.bool(e.optimizeScans)?e.optimizeScans:e.optimiseScans;h.defined(o)&&(this._setBooleanOption("jpegOptimiseScans",o),o&&(this.options.jpegProgressive=!0));let a=h.number(e.quantizationTable)?e.quantizationTable:e.quantisationTable;if(h.defined(a))if(h.integer(a)&&h.inRange(a,0,8))this.options.jpegQuantisationTable=a;else throw h.invalidParameterError("quantisationTable","integer between 0 and 8",a)}return this._updateFormatOut("jpeg",e)}function Ob(e){if(h.object(e)){if(h.defined(e.progressive)&&this._setBooleanOption("pngProgressive",e.progressive),h.defined(e.compressionLevel))if(h.integer(e.compressionLevel)&&h.inRange(e.compressionLevel,0,9))this.options.pngCompressionLevel=e.compressionLevel;else throw h.invalidParameterError("compressionLevel","integer between 0 and 9",e.compressionLevel);h.defined(e.adaptiveFiltering)&&this._setBooleanOption("pngAdaptiveFiltering",e.adaptiveFiltering);let t=e.colours||e.colors;if(h.defined(t))if(h.integer(t)&&h.inRange(t,2,256))this.options.pngBitdepth=Kf(t);else throw h.invalidParameterError("colours","integer between 2 and 256",t);if(h.defined(e.palette)?this._setBooleanOption("pngPalette",e.palette):[e.quality,e.effort,e.colours,e.colors,e.dither].some(h.defined)&&this._setBooleanOption("pngPalette",!0),this.options.pngPalette){if(h.defined(e.quality))if(h.integer(e.quality)&&h.inRange(e.quality,0,100))this.options.pngQuality=e.quality;else throw h.invalidParameterError("quality","integer between 0 and 100",e.quality);if(h.defined(e.effort))if(h.integer(e.effort)&&h.inRange(e.effort,1,10))this.options.pngEffort=e.effort;else throw h.invalidParameterError("effort","integer between 1 and 10",e.effort);if(h.defined(e.dither))if(h.number(e.dither)&&h.inRange(e.dither,0,1))this.options.pngDither=e.dither;else throw h.invalidParameterError("dither","number between 0.0 and 1.0",e.dither)}}return this._updateFormatOut("png",e)}function jb(e){if(h.object(e)){if(h.defined(e.quality))if(h.integer(e.quality)&&h.inRange(e.quality,1,100))this.options.webpQuality=e.quality;else throw h.invalidParameterError("quality","integer between 1 and 100",e.quality);if(h.defined(e.alphaQuality))if(h.integer(e.alphaQuality)&&h.inRange(e.alphaQuality,0,100))this.options.webpAlphaQuality=e.alphaQuality;else throw h.invalidParameterError("alphaQuality","integer between 0 and 100",e.alphaQuality);if(h.defined(e.lossless)&&this._setBooleanOption("webpLossless",e.lossless),h.defined(e.nearLossless)&&this._setBooleanOption("webpNearLossless",e.nearLossless),h.defined(e.smartSubsample)&&this._setBooleanOption("webpSmartSubsample",e.smartSubsample),h.defined(e.preset))if(h.string(e.preset)&&h.inArray(e.preset,["default","photo","picture","drawing","icon","text"]))this.options.webpPreset=e.preset;else throw h.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",e.preset);if(h.defined(e.effort))if(h.integer(e.effort)&&h.inRange(e.effort,0,6))this.options.webpEffort=e.effort;else throw h.invalidParameterError("effort","integer between 0 and 6",e.effort);h.defined(e.minSize)&&this._setBooleanOption("webpMinSize",e.minSize),h.defined(e.mixed)&&this._setBooleanOption("webpMixed",e.mixed)}return Zf(e,this.options),this._updateFormatOut("webp",e)}function Fb(e){if(h.object(e)){h.defined(e.reuse)&&this._setBooleanOption("gifReuse",e.reuse),h.defined(e.progressive)&&this._setBooleanOption("gifProgressive",e.progressive);let t=e.colours||e.colors;if(h.defined(t))if(h.integer(t)&&h.inRange(t,2,256))this.options.gifBitdepth=Kf(t);else throw h.invalidParameterError("colours","integer between 2 and 256",t);if(h.defined(e.effort))if(h.number(e.effort)&&h.inRange(e.effort,1,10))this.options.gifEffort=e.effort;else throw h.invalidParameterError("effort","integer between 1 and 10",e.effort);if(h.defined(e.dither))if(h.number(e.dither)&&h.inRange(e.dither,0,1))this.options.gifDither=e.dither;else throw h.invalidParameterError("dither","number between 0.0 and 1.0",e.dither);if(h.defined(e.interFrameMaxError))if(h.number(e.interFrameMaxError)&&h.inRange(e.interFrameMaxError,0,32))this.options.gifInterFrameMaxError=e.interFrameMaxError;else throw h.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",e.interFrameMaxError);if(h.defined(e.interPaletteMaxError))if(h.number(e.interPaletteMaxError)&&h.inRange(e.interPaletteMaxError,0,256))this.options.gifInterPaletteMaxError=e.interPaletteMaxError;else throw h.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",e.interPaletteMaxError)}return Zf(e,this.options),this._updateFormatOut("gif",e)}function $b(e){if(!this.constructor.format.jp2k.output.buffer)throw Jf();if(h.object(e)){if(h.defined(e.quality))if(h.integer(e.quality)&&h.inRange(e.quality,1,100))this.options.jp2Quality=e.quality;else throw h.invalidParameterError("quality","integer between 1 and 100",e.quality);if(h.defined(e.lossless))if(h.bool(e.lossless))this.options.jp2Lossless=e.lossless;else throw h.invalidParameterError("lossless","boolean",e.lossless);if(h.defined(e.tileWidth))if(h.integer(e.tileWidth)&&h.inRange(e.tileWidth,1,32768))this.options.jp2TileWidth=e.tileWidth;else throw h.invalidParameterError("tileWidth","integer between 1 and 32768",e.tileWidth);if(h.defined(e.tileHeight))if(h.integer(e.tileHeight)&&h.inRange(e.tileHeight,1,32768))this.options.jp2TileHeight=e.tileHeight;else throw h.invalidParameterError("tileHeight","integer between 1 and 32768",e.tileHeight);if(h.defined(e.chromaSubsampling))if(h.string(e.chromaSubsampling)&&h.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jp2ChromaSubsampling=e.chromaSubsampling;else throw h.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling)}return this._updateFormatOut("jp2",e)}function Zf(e,t){if(h.object(e)&&h.defined(e.loop))if(h.integer(e.loop)&&h.inRange(e.loop,0,65535))t.loop=e.loop;else throw h.invalidParameterError("loop","integer between 0 and 65535",e.loop);if(h.object(e)&&h.defined(e.delay))if(h.integer(e.delay)&&h.inRange(e.delay,0,65535))t.delay=[e.delay];else if(Array.isArray(e.delay)&&e.delay.every(h.integer)&&e.delay.every(r=>h.inRange(r,0,65535)))t.delay=e.delay;else throw h.invalidParameterError("delay","integer or an array of integers between 0 and 65535",e.delay)}function Db(e){if(h.object(e)){if(h.defined(e.quality))if(h.integer(e.quality)&&h.inRange(e.quality,1,100))this.options.tiffQuality=e.quality;else throw h.invalidParameterError("quality","integer between 1 and 100",e.quality);if(h.defined(e.bitdepth))if(h.integer(e.bitdepth)&&h.inArray(e.bitdepth,[1,2,4,8]))this.options.tiffBitdepth=e.bitdepth;else throw h.invalidParameterError("bitdepth","1, 2, 4 or 8",e.bitdepth);if(h.defined(e.tile)&&this._setBooleanOption("tiffTile",e.tile),h.defined(e.tileWidth))if(h.integer(e.tileWidth)&&e.tileWidth>0)this.options.tiffTileWidth=e.tileWidth;else throw h.invalidParameterError("tileWidth","integer greater than zero",e.tileWidth);if(h.defined(e.tileHeight))if(h.integer(e.tileHeight)&&e.tileHeight>0)this.options.tiffTileHeight=e.tileHeight;else throw h.invalidParameterError("tileHeight","integer greater than zero",e.tileHeight);if(h.defined(e.miniswhite)&&this._setBooleanOption("tiffMiniswhite",e.miniswhite),h.defined(e.pyramid)&&this._setBooleanOption("tiffPyramid",e.pyramid),h.defined(e.xres))if(h.number(e.xres)&&e.xres>0)this.options.tiffXres=e.xres;else throw h.invalidParameterError("xres","number greater than zero",e.xres);if(h.defined(e.yres))if(h.number(e.yres)&&e.yres>0)this.options.tiffYres=e.yres;else throw h.invalidParameterError("yres","number greater than zero",e.yres);if(h.defined(e.compression))if(h.string(e.compression)&&h.inArray(e.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))this.options.tiffCompression=e.compression;else throw h.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",e.compression);if(h.defined(e.predictor))if(h.string(e.predictor)&&h.inArray(e.predictor,["none","horizontal","float"]))this.options.tiffPredictor=e.predictor;else throw h.invalidParameterError("predictor","one of: none, horizontal, float",e.predictor);if(h.defined(e.resolutionUnit))if(h.string(e.resolutionUnit)&&h.inArray(e.resolutionUnit,["inch","cm"]))this.options.tiffResolutionUnit=e.resolutionUnit;else throw h.invalidParameterError("resolutionUnit","one of: inch, cm",e.resolutionUnit)}return this._updateFormatOut("tiff",e)}function Nb(e){return this.heif({...e,compression:"av1"})}function Mb(e){if(h.object(e)){if(h.string(e.compression)&&h.inArray(e.compression,["av1","hevc"]))this.options.heifCompression=e.compression;else throw h.invalidParameterError("compression","one of: av1, hevc",e.compression);if(h.defined(e.quality))if(h.integer(e.quality)&&h.inRange(e.quality,1,100))this.options.heifQuality=e.quality;else throw h.invalidParameterError("quality","integer between 1 and 100",e.quality);if(h.defined(e.lossless))if(h.bool(e.lossless))this.options.heifLossless=e.lossless;else throw h.invalidParameterError("lossless","boolean",e.lossless);if(h.defined(e.effort))if(h.integer(e.effort)&&h.inRange(e.effort,0,9))this.options.heifEffort=e.effort;else throw h.invalidParameterError("effort","integer between 0 and 9",e.effort);if(h.defined(e.chromaSubsampling))if(h.string(e.chromaSubsampling)&&h.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.heifChromaSubsampling=e.chromaSubsampling;else throw h.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);if(h.defined(e.bitdepth))if(h.integer(e.bitdepth)&&h.inArray(e.bitdepth,[8,10,12])){if(e.bitdepth!==8&&this.constructor.versions.heif)throw h.invalidParameterError("bitdepth when using prebuilt binaries",8,e.bitdepth);this.options.heifBitdepth=e.bitdepth}else throw h.invalidParameterError("bitdepth","8, 10 or 12",e.bitdepth)}else throw h.invalidParameterError("options","Object",e);return this._updateFormatOut("heif",e)}function Wb(e){if(h.object(e)){if(h.defined(e.quality))if(h.integer(e.quality)&&h.inRange(e.quality,1,100))this.options.jxlDistance=e.quality>=30?.1+(100-e.quality)*.09:53/3e3*e.quality*e.quality-23/20*e.quality+25;else throw h.invalidParameterError("quality","integer between 1 and 100",e.quality);else if(h.defined(e.distance))if(h.number(e.distance)&&h.inRange(e.distance,0,15))this.options.jxlDistance=e.distance;else throw h.invalidParameterError("distance","number between 0.0 and 15.0",e.distance);if(h.defined(e.decodingTier))if(h.integer(e.decodingTier)&&h.inRange(e.decodingTier,0,4))this.options.jxlDecodingTier=e.decodingTier;else throw h.invalidParameterError("decodingTier","integer between 0 and 4",e.decodingTier);if(h.defined(e.lossless))if(h.bool(e.lossless))this.options.jxlLossless=e.lossless;else throw h.invalidParameterError("lossless","boolean",e.lossless);if(h.defined(e.effort))if(h.integer(e.effort)&&h.inRange(e.effort,3,9))this.options.jxlEffort=e.effort;else throw h.invalidParameterError("effort","integer between 3 and 9",e.effort)}return this._updateFormatOut("jxl",e)}function zb(e){if(h.object(e)&&h.defined(e.depth))if(h.string(e.depth)&&h.inArray(e.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))this.options.rawDepth=e.depth;else throw h.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",e.depth);return this._updateFormatOut("raw")}function Ub(e){if(h.object(e)){if(h.defined(e.size))if(h.integer(e.size)&&h.inRange(e.size,1,8192))this.options.tileSize=e.size;else throw h.invalidParameterError("size","integer between 1 and 8192",e.size);if(h.defined(e.overlap))if(h.integer(e.overlap)&&h.inRange(e.overlap,0,8192)){if(e.overlap>this.options.tileSize)throw h.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,e.overlap);this.options.tileOverlap=e.overlap}else throw h.invalidParameterError("overlap","integer between 0 and 8192",e.overlap);if(h.defined(e.container))if(h.string(e.container)&&h.inArray(e.container,["fs","zip"]))this.options.tileContainer=e.container;else throw h.invalidParameterError("container","one of: fs, zip",e.container);if(h.defined(e.layout))if(h.string(e.layout)&&h.inArray(e.layout,["dz","google","iiif","iiif3","zoomify"]))this.options.tileLayout=e.layout;else throw h.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",e.layout);if(h.defined(e.angle))if(h.integer(e.angle)&&!(e.angle%90))this.options.tileAngle=e.angle;else throw h.invalidParameterError("angle","positive/negative multiple of 90",e.angle);if(this._setBackgroundColourOption("tileBackground",e.background),h.defined(e.depth))if(h.string(e.depth)&&h.inArray(e.depth,["onepixel","onetile","one"]))this.options.tileDepth=e.depth;else throw h.invalidParameterError("depth","one of: onepixel, onetile, one",e.depth);if(h.defined(e.skipBlanks))if(h.integer(e.skipBlanks)&&h.inRange(e.skipBlanks,-1,65535))this.options.tileSkipBlanks=e.skipBlanks;else throw h.invalidParameterError("skipBlanks","integer between -1 and 255/65535",e.skipBlanks);else h.defined(e.layout)&&e.layout==="google"&&(this.options.tileSkipBlanks=5);let t=h.bool(e.center)?e.center:e.centre;if(h.defined(t)&&this._setBooleanOption("tileCentre",t),h.defined(e.id))if(h.string(e.id))this.options.tileId=e.id;else throw h.invalidParameterError("id","string",e.id);if(h.defined(e.basename))if(h.string(e.basename))this.options.tileBasename=e.basename;else throw h.invalidParameterError("basename","string",e.basename)}if(h.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if(this.options.formatOut!=="input")throw h.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function Hb(e){if(!h.plainObject(e))throw h.invalidParameterError("options","object",e);if(h.integer(e.seconds)&&h.inRange(e.seconds,0,3600))this.options.timeoutSeconds=e.seconds;else throw h.invalidParameterError("seconds","integer between 0 and 3600",e.seconds);return this}function Gb(e,t){return h.object(t)&&t.force===!1||(this.options.formatOut=e),this}function Vb(e,t){if(h.bool(t))this.options[e]=t;else throw h.invalidParameterError(e,"boolean",t)}function Qb(){if(!this.options.streamOut){this.options.streamOut=!0;let e=Error();this._pipeline(void 0,e)}}function Yb(e,t){return typeof e=="function"?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),Rr.pipeline(this.options,(r,o,a)=>{r?e(h.nativeError(r,t)):e(null,o,a)})}):Rr.pipeline(this.options,(r,o,a)=>{r?e(h.nativeError(r,t)):e(null,o,a)}),this):this.options.streamOut?(this._isStreamInput()?(this.once("finish",()=>{this._flattenBufferIn(),Rr.pipeline(this.options,(r,o,a)=>{r?this.emit("error",h.nativeError(r,t)):(this.emit("info",a),this.push(o)),this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished&&this.emit("finish")):Rr.pipeline(this.options,(r,o,a)=>{r?this.emit("error",h.nativeError(r,t)):(this.emit("info",a),this.push(o)),this.push(null),this.on("end",()=>this.emit("close"))}),this):this._isStreamInput()?new Promise((r,o)=>{this.once("finish",()=>{this._flattenBufferIn(),Rr.pipeline(this.options,(a,s,c)=>{a?o(h.nativeError(a,t)):this.options.resolveWithObject?r({data:s,info:c}):r(s)})})}):new Promise((r,o)=>{Rr.pipeline(this.options,(a,s,c)=>{a?o(h.nativeError(a,t)):this.options.resolveWithObject?r({data:s,info:c}):r(s)})})}eh.exports=function(e){Object.assign(e.prototype,{toFile:Rb,toBuffer:Pb,keepExif:Tb,withExif:Ab,withExifMerge:Cb,keepIccProfile:xb,withIccProfile:Ib,keepMetadata:kb,withMetadata:Bb,toFormat:qb,jpeg:Lb,jp2:$b,png:Ob,webp:jb,tiff:Db,avif:Nb,heif:Mb,jxl:Wb,gif:Fb,raw:zb,tile:Ub,timeout:Hb,_updateFormatOut:Gb,_setBooleanOption:Vb,_read:Qb,_pipeline:Yb})}});var ih=D((bv,oh)=>{"use strict";var Xb=Z("node:events"),Ro=so(),Oe=Ge(),{runtimePlatformArch:Jb}=Aa(),ye=cn(),rh=Jb(),Da=ye.libvipsVersion(),qt=ye.format();qt.heif.output.alias=["avif","heic"];qt.jpeg.output.alias=["jpe","jpg"];qt.tiff.output.alias=["tif"];qt.jp2k.output.alias=["j2c","j2k","jp2","jpx"];var Kb={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"},Pr={vips:Da.semver};if(!Da.isGlobal)if(Da.isWasm)try{Pr=Z("@img/sharp-wasm32/versions")}catch{}else try{Pr=Z(`@img/sharp-${rh}/versions`)}catch{try{Pr=Z(`@img/sharp-libvips-${rh}/versions`)}catch{}}Pr.sharp=Pa().version;Pr.heif&&qt.heif&&(qt.heif.input.fileSuffix=[".avif"],qt.heif.output.alias=["avif"]);function nh(e){return Oe.bool(e)?e?ye.cache(50,20,100):ye.cache(0,0,0):Oe.object(e)?ye.cache(e.memory,e.files,e.items):ye.cache()}nh(!0);function Zb(e){return ye.concurrency(Oe.integer(e)?e:null)}Ro.familySync()===Ro.GLIBC&&!ye._isUsingJemalloc()?ye.concurrency(1):Ro.familySync()===Ro.MUSL&&ye.concurrency()===1024&&ye.concurrency(Z("node:os").availableParallelism());var e0=new Xb.EventEmitter;function t0(){return ye.counters()}function r0(e){return ye.simd(Oe.bool(e)?e:null)}function n0(e){if(Oe.object(e))if(Array.isArray(e.operation)&&e.operation.every(Oe.string))ye.block(e.operation,!0);else throw Oe.invalidParameterError("operation","Array<string>",e.operation);else throw Oe.invalidParameterError("options","object",e)}function o0(e){if(Oe.object(e))if(Array.isArray(e.operation)&&e.operation.every(Oe.string))ye.block(e.operation,!1);else throw Oe.invalidParameterError("operation","Array<string>",e.operation);else throw Oe.invalidParameterError("options","object",e)}oh.exports=function(e){e.cache=nh,e.concurrency=Zb,e.counters=t0,e.simd=r0,e.format=qt,e.interpolators=Kb,e.versions=Pr,e.queue=e0,e.block=n0,e.unblock=o0}});var Na=D((wv,ah)=>{"use strict";var dt=hf();qf()(dt);Df()(dt);Mf()(dt);Uf()(dt);Vf()(dt);Yf()(dt);th()(dt);ih()(dt);ah.exports=dt});var wh=D(Ua=>{var uh=Object.defineProperty,i0=e=>uh(e,"__esModule",{value:!0}),a0=(e,t)=>{for(var r in t)uh(e,r,{get:t[r],enumerable:!0})};i0(Ua);a0(Ua,{GIFEncoder:()=>bh,applyPalette:()=>p0,default:()=>P0,nearestColor:()=>w0,nearestColorIndex:()=>ph,nearestColorIndexWithDistance:()=>gh,prequantize:()=>m0,quantize:()=>h0,snapColorsToPalette:()=>y0});var s0={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function fh(e=256){let t=0,r=new Uint8Array(e);return{get buffer(){return r.buffer},reset(){t=0},bytesView(){return r.subarray(0,t)},bytes(){return r.slice(0,t)},writeByte(a){o(t+1),r[t]=a,t++},writeBytes(a,s=0,c=a.length){o(t+c);for(let f=0;f<c;f++)r[t++]=a[f+s]},writeBytesView(a,s=0,c=a.byteLength){o(t+c),r.set(a.subarray(s,s+c),t),t+=c}};function o(a){var s=r.length;if(s>=a)return;var c=1024*1024;a=Math.max(a,s*(s<c?2:1.125)>>>0),s!=0&&(a=Math.max(a,256));let f=r;r=new Uint8Array(a),t>0&&r.set(f.subarray(0,t),0)}}var Ma=12,sh=5003,l0=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function c0(e,t,r,o,a=fh(512),s=new Uint8Array(256),c=new Int32Array(sh),f=new Int32Array(sh)){let m=c.length,g=Math.max(2,o);s.fill(0),f.fill(0),c.fill(-1);let p=0,y=0,E=g+1,I=E,R=!1,B=I,O=(1<<B)-1,P=1<<E-1,V=P+1,H=P+2,x=0,$=r[0],N=0;for(let Y=m;Y<65536;Y*=2)++N;N=8-N,a.writeByte(g),G(P);let M=r.length;for(let Y=1;Y<M;Y++)e:{let we=r[Y],fe=(we<<Ma)+$,ne=we<<N^$;if(c[ne]===fe){$=f[ne];break e}let et=ne===0?1:m-ne;for(;c[ne]>=0;)if(ne-=et,ne<0&&(ne+=m),c[ne]===fe){$=f[ne];break e}G($),$=we,H<1<<Ma?(f[ne]=H++,c[ne]=fe):(c.fill(-1),H=P+2,R=!0,G(P))}return G($),G(V),a.writeByte(0),a.bytesView();function G(Y){for(p&=l0[y],y>0?p|=Y<<y:p=Y,y+=B;y>=8;)s[x++]=p&255,x>=254&&(a.writeByte(x),a.writeBytesView(s,0,x),x=0),p>>=8,y-=8;if((H>O||R)&&(R?(B=I,O=(1<<B)-1,R=!1):(++B,O=B===Ma?1<<B:(1<<B)-1)),Y==V){for(;y>0;)s[x++]=p&255,x>=254&&(a.writeByte(x),a.writeBytesView(s,0,x),x=0),p>>=8,y-=8;x>0&&(a.writeByte(x),a.writeBytesView(s,0,x),x=0)}}}var u0=c0;function hh(e,t,r){return e<<8&63488|t<<2&992|r>>3}function dh(e,t,r,o){return e>>4|t&240|(r&240)<<4|(o&240)<<8}function mh(e,t,r){return e>>4<<8|t&240|r>>4}function Po(e,t,r){return e<t?t:e>r?r:e}function dn(e){return e*e}function lh(e,t,r){var o=0,a=1e100;let s=e[t],c=s.cnt,f=s.ac,m=s.rc,g=s.gc,p=s.bc;for(var y=s.fw;y!=0;y=e[y].fw){let I=e[y],R=I.cnt,B=c*R/(c+R);if(!(B>=a)){var E=0;r&&(E+=B*dn(I.ac-f),E>=a)||(E+=B*dn(I.rc-m),!(E>=a)&&(E+=B*dn(I.gc-g),!(E>=a)&&(E+=B*dn(I.bc-p),!(E>=a)&&(a=E,o=y))))}}s.err=a,s.nn=o}function Wa(){return{ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0}}function f0(e,t){let r=t==="rgb444"?4096:65536,o=new Array(r),a=e.length;if(t==="rgba4444")for(let s=0;s<a;++s){let c=e[s],f=c>>24&255,m=c>>16&255,g=c>>8&255,p=c&255,y=dh(p,g,m,f),E=y in o?o[y]:o[y]=Wa();E.rc+=p,E.gc+=g,E.bc+=m,E.ac+=f,E.cnt++}else if(t==="rgb444")for(let s=0;s<a;++s){let c=e[s],f=c>>16&255,m=c>>8&255,g=c&255,p=mh(g,m,f),y=p in o?o[p]:o[p]=Wa();y.rc+=g,y.gc+=m,y.bc+=f,y.cnt++}else for(let s=0;s<a;++s){let c=e[s],f=c>>16&255,m=c>>8&255,g=c&255,p=hh(g,m,f),y=p in o?o[p]:o[p]=Wa();y.rc+=g,y.gc+=m,y.bc+=f,y.cnt++}return o}function h0(e,t,r={}){let{format:o="rgb565",clearAlpha:a=!0,clearAlphaColor:s=0,clearAlphaThreshold:c=0,oneBitAlpha:f=!1}=r;if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array)&&!(e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");let m=new Uint32Array(e.buffer),g=r.useSqrt!==!1,p=o==="rgba4444",y=f0(m,o),E=y.length,I=E-1,R=new Uint32Array(E+1);for(var B=0,P=0;P<E;++P){let ae=y[P];if(ae!=null){var O=1/ae.cnt;p&&(ae.ac*=O),ae.rc*=O,ae.gc*=O,ae.bc*=O,y[B++]=ae}}dn(t)/B<.022&&(g=!1);for(var P=0;P<B-1;++P)y[P].fw=P+1,y[P+1].bk=P,g&&(y[P].cnt=Math.sqrt(y[P].cnt));g&&(y[P].cnt=Math.sqrt(y[P].cnt));var V,H,x;for(P=0;P<B;++P){lh(y,P,!1);var $=y[P].err;for(H=++R[0];H>1&&(x=H>>1,!(y[V=R[x]].err<=$));H=x)R[H]=V;R[H]=P}var N=B-t;for(P=0;P<N;){for(var M;;){var G=R[1];if(M=y[G],M.tm>=M.mtm&&y[M.nn].mtm<=M.tm)break;M.mtm==I?G=R[1]=R[R[0]--]:(lh(y,G,!1),M.tm=P);var $=y[G].err;for(H=1;(x=H+H)<=R[0]&&(x<R[0]&&y[R[x]].err>y[R[x+1]].err&&x++,!($<=y[V=R[x]].err));H=x)R[H]=V;R[H]=G}var Y=y[M.nn],we=M.cnt,fe=Y.cnt,O=1/(we+fe);p&&(M.ac=O*(we*M.ac+fe*Y.ac)),M.rc=O*(we*M.rc+fe*Y.rc),M.gc=O*(we*M.gc+fe*Y.gc),M.bc=O*(we*M.bc+fe*Y.bc),M.cnt+=Y.cnt,M.mtm=++P,y[Y.bk].fw=Y.fw,y[Y.fw].bk=Y.bk,Y.mtm=I}let ne=[];var et=0;for(P=0;;++et){let je=Po(Math.round(y[P].rc),0,255),ae=Po(Math.round(y[P].gc),0,255),ve=Po(Math.round(y[P].bc),0,255),ke=255;p&&(ke=Po(Math.round(y[P].ac),0,255),f&&(ke=ke<=(typeof f=="number"?f:127)?0:255),a&&ke<=c&&(je=ae=ve=s,ke=0));let $t=p?[je,ae,ve,ke]:[je,ae,ve];if(d0(ne,$t)||ne.push($t),(P=y[P].fw)==0)break}return ne}function d0(e,t){for(let r=0;r<e.length;r++){let o=e[r],a=o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2],s=o.length>=4&&t.length>=4?o[3]===t[3]:!0;if(a&&s)return!0}return!1}function Ao(e,t){var r=0,o;for(o=0;o<e.length;o++){let a=e[o]-t[o];r+=a*a}return r}function To(e,t){return t>1?Math.round(e/t)*t:e}function m0(e,{roundRGB:t=5,roundAlpha:r=10,oneBitAlpha:o=null}={}){let a=new Uint32Array(e.buffer);for(let s=0;s<a.length;s++){let c=a[s],f=c>>24&255,m=c>>16&255,g=c>>8&255,p=c&255;f=To(f,r),o&&(f=f<=(typeof o=="number"?o:127)?0:255),p=To(p,t),g=To(g,t),m=To(m,t),a[s]=f<<24|m<<16|g<<8|p<<0}}function p0(e,t,r="rgb565"){if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array)&&!(e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");if(t.length>256)throw new Error("applyPalette() only works with 256 colors or less");let o=new Uint32Array(e.buffer),a=o.length,s=r==="rgb444"?4096:65536,c=new Uint8Array(a),f=new Array(s),m=r==="rgba4444";if(r==="rgba4444")for(let g=0;g<a;g++){let p=o[g],y=p>>24&255,E=p>>16&255,I=p>>8&255,R=p&255,B=dh(R,I,E,y),O=B in f?f[B]:f[B]=g0(R,I,E,y,t);c[g]=O}else{let g=r==="rgb444"?mh:hh;for(let p=0;p<a;p++){let y=o[p],E=y>>16&255,I=y>>8&255,R=y&255,B=g(R,I,E),O=B in f?f[B]:f[B]=b0(R,I,E,t);c[p]=O}}return c}function g0(e,t,r,o,a){let s=0,c=1e100;for(let f=0;f<a.length;f++){let m=a[f],g=m[3],p=Xt(g-o);if(p>c)continue;let y=m[0];if(p+=Xt(y-e),p>c)continue;let E=m[1];if(p+=Xt(E-t),p>c)continue;let I=m[2];p+=Xt(I-r),!(p>c)&&(c=p,s=f)}return s}function b0(e,t,r,o){let a=0,s=1e100;for(let c=0;c<o.length;c++){let f=o[c],m=f[0],g=Xt(m-e);if(g>s)continue;let p=f[1];if(g+=Xt(p-t),g>s)continue;let y=f[2];g+=Xt(y-r),!(g>s)&&(s=g,a=c)}return a}function y0(e,t,r=5){if(!e.length||!t.length)return;let o=e.map(c=>c.slice(0,3)),a=r*r,s=e[0].length;for(let c=0;c<t.length;c++){let f=t[c];f.length<s?f=[f[0],f[1],f[2],255]:f.length>s?f=f.slice(0,3):f=f.slice();let m=gh(o,f.slice(0,3),Ao),g=m[0],p=m[1];p>0&&p<=a&&(e[g]=f)}}function Xt(e){return e*e}function ph(e,t,r=Ao){let o=1/0,a=-1;for(let s=0;s<e.length;s++){let c=e[s],f=r(t,c);f<o&&(o=f,a=s)}return a}function gh(e,t,r=Ao){let o=1/0,a=-1;for(let s=0;s<e.length;s++){let c=e[s],f=r(t,c);f<o&&(o=f,a=s)}return[a,o]}function w0(e,t,r=Ao){return e[ph(e,t,r)]}function bh(e={}){let{initialCapacity:t=4096,auto:r=!0}=e,o=fh(t),a=5003,s=new Uint8Array(256),c=new Int32Array(a),f=new Int32Array(a),m=!1;return{reset(){o.reset(),m=!1},finish(){o.writeByte(s0.trailer)},bytes(){return o.bytes()},bytesView(){return o.bytesView()},get buffer(){return o.buffer},get stream(){return o},writeHeader:g,writeFrame(p,y,E,I={}){let{transparent:R=!1,transparentIndex:B=0,delay:O=0,palette:P=null,repeat:V=0,colorDepth:H=8,dispose:x=-1}=I,$=!1;if(r?m||($=!0,g(),m=!0):$=!!I.first,y=Math.max(0,Math.floor(y)),E=Math.max(0,Math.floor(E)),$){if(!P)throw new Error("First frame must include a { palette } option");E0(o,y,E,P,H),ch(o,P),V>=0&&S0(o,V)}let N=Math.round(O/10);v0(o,x,N,R,B);let M=!!P&&!$;_0(o,y,E,M?P:null),M&&ch(o,P),R0(o,p,y,E,H,s,c,f)}};function g(){yh(o,"GIF89a")}}function v0(e,t,r,o,a){e.writeByte(33),e.writeByte(249),e.writeByte(4),a<0&&(a=0,o=!1);var s,c;o?(s=1,c=2):(s=0,c=0),t>=0&&(c=t&7),c<<=2,e.writeByte(0|c|0|s),Lt(e,r),e.writeByte(a||0),e.writeByte(0)}function E0(e,t,r,o,a=8){let f=za(o.length)-1,m=128|a-1<<4|0|f,g=0,p=0;Lt(e,t),Lt(e,r),e.writeBytes([m,g,p])}function S0(e,t){e.writeByte(33),e.writeByte(255),e.writeByte(11),yh(e,"NETSCAPE2.0"),e.writeByte(3),e.writeByte(1),Lt(e,t),e.writeByte(0)}function ch(e,t){let r=1<<za(t.length);for(let o=0;o<r;o++){let a=[0,0,0];o<t.length&&(a=t[o]),e.writeByte(a[0]),e.writeByte(a[1]),e.writeByte(a[2])}}function _0(e,t,r,o){if(e.writeByte(44),Lt(e,0),Lt(e,0),Lt(e,t),Lt(e,r),o){let c=za(o.length)-1;e.writeByte(128|c)}else e.writeByte(0)}function R0(e,t,r,o,a=8,s,c,f){u0(r,o,t,a,e,s,c,f)}function Lt(e,t){e.writeByte(t&255),e.writeByte(t>>8&255)}function yh(e,t){for(var r=0;r<t.length;r++)e.writeByte(t.charCodeAt(r))}function za(e){return Math.max(Math.ceil(Math.log2(e)),1)}var P0=bh});var Sh=D((Ev,Eh)=>{var Ha=Na(),{GIFEncoder:vh,quantize:T0,applyPalette:A0}=wh(),Co=class{constructor(t){this.image=t}async toFrames(t=()=>{}){let{image:r}=this,{pages:o,width:a,pageHeight:s}=await r.metadata(),c=[];if(o>1){r=Ha(await r.png().toBuffer());for(let f=0;f<o;f++){t({cutted:f,total:o});let m=r.clone().extract({left:0,top:s*f,width:a,height:s});c.push(Ha(await m.toBuffer()))}}else c.push(r);return this.frames=c,c}async toGif(t={}){return new xo(t).addFrame(this.frames||await this.toFrames())}},xo=class{constructor(t={}){this.options=t,this.frames=[]}addFrame(t){return Array.isArray(t)?this.frames.push(...t):this.frames.push(t),this}getEncoder(t){return new vh(t)}async toBuffer(t=()=>{},r){let{options:o,frames:a}=this,{width:s,height:c,delay:f=[],repeat:m=0,transparent:g=!1,maxColors:p=256,format:y="rgb565",resizeTo:E="largest",resizeType:I="zoom",resizeOptions:R={},extendBackground:B={r:0,g:0,b:0,alpha:0},rawOptions:O,gifEncoderOptions:P={},gifEncoderQuantizeOptions:V={},gifEncoderFrameOptions:H={}}=o;typeof f=="number"&&(f=new Array(a.length).fill(f)),m===1&&(m=-1);let{fit:x}=R;(x==="inside"||x==="outside")&&(R.fit="contain");let $=[];for(let N=0;N<a.length;N++)$.push(...await new Co(a[N]).toFrames());if(!s||!c){let N=await Promise.all(a.map(G=>G.metadata())),M=E==="largest"?Math.max:Math.min;s=s||M(...N.map(G=>G.width)),c=c||M(...N.map(G=>G.pageHeight||G.height))}r||(r=vh(P));for(let N=0;N<$.length;N++){let M=$[N],{width:G,height:Y}=await M.metadata();if(G!==s||Y!==c)if(I==="zoom")M.resize({...R,width:s,height:c});else{let je=Math.abs(s-G)/2;G<s?M.extend({left:je,right:je,background:B}):G>s&&M.extract({left:je,top:0,width:s,height:c});let ae=Math.abs(c-Y)/2;Y<c?M.extend({top:ae,bottom:ae,background:B}):Y>c&&M.extract({left:0,top:ae,width:s,height:c})}let{buffer:we}=await M.ensureAlpha().raw(O).toBuffer(),fe=new Uint8ClampedArray(we),ne=T0(fe,p,{format:y,...V}),et=A0(fe,ne,y);r.writeFrame(et,s,c,{transparent:g,delay:f[N],repeat:m,...H,palette:ne}),t({total:$.length,encoded:N+1})}return r.finish(),r.bytes()}async toSharp(t,r){let o=await this.toBuffer(t,r);return Ha(o,{animated:!0,...this.options.sharpOptions}).gif({loop:this.options.repeat||0,delay:this.options.delay})}};Eh.exports={createGif:(e={})=>new xo(e),readGif:e=>new Co(e)}});function Ga(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var C0,x0,Io,ko=da(()=>{C0=Object.defineProperty,x0=(e,t)=>C0(e,"name",{value:t,configurable:!0}),Io=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};x0(Ga,"getDefaultExportFromCjs")});var Ah={};Xd(Ah,{toFormData:()=>Th});function Ph(e){let t=e.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let r=t[2]||t[3]||"",o=r.slice(r.lastIndexOf("\\")+1);return o=o.replace(/%22/g,'"'),o=o.replace(/&#(\d{4});/g,(a,s)=>String.fromCharCode(s)),o}async function Th(e,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let r=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!r)throw new TypeError("no or bad content-type header, no multipart boundary");let o=new j0(r[1]||r[2]),a,s,c,f,m,g,p=[],y=new Kt,E=Ie(P=>{c+=O.decode(P,{stream:!0})},"onPartData"),I=Ie(P=>{p.push(P)},"appendToFile"),R=Ie(()=>{let P=new Tr(p,g,{type:m});y.append(f,P)},"appendFileToFormData"),B=Ie(()=>{y.append(f,c)},"appendEntryToFormData"),O=new TextDecoder("utf-8");O.decode(),o.onPartBegin=function(){o.onPartData=E,o.onPartEnd=B,a="",s="",c="",f="",m="",g=null,p.length=0},o.onHeaderField=function(P){a+=O.decode(P,{stream:!0})},o.onHeaderValue=function(P){s+=O.decode(P,{stream:!0})},o.onHeaderEnd=function(){if(s+=O.decode(),a=a.toLowerCase(),a==="content-disposition"){let P=s.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);P&&(f=P[2]||P[3]||""),g=Ph(s),g&&(o.onPartData=I,o.onPartEnd=R)}else a==="content-type"&&(m=s);s="",a=""};for await(let P of e)o.write(P);return o.end(),y}var I0,Ie,Xe,ee,_h,Ot,Bo,qo,k0,mn,B0,q0,L0,O0,Jt,Rh,j0,Ch=da(()=>{Lo();ko();I0=Object.defineProperty,Ie=(e,t)=>I0(e,"name",{value:t,configurable:!0}),Xe=0,ee={START_BOUNDARY:Xe++,HEADER_FIELD_START:Xe++,HEADER_FIELD:Xe++,HEADER_VALUE_START:Xe++,HEADER_VALUE:Xe++,HEADER_VALUE_ALMOST_DONE:Xe++,HEADERS_ALMOST_DONE:Xe++,PART_DATA_START:Xe++,PART_DATA:Xe++,END:Xe++},_h=1,Ot={PART_BOUNDARY:_h,LAST_BOUNDARY:_h*=2},Bo=10,qo=13,k0=32,mn=45,B0=58,q0=97,L0=122,O0=Ie(e=>e|32,"lower"),Jt=Ie(()=>{},"noop"),Rh=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=Jt,this.onHeaderField=Jt,this.onHeadersEnd=Jt,this.onHeaderValue=Jt,this.onPartBegin=Jt,this.onPartData=Jt,this.onPartEnd=Jt,this.boundaryChars={},t=`\r
--`+t;let r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o),this.boundaryChars[r[o]]=!0;this.boundary=r,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=ee.START_BOUNDARY}write(t){let r=0,o=t.length,a=this.index,{lookbehind:s,boundary:c,boundaryChars:f,index:m,state:g,flags:p}=this,y=this.boundary.length,E=y-1,I=t.length,R,B,O=Ie(x=>{this[x+"Mark"]=r},"mark"),P=Ie(x=>{delete this[x+"Mark"]},"clear"),V=Ie((x,$,N,M)=>{($===void 0||$!==N)&&this[x](M&&M.subarray($,N))},"callback"),H=Ie((x,$)=>{let N=x+"Mark";N in this&&($?(V(x,this[N],r,t),delete this[N]):(V(x,this[N],t.length,t),this[N]=0))},"dataCallback");for(r=0;r<o;r++)switch(R=t[r],g){case ee.START_BOUNDARY:if(m===c.length-2){if(R===mn)p|=Ot.LAST_BOUNDARY;else if(R!==qo)return;m++;break}else if(m-1===c.length-2){if(p&Ot.LAST_BOUNDARY&&R===mn)g=ee.END,p=0;else if(!(p&Ot.LAST_BOUNDARY)&&R===Bo)m=0,V("onPartBegin"),g=ee.HEADER_FIELD_START;else return;break}R!==c[m+2]&&(m=-2),R===c[m+2]&&m++;break;case ee.HEADER_FIELD_START:g=ee.HEADER_FIELD,O("onHeaderField"),m=0;case ee.HEADER_FIELD:if(R===qo){P("onHeaderField"),g=ee.HEADERS_ALMOST_DONE;break}if(m++,R===mn)break;if(R===B0){if(m===1)return;H("onHeaderField",!0),g=ee.HEADER_VALUE_START;break}if(B=O0(R),B<q0||B>L0)return;break;case ee.HEADER_VALUE_START:if(R===k0)break;O("onHeaderValue"),g=ee.HEADER_VALUE;case ee.HEADER_VALUE:R===qo&&(H("onHeaderValue",!0),V("onHeaderEnd"),g=ee.HEADER_VALUE_ALMOST_DONE);break;case ee.HEADER_VALUE_ALMOST_DONE:if(R!==Bo)return;g=ee.HEADER_FIELD_START;break;case ee.HEADERS_ALMOST_DONE:if(R!==Bo)return;V("onHeadersEnd"),g=ee.PART_DATA_START;break;case ee.PART_DATA_START:g=ee.PART_DATA,O("onPartData");case ee.PART_DATA:if(a=m,m===0){for(r+=E;r<I&&!(t[r]in f);)r+=y;r-=E,R=t[r]}if(m<c.length)c[m]===R?(m===0&&H("onPartData",!0),m++):m=0;else if(m===c.length)m++,R===qo?p|=Ot.PART_BOUNDARY:R===mn?p|=Ot.LAST_BOUNDARY:m=0;else if(m-1===c.length)if(p&Ot.PART_BOUNDARY){if(m=0,R===Bo){p&=~Ot.PART_BOUNDARY,V("onPartEnd"),V("onPartBegin"),g=ee.HEADER_FIELD_START;break}}else p&Ot.LAST_BOUNDARY&&R===mn?(V("onPartEnd"),g=ee.END,p=0):m=0;if(m>0)s[m-1]=R;else if(a>0){let x=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);V("onPartData",0,a,x),a=0,O("onPartData"),r--}break;case ee.END:break;default:throw new Error(`Unexpected state entered: ${g}`)}H("onHeaderField"),H("onHeaderValue"),H("onPartData"),this.index=m,this.state=g,this.flags=p}end(){if(this.state===ee.HEADER_FIELD_START&&this.index===0||this.state===ee.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==ee.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}};Ie(Rh,"MultipartParser");j0=Rh;Ie(Ph,"_fileName");Ie(Th,"toFormData")});import En from"node:http";import $0 from"node:https";import Cr from"node:zlib";import Ze,{PassThrough as Wo,pipeline as xr}from"node:stream";import{Buffer as de}from"node:buffer";import{types as zo,promisify as D0,deprecate as Uo}from"node:util";import{format as N0}from"node:url";import{isIP as M0}from"node:net";import{statSync as jh,createReadStream as W0,promises as z0}from"node:fs";import{basename as U0}from"node:path";function Fh(e){if(!/^data:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');e=e.replace(/\r?\n/g,"");let t=e.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let r=e.substring(5,t).split(";"),o="",a=!1,s=r[0]||"text/plain",c=s;for(let p=1;p<r.length;p++)r[p]==="base64"?a=!0:r[p]&&(c+=`;${r[p]}`,r[p].indexOf("charset=")===0&&(o=r[p].substring(8)));!r[0]&&!o.length&&(c+=";charset=US-ASCII",o="US-ASCII");let f=a?"base64":"ascii",m=unescape(e.substring(t+1)),g=Buffer.from(m,f);return g.type=s,g.typeFull=c,g.charset=o,g}function $h(){return xh||(xh=1,function(e,t){(function(r,o){o(t)})(Io,function(r){function o(){}u(o,"noop");function a(n){return typeof n=="object"&&n!==null||typeof n=="function"}u(a,"typeIsObject");let s=o;function c(n,i){try{Object.defineProperty(n,"name",{value:i,configurable:!0})}catch{}}u(c,"setFunctionName");let f=Promise,m=Promise.prototype.then,g=Promise.reject.bind(f);function p(n){return new f(n)}u(p,"newPromise");function y(n){return p(i=>i(n))}u(y,"promiseResolvedWith");function E(n){return g(n)}u(E,"promiseRejectedWith");function I(n,i,l){return m.call(n,i,l)}u(I,"PerformPromiseThen");function R(n,i,l){I(I(n,i,l),void 0,s)}u(R,"uponPromise");function B(n,i){R(n,i)}u(B,"uponFulfillment");function O(n,i){R(n,void 0,i)}u(O,"uponRejection");function P(n,i,l){return I(n,i,l)}u(P,"transformPromiseWith");function V(n){I(n,void 0,s)}u(V,"setPromiseIsHandledToTrue");let H=u(n=>{if(typeof queueMicrotask=="function")H=queueMicrotask;else{let i=y(void 0);H=u(l=>I(i,l),"_queueMicrotask")}return H(n)},"_queueMicrotask");function x(n,i,l){if(typeof n!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(n,i,l)}u(x,"reflectCall");function $(n,i,l){try{return y(x(n,i,l))}catch(d){return E(d)}}u($,"promiseCall");let N=16384,M=class{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(i){let l=this._back,d=l;l._elements.length===N-1&&(d={_elements:[],_next:void 0}),l._elements.push(i),d!==l&&(this._back=d,l._next=d),++this._size}shift(){let i=this._front,l=i,d=this._cursor,b=d+1,v=i._elements,_=v[d];return b===N&&(l=i._next,b=0),--this._size,this._cursor=b,i!==l&&(this._front=l),v[d]=void 0,_}forEach(i){let l=this._cursor,d=this._front,b=d._elements;for(;(l!==b.length||d._next!==void 0)&&!(l===b.length&&(d=d._next,b=d._elements,l=0,b.length===0));)i(b[l]),++l}peek(){let i=this._front,l=this._cursor;return i._elements[l]}};u(M,"SimpleQueue");let G=M,Y=Symbol("[[AbortSteps]]"),we=Symbol("[[ErrorSteps]]"),fe=Symbol("[[CancelSteps]]"),ne=Symbol("[[PullSteps]]"),et=Symbol("[[ReleaseSteps]]");function je(n,i){n._ownerReadableStream=i,i._reader=n,i._state==="readable"?$t(n):i._state==="closed"?ei(n):Pn(n,i._storedError)}u(je,"ReadableStreamReaderGenericInitialize");function ae(n,i){let l=n._ownerReadableStream;return qe(l,i)}u(ae,"ReadableStreamReaderGenericCancel");function ve(n){let i=n._ownerReadableStream;i._state==="readable"?Tn(n,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):As(n,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),i._readableStreamController[et](),i._reader=void 0,n._ownerReadableStream=void 0}u(ve,"ReadableStreamReaderGenericRelease");function ke(n){return new TypeError("Cannot "+n+" a stream using a released reader")}u(ke,"readerLockException");function $t(n){n._closedPromise=p((i,l)=>{n._closedPromise_resolve=i,n._closedPromise_reject=l})}u($t,"defaultReaderClosedPromiseInitialize");function Pn(n,i){$t(n),Tn(n,i)}u(Pn,"defaultReaderClosedPromiseInitializeAsRejected");function ei(n){$t(n),ti(n)}u(ei,"defaultReaderClosedPromiseInitializeAsResolved");function Tn(n,i){n._closedPromise_reject!==void 0&&(V(n._closedPromise),n._closedPromise_reject(i),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0)}u(Tn,"defaultReaderClosedPromiseReject");function As(n,i){Pn(n,i)}u(As,"defaultReaderClosedPromiseResetToRejected");function ti(n){n._closedPromise_resolve!==void 0&&(n._closedPromise_resolve(void 0),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0)}u(ti,"defaultReaderClosedPromiseResolve");let Cs=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},Nd=Math.trunc||function(n){return n<0?Math.ceil(n):Math.floor(n)};function xs(n){return typeof n=="object"||typeof n=="function"}u(xs,"isDictionary");function Fe(n,i){if(n!==void 0&&!xs(n))throw new TypeError(`${i} is not an object.`)}u(Fe,"assertDictionary");function Te(n,i){if(typeof n!="function")throw new TypeError(`${i} is not a function.`)}u(Te,"assertFunction");function Is(n){return typeof n=="object"&&n!==null||typeof n=="function"}u(Is,"isObject");function ri(n,i){if(!Is(n))throw new TypeError(`${i} is not an object.`)}u(ri,"assertObject");function He(n,i,l){if(n===void 0)throw new TypeError(`Parameter ${i} is required in '${l}'.`)}u(He,"assertRequiredArgument");function An(n,i,l){if(n===void 0)throw new TypeError(`${i} is required in '${l}'.`)}u(An,"assertRequiredField");function Cn(n){return Number(n)}u(Cn,"convertUnrestrictedDouble");function ni(n){return n===0?0:n}u(ni,"censorNegativeZero");function ks(n){return ni(Nd(n))}u(ks,"integerPart");function xn(n,i){let l=Number.MAX_SAFE_INTEGER,d=Number(n);if(d=ni(d),!Cs(d))throw new TypeError(`${i} is not a finite number`);if(d=ks(d),d<0||d>l)throw new TypeError(`${i} is outside the accepted range of 0 to ${l}, inclusive`);return!Cs(d)||d===0?0:d}u(xn,"convertUnsignedLongLongWithEnforceRange");function In(n,i){if(!st(n))throw new TypeError(`${i} is not a ReadableStream.`)}u(In,"assertReadableStream");function Dt(n){return new gt(n)}u(Dt,"AcquireReadableStreamDefaultReader");function oi(n,i){n._reader._readRequests.push(i)}u(oi,"ReadableStreamAddReadRequest");function kn(n,i,l){let d=n._reader._readRequests.shift();l?d._closeSteps():d._chunkSteps(i)}u(kn,"ReadableStreamFulfillReadRequest");function Lr(n){return n._reader._readRequests.length}u(Lr,"ReadableStreamGetNumReadRequests");function ii(n){let i=n._reader;return!(i===void 0||!tt(i))}u(ii,"ReadableStreamHasDefaultReader");let Bs=class{constructor(i){if(He(i,1,"ReadableStreamDefaultReader"),In(i,"First parameter"),lt(i))throw new TypeError("This stream has already been locked for exclusive reading by another reader");je(this,i),this._readRequests=new G}get closed(){return tt(this)?this._closedPromise:E(Or("closed"))}cancel(i=void 0){return tt(this)?this._ownerReadableStream===void 0?E(ke("cancel")):ae(this,i):E(Or("cancel"))}read(){if(!tt(this))return E(Or("read"));if(this._ownerReadableStream===void 0)return E(ke("read from"));let i,l,d=p((b,v)=>{i=b,l=v});return or(this,{_chunkSteps:b=>i({value:b,done:!1}),_closeSteps:()=>i({value:void 0,done:!0}),_errorSteps:b=>l(b)}),d}releaseLock(){if(!tt(this))throw Or("releaseLock");this._ownerReadableStream!==void 0&&qs(this)}};u(Bs,"ReadableStreamDefaultReader");let gt=Bs;Object.defineProperties(gt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),c(gt.prototype.cancel,"cancel"),c(gt.prototype.read,"read"),c(gt.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(gt.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function tt(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_readRequests")?!1:n instanceof gt}u(tt,"IsReadableStreamDefaultReader");function or(n,i){let l=n._ownerReadableStream;l._disturbed=!0,l._state==="closed"?i._closeSteps():l._state==="errored"?i._errorSteps(l._storedError):l._readableStreamController[ne](i)}u(or,"ReadableStreamDefaultReaderRead");function qs(n){ve(n);let i=new TypeError("Reader was released");ai(n,i)}u(qs,"ReadableStreamDefaultReaderRelease");function ai(n,i){let l=n._readRequests;n._readRequests=new G,l.forEach(d=>{d._errorSteps(i)})}u(ai,"ReadableStreamDefaultReaderErrorReadRequests");function Or(n){return new TypeError(`ReadableStreamDefaultReader.prototype.${n} can only be used on a ReadableStreamDefaultReader`)}u(Or,"defaultReaderBrandCheckException");let Md=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype),Ls=class{constructor(i,l){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=i,this._preventCancel=l}next(){let i=u(()=>this._nextSteps(),"nextSteps");return this._ongoingPromise=this._ongoingPromise?P(this._ongoingPromise,i,i):i(),this._ongoingPromise}return(i){let l=u(()=>this._returnSteps(i),"returnSteps");return this._ongoingPromise?P(this._ongoingPromise,l,l):l()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let i=this._reader,l,d,b=p((v,_)=>{l=v,d=_});return or(i,{_chunkSteps:v=>{this._ongoingPromise=void 0,H(()=>l({value:v,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ve(i),l({value:void 0,done:!0})},_errorSteps:v=>{this._ongoingPromise=void 0,this._isFinished=!0,ve(i),d(v)}}),b}_returnSteps(i){if(this._isFinished)return Promise.resolve({value:i,done:!0});this._isFinished=!0;let l=this._reader;if(!this._preventCancel){let d=ae(l,i);return ve(l),P(d,()=>({value:i,done:!0}))}return ve(l),y({value:i,done:!0})}};u(Ls,"ReadableStreamAsyncIteratorImpl");let Os=Ls,js={next(){return si(this)?this._asyncIteratorImpl.next():E(li("next"))},return(n){return si(this)?this._asyncIteratorImpl.return(n):E(li("return"))}};Object.setPrototypeOf(js,Md);function Fs(n,i){let l=Dt(n),d=new Os(l,i),b=Object.create(js);return b._asyncIteratorImpl=d,b}u(Fs,"AcquireReadableStreamAsyncIterator");function si(n){if(!a(n)||!Object.prototype.hasOwnProperty.call(n,"_asyncIteratorImpl"))return!1;try{return n._asyncIteratorImpl instanceof Os}catch{return!1}}u(si,"IsReadableStreamAsyncIterator");function li(n){return new TypeError(`ReadableStreamAsyncIterator.${n} can only be used on a ReadableSteamAsyncIterator`)}u(li,"streamAsyncIteratorBrandCheckException");let $s=Number.isNaN||function(n){return n!==n};var ci,ui,fi;function ir(n){return n.slice()}u(ir,"CreateArrayFromList");function hi(n,i,l,d,b){new Uint8Array(n).set(new Uint8Array(l,d,b),i)}u(hi,"CopyDataBlockBytes");let rt=u(n=>(typeof n.transfer=="function"?rt=u(i=>i.transfer(),"TransferArrayBuffer"):typeof structuredClone=="function"?rt=u(i=>structuredClone(i,{transfer:[i]}),"TransferArrayBuffer"):rt=u(i=>i,"TransferArrayBuffer"),rt(n)),"TransferArrayBuffer"),bt=u(n=>(typeof n.detached=="boolean"?bt=u(i=>i.detached,"IsDetachedBuffer"):bt=u(i=>i.byteLength===0,"IsDetachedBuffer"),bt(n)),"IsDetachedBuffer");function di(n,i,l){if(n.slice)return n.slice(i,l);let d=l-i,b=new ArrayBuffer(d);return hi(b,0,n,i,d),b}u(di,"ArrayBufferSlice");function jr(n,i){let l=n[i];if(l!=null){if(typeof l!="function")throw new TypeError(`${String(i)} is not a function`);return l}}u(jr,"GetMethod");function Ds(n){let i={[Symbol.iterator]:()=>n.iterator},l=async function*(){return yield*i}(),d=l.next;return{iterator:l,nextMethod:d,done:!1}}u(Ds,"CreateAsyncFromSyncIterator");let mi=(fi=(ci=Symbol.asyncIterator)!==null&&ci!==void 0?ci:(ui=Symbol.for)===null||ui===void 0?void 0:ui.call(Symbol,"Symbol.asyncIterator"))!==null&&fi!==void 0?fi:"@@asyncIterator";function pi(n,i="sync",l){if(l===void 0)if(i==="async"){if(l=jr(n,mi),l===void 0){let v=jr(n,Symbol.iterator),_=pi(n,"sync",v);return Ds(_)}}else l=jr(n,Symbol.iterator);if(l===void 0)throw new TypeError("The object is not iterable");let d=x(l,n,[]);if(!a(d))throw new TypeError("The iterator method must return an object");let b=d.next;return{iterator:d,nextMethod:b,done:!1}}u(pi,"GetIterator");function Ns(n){let i=x(n.nextMethod,n.iterator,[]);if(!a(i))throw new TypeError("The iterator.next() method must return an object");return i}u(Ns,"IteratorNext");function Ms(n){return!!n.done}u(Ms,"IteratorComplete");function Ws(n){return n.value}u(Ws,"IteratorValue");function zs(n){return!(typeof n!="number"||$s(n)||n<0)}u(zs,"IsNonNegativeNumber");function gi(n){let i=di(n.buffer,n.byteOffset,n.byteOffset+n.byteLength);return new Uint8Array(i)}u(gi,"CloneAsUint8Array");function Bn(n){let i=n._queue.shift();return n._queueTotalSize-=i.size,n._queueTotalSize<0&&(n._queueTotalSize=0),i.value}u(Bn,"DequeueValue");function qn(n,i,l){if(!zs(l)||l===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");n._queue.push({value:i,size:l}),n._queueTotalSize+=l}u(qn,"EnqueueValueWithSize");function Us(n){return n._queue.peek().value}u(Us,"PeekQueueValue");function nt(n){n._queue=new G,n._queueTotalSize=0}u(nt,"ResetQueue");function bi(n){return n===DataView}u(bi,"isDataViewConstructor");function Hs(n){return bi(n.constructor)}u(Hs,"isDataView");function Gs(n){return bi(n)?1:n.BYTES_PER_ELEMENT}u(Gs,"arrayBufferViewElementSize");let Vs=class{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Ln(this))throw Dn("view");return this._view}respond(i){if(!Ln(this))throw Dn("respond");if(He(i,1,"respond"),i=xn(i,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(bt(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");Nr(this._associatedReadableByteStreamController,i)}respondWithNewView(i){if(!Ln(this))throw Dn("respondWithNewView");if(He(i,1,"respondWithNewView"),!ArrayBuffer.isView(i))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(bt(i.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");Mr(this._associatedReadableByteStreamController,i)}};u(Vs,"ReadableStreamBYOBRequest");let Nt=Vs;Object.defineProperties(Nt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),c(Nt.prototype.respond,"respond"),c(Nt.prototype.respondWithNewView,"respondWithNewView"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Nt.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});let Qs=class{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!yt(this))throw sr("byobRequest");return $n(this)}get desiredSize(){if(!yt(this))throw sr("desiredSize");return Ai(this)}close(){if(!yt(this))throw sr("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be closed`);ar(this)}enqueue(i){if(!yt(this))throw sr("enqueue");if(He(i,1,"enqueue"),!ArrayBuffer.isView(i))throw new TypeError("chunk must be an array buffer view");if(i.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(i.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let l=this._controlledReadableByteStream._state;if(l!=="readable")throw new TypeError(`The stream (in ${l} state) is not in the readable state and cannot be enqueued to`);Dr(this,i)}error(i=void 0){if(!yt(this))throw sr("error");Ae(this,i)}[fe](i){yi(this),nt(this);let l=this._cancelAlgorithm(i);return $r(this),l}[ne](i){let l=this._controlledReadableByteStream;if(this._queueTotalSize>0){Ti(this,i);return}let d=this._autoAllocateChunkSize;if(d!==void 0){let b;try{b=new ArrayBuffer(d)}catch(_){i._errorSteps(_);return}let v={buffer:b,bufferByteLength:d,byteOffset:0,byteLength:d,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(v)}oi(l,i),wt(this)}[et](){if(this._pendingPullIntos.length>0){let i=this._pendingPullIntos.peek();i.readerType="none",this._pendingPullIntos=new G,this._pendingPullIntos.push(i)}}};u(Qs,"ReadableByteStreamController");let ot=Qs;Object.defineProperties(ot.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),c(ot.prototype.close,"close"),c(ot.prototype.enqueue,"enqueue"),c(ot.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ot.prototype,Symbol.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function yt(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledReadableByteStream")?!1:n instanceof ot}u(yt,"IsReadableByteStreamController");function Ln(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_associatedReadableByteStreamController")?!1:n instanceof Nt}u(Ln,"IsReadableStreamBYOBRequest");function wt(n){if(!Zs(n))return;if(n._pulling){n._pullAgain=!0;return}n._pulling=!0;let i=n._pullAlgorithm();R(i,()=>(n._pulling=!1,n._pullAgain&&(n._pullAgain=!1,wt(n)),null),l=>(Ae(n,l),null))}u(wt,"ReadableByteStreamControllerCallPullIfNeeded");function yi(n){jn(n),n._pendingPullIntos=new G}u(yi,"ReadableByteStreamControllerClearPendingPullIntos");function On(n,i){let l=!1;n._state==="closed"&&(l=!0);let d=wi(i);i.readerType==="default"?kn(n,d,l):il(n,d,l)}u(On,"ReadableByteStreamControllerCommitPullIntoDescriptor");function wi(n){let i=n.bytesFilled,l=n.elementSize;return new n.viewConstructor(n.buffer,n.byteOffset,i/l)}u(wi,"ReadableByteStreamControllerConvertPullIntoDescriptor");function Fr(n,i,l,d){n._queue.push({buffer:i,byteOffset:l,byteLength:d}),n._queueTotalSize+=d}u(Fr,"ReadableByteStreamControllerEnqueueChunkToQueue");function vi(n,i,l,d){let b;try{b=di(i,l,l+d)}catch(v){throw Ae(n,v),v}Fr(n,b,0,d)}u(vi,"ReadableByteStreamControllerEnqueueClonedChunkToQueue");function Ei(n,i){i.bytesFilled>0&&vi(n,i.buffer,i.byteOffset,i.bytesFilled),Mt(n)}u(Ei,"ReadableByteStreamControllerEnqueueDetachedPullIntoToQueue");function Si(n,i){let l=Math.min(n._queueTotalSize,i.byteLength-i.bytesFilled),d=i.bytesFilled+l,b=l,v=!1,_=d%i.elementSize,T=d-_;T>=i.minimumFill&&(b=T-i.bytesFilled,v=!0);let L=n._queue;for(;b>0;){let F=L.peek(),z=Math.min(b,F.byteLength),U=i.byteOffset+i.bytesFilled;hi(i.buffer,U,F.buffer,F.byteOffset,z),F.byteLength===z?L.shift():(F.byteOffset+=z,F.byteLength-=z),n._queueTotalSize-=z,_i(n,z,i),b-=z}return v}u(Si,"ReadableByteStreamControllerFillPullIntoDescriptorFromQueue");function _i(n,i,l){l.bytesFilled+=i}u(_i,"ReadableByteStreamControllerFillHeadPullIntoDescriptor");function Ri(n){n._queueTotalSize===0&&n._closeRequested?($r(n),mr(n._controlledReadableByteStream)):wt(n)}u(Ri,"ReadableByteStreamControllerHandleQueueDrain");function jn(n){n._byobRequest!==null&&(n._byobRequest._associatedReadableByteStreamController=void 0,n._byobRequest._view=null,n._byobRequest=null)}u(jn,"ReadableByteStreamControllerInvalidateBYOBRequest");function Fn(n){for(;n._pendingPullIntos.length>0;){if(n._queueTotalSize===0)return;let i=n._pendingPullIntos.peek();Si(n,i)&&(Mt(n),On(n._controlledReadableByteStream,i))}}u(Fn,"ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue");function Ys(n){let i=n._controlledReadableByteStream._reader;for(;i._readRequests.length>0;){if(n._queueTotalSize===0)return;let l=i._readRequests.shift();Ti(n,l)}}u(Ys,"ReadableByteStreamControllerProcessReadRequestsUsingQueue");function Xs(n,i,l,d){let b=n._controlledReadableByteStream,v=i.constructor,_=Gs(v),{byteOffset:T,byteLength:L}=i,F=l*_,z;try{z=rt(i.buffer)}catch(K){d._errorSteps(K);return}let U={buffer:z,bufferByteLength:z.byteLength,byteOffset:T,byteLength:L,bytesFilled:0,minimumFill:F,elementSize:_,viewConstructor:v,readerType:"byob"};if(n._pendingPullIntos.length>0){n._pendingPullIntos.push(U),Ii(b,d);return}if(b._state==="closed"){let K=new v(U.buffer,U.byteOffset,0);d._closeSteps(K);return}if(n._queueTotalSize>0){if(Si(n,U)){let K=wi(U);Ri(n),d._chunkSteps(K);return}if(n._closeRequested){let K=new TypeError("Insufficient bytes to fill elements in the given buffer");Ae(n,K),d._errorSteps(K);return}}n._pendingPullIntos.push(U),Ii(b,d),wt(n)}u(Xs,"ReadableByteStreamControllerPullInto");function Js(n,i){i.readerType==="none"&&Mt(n);let l=n._controlledReadableByteStream;if(Nn(l))for(;ki(l)>0;){let d=Mt(n);On(l,d)}}u(Js,"ReadableByteStreamControllerRespondInClosedState");function Ks(n,i,l){if(_i(n,i,l),l.readerType==="none"){Ei(n,l),Fn(n);return}if(l.bytesFilled<l.minimumFill)return;Mt(n);let d=l.bytesFilled%l.elementSize;if(d>0){let b=l.byteOffset+l.bytesFilled;vi(n,l.buffer,b-d,d)}l.bytesFilled-=d,On(n._controlledReadableByteStream,l),Fn(n)}u(Ks,"ReadableByteStreamControllerRespondInReadableState");function Pi(n,i){let l=n._pendingPullIntos.peek();jn(n),n._controlledReadableByteStream._state==="closed"?Js(n,l):Ks(n,i,l),wt(n)}u(Pi,"ReadableByteStreamControllerRespondInternal");function Mt(n){return n._pendingPullIntos.shift()}u(Mt,"ReadableByteStreamControllerShiftPendingPullInto");function Zs(n){let i=n._controlledReadableByteStream;return i._state!=="readable"||n._closeRequested||!n._started?!1:!!(ii(i)&&Lr(i)>0||Nn(i)&&ki(i)>0||Ai(n)>0)}u(Zs,"ReadableByteStreamControllerShouldCallPull");function $r(n){n._pullAlgorithm=void 0,n._cancelAlgorithm=void 0}u($r,"ReadableByteStreamControllerClearAlgorithms");function ar(n){let i=n._controlledReadableByteStream;if(!(n._closeRequested||i._state!=="readable")){if(n._queueTotalSize>0){n._closeRequested=!0;return}if(n._pendingPullIntos.length>0){let l=n._pendingPullIntos.peek();if(l.bytesFilled%l.elementSize!==0){let d=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Ae(n,d),d}}$r(n),mr(i)}}u(ar,"ReadableByteStreamControllerClose");function Dr(n,i){let l=n._controlledReadableByteStream;if(n._closeRequested||l._state!=="readable")return;let{buffer:d,byteOffset:b,byteLength:v}=i;if(bt(d))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");let _=rt(d);if(n._pendingPullIntos.length>0){let T=n._pendingPullIntos.peek();if(bt(T.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");jn(n),T.buffer=rt(T.buffer),T.readerType==="none"&&Ei(n,T)}if(ii(l))if(Ys(n),Lr(l)===0)Fr(n,_,b,v);else{n._pendingPullIntos.length>0&&Mt(n);let T=new Uint8Array(_,b,v);kn(l,T,!1)}else Nn(l)?(Fr(n,_,b,v),Fn(n)):Fr(n,_,b,v);wt(n)}u(Dr,"ReadableByteStreamControllerEnqueue");function Ae(n,i){let l=n._controlledReadableByteStream;l._state==="readable"&&(yi(n),nt(n),$r(n),ea(l,i))}u(Ae,"ReadableByteStreamControllerError");function Ti(n,i){let l=n._queue.shift();n._queueTotalSize-=l.byteLength,Ri(n);let d=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);i._chunkSteps(d)}u(Ti,"ReadableByteStreamControllerFillReadRequestFromQueue");function $n(n){if(n._byobRequest===null&&n._pendingPullIntos.length>0){let i=n._pendingPullIntos.peek(),l=new Uint8Array(i.buffer,i.byteOffset+i.bytesFilled,i.byteLength-i.bytesFilled),d=Object.create(Nt.prototype);tl(d,n,l),n._byobRequest=d}return n._byobRequest}u($n,"ReadableByteStreamControllerGetBYOBRequest");function Ai(n){let i=n._controlledReadableByteStream._state;return i==="errored"?null:i==="closed"?0:n._strategyHWM-n._queueTotalSize}u(Ai,"ReadableByteStreamControllerGetDesiredSize");function Nr(n,i){let l=n._pendingPullIntos.peek();if(n._controlledReadableByteStream._state==="closed"){if(i!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(i===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(l.bytesFilled+i>l.byteLength)throw new RangeError("bytesWritten out of range")}l.buffer=rt(l.buffer),Pi(n,i)}u(Nr,"ReadableByteStreamControllerRespond");function Mr(n,i){let l=n._pendingPullIntos.peek();if(n._controlledReadableByteStream._state==="closed"){if(i.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(i.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(l.byteOffset+l.bytesFilled!==i.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(l.bufferByteLength!==i.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(l.bytesFilled+i.byteLength>l.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let d=i.byteLength;l.buffer=rt(i.buffer),Pi(n,d)}u(Mr,"ReadableByteStreamControllerRespondWithNewView");function Ci(n,i,l,d,b,v,_){i._controlledReadableByteStream=n,i._pullAgain=!1,i._pulling=!1,i._byobRequest=null,i._queue=i._queueTotalSize=void 0,nt(i),i._closeRequested=!1,i._started=!1,i._strategyHWM=v,i._pullAlgorithm=d,i._cancelAlgorithm=b,i._autoAllocateChunkSize=_,i._pendingPullIntos=new G,n._readableStreamController=i;let T=l();R(y(T),()=>(i._started=!0,wt(i),null),L=>(Ae(i,L),null))}u(Ci,"SetUpReadableByteStreamController");function el(n,i,l){let d=Object.create(ot.prototype),b,v,_;i.start!==void 0?b=u(()=>i.start(d),"startAlgorithm"):b=u(()=>{},"startAlgorithm"),i.pull!==void 0?v=u(()=>i.pull(d),"pullAlgorithm"):v=u(()=>y(void 0),"pullAlgorithm"),i.cancel!==void 0?_=u(L=>i.cancel(L),"cancelAlgorithm"):_=u(()=>y(void 0),"cancelAlgorithm");let T=i.autoAllocateChunkSize;if(T===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Ci(n,d,b,v,_,l,T)}u(el,"SetUpReadableByteStreamControllerFromUnderlyingSource");function tl(n,i,l){n._associatedReadableByteStreamController=i,n._view=l}u(tl,"SetUpReadableStreamBYOBRequest");function Dn(n){return new TypeError(`ReadableStreamBYOBRequest.prototype.${n} can only be used on a ReadableStreamBYOBRequest`)}u(Dn,"byobRequestBrandCheckException");function sr(n){return new TypeError(`ReadableByteStreamController.prototype.${n} can only be used on a ReadableByteStreamController`)}u(sr,"byteStreamControllerBrandCheckException");function rl(n,i){Fe(n,i);let l=n?.mode;return{mode:l===void 0?void 0:nl(l,`${i} has member 'mode' that`)}}u(rl,"convertReaderOptions");function nl(n,i){if(n=`${n}`,n!=="byob")throw new TypeError(`${i} '${n}' is not a valid enumeration value for ReadableStreamReaderMode`);return n}u(nl,"convertReadableStreamReaderMode");function ol(n,i){var l;Fe(n,i);let d=(l=n?.min)!==null&&l!==void 0?l:1;return{min:xn(d,`${i} has member 'min' that`)}}u(ol,"convertByobReadOptions");function xi(n){return new vt(n)}u(xi,"AcquireReadableStreamBYOBReader");function Ii(n,i){n._reader._readIntoRequests.push(i)}u(Ii,"ReadableStreamAddReadIntoRequest");function il(n,i,l){let d=n._reader._readIntoRequests.shift();l?d._closeSteps(i):d._chunkSteps(i)}u(il,"ReadableStreamFulfillReadIntoRequest");function ki(n){return n._reader._readIntoRequests.length}u(ki,"ReadableStreamGetNumReadIntoRequests");function Nn(n){let i=n._reader;return!(i===void 0||!Et(i))}u(Nn,"ReadableStreamHasBYOBReader");let al=class{constructor(i){if(He(i,1,"ReadableStreamBYOBReader"),In(i,"First parameter"),lt(i))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!yt(i._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");je(this,i),this._readIntoRequests=new G}get closed(){return Et(this)?this._closedPromise:E(Wr("closed"))}cancel(i=void 0){return Et(this)?this._ownerReadableStream===void 0?E(ke("cancel")):ae(this,i):E(Wr("cancel"))}read(i,l={}){if(!Et(this))return E(Wr("read"));if(!ArrayBuffer.isView(i))return E(new TypeError("view must be an array buffer view"));if(i.byteLength===0)return E(new TypeError("view must have non-zero byteLength"));if(i.buffer.byteLength===0)return E(new TypeError("view's buffer must have non-zero byteLength"));if(bt(i.buffer))return E(new TypeError("view's buffer has been detached"));let d;try{d=ol(l,"options")}catch(L){return E(L)}let b=d.min;if(b===0)return E(new TypeError("options.min must be greater than 0"));if(Hs(i)){if(b>i.byteLength)return E(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(b>i.length)return E(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return E(ke("read from"));let v,_,T=p((L,F)=>{v=L,_=F});return Bi(this,i,b,{_chunkSteps:L=>v({value:L,done:!1}),_closeSteps:L=>v({value:L,done:!0}),_errorSteps:L=>_(L)}),T}releaseLock(){if(!Et(this))throw Wr("releaseLock");this._ownerReadableStream!==void 0&&sl(this)}};u(al,"ReadableStreamBYOBReader");let vt=al;Object.defineProperties(vt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),c(vt.prototype.cancel,"cancel"),c(vt.prototype.read,"read"),c(vt.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(vt.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Et(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_readIntoRequests")?!1:n instanceof vt}u(Et,"IsReadableStreamBYOBReader");function Bi(n,i,l,d){let b=n._ownerReadableStream;b._disturbed=!0,b._state==="errored"?d._errorSteps(b._storedError):Xs(b._readableStreamController,i,l,d)}u(Bi,"ReadableStreamBYOBReaderRead");function sl(n){ve(n);let i=new TypeError("Reader was released");qi(n,i)}u(sl,"ReadableStreamBYOBReaderRelease");function qi(n,i){let l=n._readIntoRequests;n._readIntoRequests=new G,l.forEach(d=>{d._errorSteps(i)})}u(qi,"ReadableStreamBYOBReaderErrorReadIntoRequests");function Wr(n){return new TypeError(`ReadableStreamBYOBReader.prototype.${n} can only be used on a ReadableStreamBYOBReader`)}u(Wr,"byobReaderBrandCheckException");function lr(n,i){let{highWaterMark:l}=n;if(l===void 0)return i;if($s(l)||l<0)throw new RangeError("Invalid highWaterMark");return l}u(lr,"ExtractHighWaterMark");function zr(n){let{size:i}=n;return i||(()=>1)}u(zr,"ExtractSizeAlgorithm");function Ur(n,i){Fe(n,i);let l=n?.highWaterMark,d=n?.size;return{highWaterMark:l===void 0?void 0:Cn(l),size:d===void 0?void 0:ll(d,`${i} has member 'size' that`)}}u(Ur,"convertQueuingStrategy");function ll(n,i){return Te(n,i),l=>Cn(n(l))}u(ll,"convertQueuingStrategySize");function cl(n,i){Fe(n,i);let l=n?.abort,d=n?.close,b=n?.start,v=n?.type,_=n?.write;return{abort:l===void 0?void 0:ul(l,n,`${i} has member 'abort' that`),close:d===void 0?void 0:fl(d,n,`${i} has member 'close' that`),start:b===void 0?void 0:hl(b,n,`${i} has member 'start' that`),write:_===void 0?void 0:dl(_,n,`${i} has member 'write' that`),type:v}}u(cl,"convertUnderlyingSink");function ul(n,i,l){return Te(n,l),d=>$(n,i,[d])}u(ul,"convertUnderlyingSinkAbortCallback");function fl(n,i,l){return Te(n,l),()=>$(n,i,[])}u(fl,"convertUnderlyingSinkCloseCallback");function hl(n,i,l){return Te(n,l),d=>x(n,i,[d])}u(hl,"convertUnderlyingSinkStartCallback");function dl(n,i,l){return Te(n,l),(d,b)=>$(n,i,[d,b])}u(dl,"convertUnderlyingSinkWriteCallback");function Li(n,i){if(!Wt(n))throw new TypeError(`${i} is not a WritableStream.`)}u(Li,"assertWritableStream");function ml(n){if(typeof n!="object"||n===null)return!1;try{return typeof n.aborted=="boolean"}catch{return!1}}u(ml,"isAbortSignal");let Wd=typeof AbortController=="function";function pl(){if(Wd)return new AbortController}u(pl,"createAbortController");let gl=class{constructor(i={},l={}){i===void 0?i=null:ri(i,"First parameter");let d=Ur(l,"Second parameter"),b=cl(i,"First parameter");if(ji(this),b.type!==void 0)throw new RangeError("Invalid type is specified");let v=zr(d),_=lr(d,1);ql(this,b,_,v)}get locked(){if(!Wt(this))throw Yr("locked");return zt(this)}abort(i=void 0){return Wt(this)?zt(this)?E(new TypeError("Cannot abort a stream that already has a writer")):Hr(this,i):E(Yr("abort"))}close(){return Wt(this)?zt(this)?E(new TypeError("Cannot close a stream that already has a writer")):$e(this)?E(new TypeError("Cannot close an already-closing stream")):Fi(this):E(Yr("close"))}getWriter(){if(!Wt(this))throw Yr("getWriter");return Oi(this)}};u(gl,"WritableStream");let St=gl;Object.defineProperties(St.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),c(St.prototype.abort,"abort"),c(St.prototype.close,"close"),c(St.prototype.getWriter,"getWriter"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(St.prototype,Symbol.toStringTag,{value:"WritableStream",configurable:!0});function Oi(n){return new it(n)}u(Oi,"AcquireWritableStreamDefaultWriter");function bl(n,i,l,d,b=1,v=()=>1){let _=Object.create(St.prototype);ji(_);let T=Object.create(cr.prototype);return Wi(_,T,n,i,l,d,b,v),_}u(bl,"CreateWritableStream");function ji(n){n._state="writable",n._storedError=void 0,n._writer=void 0,n._writableStreamController=void 0,n._writeRequests=new G,n._inFlightWriteRequest=void 0,n._closeRequest=void 0,n._inFlightCloseRequest=void 0,n._pendingAbortRequest=void 0,n._backpressure=!1}u(ji,"InitializeWritableStream");function Wt(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_writableStreamController")?!1:n instanceof St}u(Wt,"IsWritableStream");function zt(n){return n._writer!==void 0}u(zt,"IsWritableStreamLocked");function Hr(n,i){var l;if(n._state==="closed"||n._state==="errored")return y(void 0);n._writableStreamController._abortReason=i,(l=n._writableStreamController._abortController)===null||l===void 0||l.abort(i);let d=n._state;if(d==="closed"||d==="errored")return y(void 0);if(n._pendingAbortRequest!==void 0)return n._pendingAbortRequest._promise;let b=!1;d==="erroring"&&(b=!0,i=void 0);let v=p((_,T)=>{n._pendingAbortRequest={_promise:void 0,_resolve:_,_reject:T,_reason:i,_wasAlreadyErroring:b}});return n._pendingAbortRequest._promise=v,b||Wn(n,i),v}u(Hr,"WritableStreamAbort");function Fi(n){let i=n._state;if(i==="closed"||i==="errored")return E(new TypeError(`The stream (in ${i} state) is not in the writable state and cannot be closed`));let l=p((b,v)=>{let _={_resolve:b,_reject:v};n._closeRequest=_}),d=n._writer;return d!==void 0&&n._backpressure&&i==="writable"&&Xn(d),Ll(n._writableStreamController),l}u(Fi,"WritableStreamClose");function yl(n){return p((i,l)=>{let d={_resolve:i,_reject:l};n._writeRequests.push(d)})}u(yl,"WritableStreamAddWriteRequest");function Mn(n,i){if(n._state==="writable"){Wn(n,i);return}zn(n)}u(Mn,"WritableStreamDealWithRejection");function Wn(n,i){let l=n._writableStreamController;n._state="erroring",n._storedError=i;let d=n._writer;d!==void 0&&Di(d,i),!_l(n)&&l._started&&zn(n)}u(Wn,"WritableStreamStartErroring");function zn(n){n._state="errored",n._writableStreamController[we]();let i=n._storedError;if(n._writeRequests.forEach(b=>{b._reject(i)}),n._writeRequests=new G,n._pendingAbortRequest===void 0){Gr(n);return}let l=n._pendingAbortRequest;if(n._pendingAbortRequest=void 0,l._wasAlreadyErroring){l._reject(i),Gr(n);return}let d=n._writableStreamController[Y](l._reason);R(d,()=>(l._resolve(),Gr(n),null),b=>(l._reject(b),Gr(n),null))}u(zn,"WritableStreamFinishErroring");function wl(n){n._inFlightWriteRequest._resolve(void 0),n._inFlightWriteRequest=void 0}u(wl,"WritableStreamFinishInFlightWrite");function vl(n,i){n._inFlightWriteRequest._reject(i),n._inFlightWriteRequest=void 0,Mn(n,i)}u(vl,"WritableStreamFinishInFlightWriteWithError");function El(n){n._inFlightCloseRequest._resolve(void 0),n._inFlightCloseRequest=void 0,n._state==="erroring"&&(n._storedError=void 0,n._pendingAbortRequest!==void 0&&(n._pendingAbortRequest._resolve(),n._pendingAbortRequest=void 0)),n._state="closed";let i=n._writer;i!==void 0&&Gi(i)}u(El,"WritableStreamFinishInFlightClose");function Sl(n,i){n._inFlightCloseRequest._reject(i),n._inFlightCloseRequest=void 0,n._pendingAbortRequest!==void 0&&(n._pendingAbortRequest._reject(i),n._pendingAbortRequest=void 0),Mn(n,i)}u(Sl,"WritableStreamFinishInFlightCloseWithError");function $e(n){return!(n._closeRequest===void 0&&n._inFlightCloseRequest===void 0)}u($e,"WritableStreamCloseQueuedOrInFlight");function _l(n){return!(n._inFlightWriteRequest===void 0&&n._inFlightCloseRequest===void 0)}u(_l,"WritableStreamHasOperationMarkedInFlight");function Rl(n){n._inFlightCloseRequest=n._closeRequest,n._closeRequest=void 0}u(Rl,"WritableStreamMarkCloseRequestInFlight");function Pl(n){n._inFlightWriteRequest=n._writeRequests.shift()}u(Pl,"WritableStreamMarkFirstWriteRequestInFlight");function Gr(n){n._closeRequest!==void 0&&(n._closeRequest._reject(n._storedError),n._closeRequest=void 0);let i=n._writer;i!==void 0&&Qn(i,n._storedError)}u(Gr,"WritableStreamRejectCloseAndClosedPromiseIfNeeded");function Un(n,i){let l=n._writer;l!==void 0&&i!==n._backpressure&&(i?Ml(l):Xn(l)),n._backpressure=i}u(Un,"WritableStreamUpdateBackpressure");let Tl=class{constructor(i){if(He(i,1,"WritableStreamDefaultWriter"),Li(i,"First parameter"),zt(i))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=i,i._writer=this;let l=i._state;if(l==="writable")!$e(i)&&i._backpressure?Jr(this):Vi(this),Xr(this);else if(l==="erroring")Yn(this,i._storedError),Xr(this);else if(l==="closed")Vi(this),Dl(this);else{let d=i._storedError;Yn(this,d),Hi(this,d)}}get closed(){return _t(this)?this._closedPromise:E(Rt("closed"))}get desiredSize(){if(!_t(this))throw Rt("desiredSize");if(this._ownerWritableStream===void 0)throw fr("desiredSize");return Il(this)}get ready(){return _t(this)?this._readyPromise:E(Rt("ready"))}abort(i=void 0){return _t(this)?this._ownerWritableStream===void 0?E(fr("abort")):Al(this,i):E(Rt("abort"))}close(){if(!_t(this))return E(Rt("close"));let i=this._ownerWritableStream;return i===void 0?E(fr("close")):$e(i)?E(new TypeError("Cannot close an already-closing stream")):$i(this)}releaseLock(){if(!_t(this))throw Rt("releaseLock");this._ownerWritableStream!==void 0&&Ni(this)}write(i=void 0){return _t(this)?this._ownerWritableStream===void 0?E(fr("write to")):Mi(this,i):E(Rt("write"))}};u(Tl,"WritableStreamDefaultWriter");let it=Tl;Object.defineProperties(it.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),c(it.prototype.abort,"abort"),c(it.prototype.close,"close"),c(it.prototype.releaseLock,"releaseLock"),c(it.prototype.write,"write"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(it.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function _t(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_ownerWritableStream")?!1:n instanceof it}u(_t,"IsWritableStreamDefaultWriter");function Al(n,i){let l=n._ownerWritableStream;return Hr(l,i)}u(Al,"WritableStreamDefaultWriterAbort");function $i(n){let i=n._ownerWritableStream;return Fi(i)}u($i,"WritableStreamDefaultWriterClose");function Cl(n){let i=n._ownerWritableStream,l=i._state;return $e(i)||l==="closed"?y(void 0):l==="errored"?E(i._storedError):$i(n)}u(Cl,"WritableStreamDefaultWriterCloseWithErrorPropagation");function xl(n,i){n._closedPromiseState==="pending"?Qn(n,i):Nl(n,i)}u(xl,"WritableStreamDefaultWriterEnsureClosedPromiseRejected");function Di(n,i){n._readyPromiseState==="pending"?Qi(n,i):Wl(n,i)}u(Di,"WritableStreamDefaultWriterEnsureReadyPromiseRejected");function Il(n){let i=n._ownerWritableStream,l=i._state;return l==="errored"||l==="erroring"?null:l==="closed"?0:zi(i._writableStreamController)}u(Il,"WritableStreamDefaultWriterGetDesiredSize");function Ni(n){let i=n._ownerWritableStream,l=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Di(n,l),xl(n,l),i._writer=void 0,n._ownerWritableStream=void 0}u(Ni,"WritableStreamDefaultWriterRelease");function Mi(n,i){let l=n._ownerWritableStream,d=l._writableStreamController,b=Ol(d,i);if(l!==n._ownerWritableStream)return E(fr("write to"));let v=l._state;if(v==="errored")return E(l._storedError);if($e(l)||v==="closed")return E(new TypeError("The stream is closing or closed and cannot be written to"));if(v==="erroring")return E(l._storedError);let _=yl(l);return jl(d,i,b),_}u(Mi,"WritableStreamDefaultWriterWrite");let kl={},Bl=class{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Hn(this))throw Vn("abortReason");return this._abortReason}get signal(){if(!Hn(this))throw Vn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(i=void 0){if(!Hn(this))throw Vn("error");this._controlledWritableStream._state==="writable"&&Ui(this,i)}[Y](i){let l=this._abortAlgorithm(i);return Vr(this),l}[we](){nt(this)}};u(Bl,"WritableStreamDefaultController");let cr=Bl;Object.defineProperties(cr.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(cr.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Hn(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledWritableStream")?!1:n instanceof cr}u(Hn,"IsWritableStreamDefaultController");function Wi(n,i,l,d,b,v,_,T){i._controlledWritableStream=n,n._writableStreamController=i,i._queue=void 0,i._queueTotalSize=void 0,nt(i),i._abortReason=void 0,i._abortController=pl(),i._started=!1,i._strategySizeAlgorithm=T,i._strategyHWM=_,i._writeAlgorithm=d,i._closeAlgorithm=b,i._abortAlgorithm=v;let L=Gn(i);Un(n,L);let F=l(),z=y(F);R(z,()=>(i._started=!0,Qr(i),null),U=>(i._started=!0,Mn(n,U),null))}u(Wi,"SetUpWritableStreamDefaultController");function ql(n,i,l,d){let b=Object.create(cr.prototype),v,_,T,L;i.start!==void 0?v=u(()=>i.start(b),"startAlgorithm"):v=u(()=>{},"startAlgorithm"),i.write!==void 0?_=u(F=>i.write(F,b),"writeAlgorithm"):_=u(()=>y(void 0),"writeAlgorithm"),i.close!==void 0?T=u(()=>i.close(),"closeAlgorithm"):T=u(()=>y(void 0),"closeAlgorithm"),i.abort!==void 0?L=u(F=>i.abort(F),"abortAlgorithm"):L=u(()=>y(void 0),"abortAlgorithm"),Wi(n,b,v,_,T,L,l,d)}u(ql,"SetUpWritableStreamDefaultControllerFromUnderlyingSink");function Vr(n){n._writeAlgorithm=void 0,n._closeAlgorithm=void 0,n._abortAlgorithm=void 0,n._strategySizeAlgorithm=void 0}u(Vr,"WritableStreamDefaultControllerClearAlgorithms");function Ll(n){qn(n,kl,0),Qr(n)}u(Ll,"WritableStreamDefaultControllerClose");function Ol(n,i){try{return n._strategySizeAlgorithm(i)}catch(l){return ur(n,l),1}}u(Ol,"WritableStreamDefaultControllerGetChunkSize");function zi(n){return n._strategyHWM-n._queueTotalSize}u(zi,"WritableStreamDefaultControllerGetDesiredSize");function jl(n,i,l){try{qn(n,i,l)}catch(b){ur(n,b);return}let d=n._controlledWritableStream;if(!$e(d)&&d._state==="writable"){let b=Gn(n);Un(d,b)}Qr(n)}u(jl,"WritableStreamDefaultControllerWrite");function Qr(n){let i=n._controlledWritableStream;if(!n._started||i._inFlightWriteRequest!==void 0)return;if(i._state==="erroring"){zn(i);return}if(n._queue.length===0)return;let l=Us(n);l===kl?Fl(n):$l(n,l)}u(Qr,"WritableStreamDefaultControllerAdvanceQueueIfNeeded");function ur(n,i){n._controlledWritableStream._state==="writable"&&Ui(n,i)}u(ur,"WritableStreamDefaultControllerErrorIfNeeded");function Fl(n){let i=n._controlledWritableStream;Rl(i),Bn(n);let l=n._closeAlgorithm();Vr(n),R(l,()=>(El(i),null),d=>(Sl(i,d),null))}u(Fl,"WritableStreamDefaultControllerProcessClose");function $l(n,i){let l=n._controlledWritableStream;Pl(l);let d=n._writeAlgorithm(i);R(d,()=>{wl(l);let b=l._state;if(Bn(n),!$e(l)&&b==="writable"){let v=Gn(n);Un(l,v)}return Qr(n),null},b=>(l._state==="writable"&&Vr(n),vl(l,b),null))}u($l,"WritableStreamDefaultControllerProcessWrite");function Gn(n){return zi(n)<=0}u(Gn,"WritableStreamDefaultControllerGetBackpressure");function Ui(n,i){let l=n._controlledWritableStream;Vr(n),Wn(l,i)}u(Ui,"WritableStreamDefaultControllerError");function Yr(n){return new TypeError(`WritableStream.prototype.${n} can only be used on a WritableStream`)}u(Yr,"streamBrandCheckException$2");function Vn(n){return new TypeError(`WritableStreamDefaultController.prototype.${n} can only be used on a WritableStreamDefaultController`)}u(Vn,"defaultControllerBrandCheckException$2");function Rt(n){return new TypeError(`WritableStreamDefaultWriter.prototype.${n} can only be used on a WritableStreamDefaultWriter`)}u(Rt,"defaultWriterBrandCheckException");function fr(n){return new TypeError("Cannot "+n+" a stream using a released writer")}u(fr,"defaultWriterLockException");function Xr(n){n._closedPromise=p((i,l)=>{n._closedPromise_resolve=i,n._closedPromise_reject=l,n._closedPromiseState="pending"})}u(Xr,"defaultWriterClosedPromiseInitialize");function Hi(n,i){Xr(n),Qn(n,i)}u(Hi,"defaultWriterClosedPromiseInitializeAsRejected");function Dl(n){Xr(n),Gi(n)}u(Dl,"defaultWriterClosedPromiseInitializeAsResolved");function Qn(n,i){n._closedPromise_reject!==void 0&&(V(n._closedPromise),n._closedPromise_reject(i),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0,n._closedPromiseState="rejected")}u(Qn,"defaultWriterClosedPromiseReject");function Nl(n,i){Hi(n,i)}u(Nl,"defaultWriterClosedPromiseResetToRejected");function Gi(n){n._closedPromise_resolve!==void 0&&(n._closedPromise_resolve(void 0),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0,n._closedPromiseState="resolved")}u(Gi,"defaultWriterClosedPromiseResolve");function Jr(n){n._readyPromise=p((i,l)=>{n._readyPromise_resolve=i,n._readyPromise_reject=l}),n._readyPromiseState="pending"}u(Jr,"defaultWriterReadyPromiseInitialize");function Yn(n,i){Jr(n),Qi(n,i)}u(Yn,"defaultWriterReadyPromiseInitializeAsRejected");function Vi(n){Jr(n),Xn(n)}u(Vi,"defaultWriterReadyPromiseInitializeAsResolved");function Qi(n,i){n._readyPromise_reject!==void 0&&(V(n._readyPromise),n._readyPromise_reject(i),n._readyPromise_resolve=void 0,n._readyPromise_reject=void 0,n._readyPromiseState="rejected")}u(Qi,"defaultWriterReadyPromiseReject");function Ml(n){Jr(n)}u(Ml,"defaultWriterReadyPromiseReset");function Wl(n,i){Yn(n,i)}u(Wl,"defaultWriterReadyPromiseResetToRejected");function Xn(n){n._readyPromise_resolve!==void 0&&(n._readyPromise_resolve(void 0),n._readyPromise_resolve=void 0,n._readyPromise_reject=void 0,n._readyPromiseState="fulfilled")}u(Xn,"defaultWriterReadyPromiseResolve");function zl(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof Io<"u")return Io}u(zl,"getGlobals");let zd=zl();function Ul(n){if(!(typeof n=="function"||typeof n=="object")||n.name!=="DOMException")return!1;try{return new n,!0}catch{return!1}}u(Ul,"isDOMExceptionConstructor");function Hl(){let n=zd?.DOMException;return Ul(n)?n:void 0}u(Hl,"getFromGlobal");function Gl(){let n=u(function(i,l){this.message=i||"",this.name=l||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)},"DOMException");return c(n,"DOMException"),n.prototype=Object.create(Error.prototype),Object.defineProperty(n.prototype,"constructor",{value:n,writable:!0,configurable:!0}),n}u(Gl,"createPolyfill");let Ud=Hl()||Gl();function Yi(n,i,l,d,b,v){let _=Dt(n),T=Oi(i);n._disturbed=!0;let L=!1,F=y(void 0);return p((z,U)=>{let K;if(v!==void 0){if(K=u(()=>{let j=v.reason!==void 0?v.reason:new Ud("Aborted","AbortError"),Q=[];d||Q.push(()=>i._state==="writable"?Hr(i,j):y(void 0)),b||Q.push(()=>n._state==="readable"?qe(n,j):y(void 0)),me(()=>Promise.all(Q.map(X=>X())),!0,j)},"abortAlgorithm"),v.aborted){K();return}v.addEventListener("abort",K)}function Ee(){return p((j,Q)=>{function X(pe){pe?j():I(ct(),X,Q)}u(X,"next"),X(!1)})}u(Ee,"pipeLoop");function ct(){return L?y(!0):I(T._readyPromise,()=>p((j,Q)=>{or(_,{_chunkSteps:X=>{F=I(Mi(T,X),void 0,o),j(!1)},_closeSteps:()=>j(!0),_errorSteps:Q})}))}if(u(ct,"pipeStep"),Le(n,_._closedPromise,j=>(d?Se(!0,j):me(()=>Hr(i,j),!0,j),null)),Le(i,T._closedPromise,j=>(b?Se(!0,j):me(()=>qe(n,j),!0,j),null)),se(n,_._closedPromise,()=>(l?Se():me(()=>Cl(T)),null)),$e(i)||i._state==="closed"){let j=new TypeError("the destination writable stream closed before all data could be piped to it");b?Se(!0,j):me(()=>qe(n,j),!0,j)}V(Ee());function De(){let j=F;return I(F,()=>j!==F?De():void 0)}u(De,"waitForWritesToFinish");function Le(j,Q,X){j._state==="errored"?X(j._storedError):O(Q,X)}u(Le,"isOrBecomesErrored");function se(j,Q,X){j._state==="closed"?X():B(Q,X)}u(se,"isOrBecomesClosed");function me(j,Q,X){if(L)return;L=!0,i._state==="writable"&&!$e(i)?B(De(),pe):pe();function pe(){return R(j(),()=>ut(Q,X),Ct=>ut(!0,Ct)),null}u(pe,"doTheRest")}u(me,"shutdownWithAction");function Se(j,Q){L||(L=!0,i._state==="writable"&&!$e(i)?B(De(),()=>ut(j,Q)):ut(j,Q))}u(Se,"shutdown");function ut(j,Q){return Ni(T),ve(_),v!==void 0&&v.removeEventListener("abort",K),j?U(Q):z(void 0),null}u(ut,"finalize")})}u(Yi,"ReadableStreamPipeTo");let Vl=class{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Kr(this))throw en("desiredSize");return Jn(this)}close(){if(!Kr(this))throw en("close");if(!Ht(this))throw new TypeError("The stream is not in a state that permits close");Pt(this)}enqueue(i=void 0){if(!Kr(this))throw en("enqueue");if(!Ht(this))throw new TypeError("The stream is not in a state that permits enqueue");return Ut(this,i)}error(i=void 0){if(!Kr(this))throw en("error");Be(this,i)}[fe](i){nt(this);let l=this._cancelAlgorithm(i);return Zr(this),l}[ne](i){let l=this._controlledReadableStream;if(this._queue.length>0){let d=Bn(this);this._closeRequested&&this._queue.length===0?(Zr(this),mr(l)):hr(this),i._chunkSteps(d)}else oi(l,i),hr(this)}[et](){}};u(Vl,"ReadableStreamDefaultController");let at=Vl;Object.defineProperties(at.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),c(at.prototype.close,"close"),c(at.prototype.enqueue,"enqueue"),c(at.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(at.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Kr(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledReadableStream")?!1:n instanceof at}u(Kr,"IsReadableStreamDefaultController");function hr(n){if(!Xi(n))return;if(n._pulling){n._pullAgain=!0;return}n._pulling=!0;let i=n._pullAlgorithm();R(i,()=>(n._pulling=!1,n._pullAgain&&(n._pullAgain=!1,hr(n)),null),l=>(Be(n,l),null))}u(hr,"ReadableStreamDefaultControllerCallPullIfNeeded");function Xi(n){let i=n._controlledReadableStream;return!Ht(n)||!n._started?!1:!!(lt(i)&&Lr(i)>0||Jn(n)>0)}u(Xi,"ReadableStreamDefaultControllerShouldCallPull");function Zr(n){n._pullAlgorithm=void 0,n._cancelAlgorithm=void 0,n._strategySizeAlgorithm=void 0}u(Zr,"ReadableStreamDefaultControllerClearAlgorithms");function Pt(n){if(!Ht(n))return;let i=n._controlledReadableStream;n._closeRequested=!0,n._queue.length===0&&(Zr(n),mr(i))}u(Pt,"ReadableStreamDefaultControllerClose");function Ut(n,i){if(!Ht(n))return;let l=n._controlledReadableStream;if(lt(l)&&Lr(l)>0)kn(l,i,!1);else{let d;try{d=n._strategySizeAlgorithm(i)}catch(b){throw Be(n,b),b}try{qn(n,i,d)}catch(b){throw Be(n,b),b}}hr(n)}u(Ut,"ReadableStreamDefaultControllerEnqueue");function Be(n,i){let l=n._controlledReadableStream;l._state==="readable"&&(nt(n),Zr(n),ea(l,i))}u(Be,"ReadableStreamDefaultControllerError");function Jn(n){let i=n._controlledReadableStream._state;return i==="errored"?null:i==="closed"?0:n._strategyHWM-n._queueTotalSize}u(Jn,"ReadableStreamDefaultControllerGetDesiredSize");function Ql(n){return!Xi(n)}u(Ql,"ReadableStreamDefaultControllerHasBackpressure");function Ht(n){let i=n._controlledReadableStream._state;return!n._closeRequested&&i==="readable"}u(Ht,"ReadableStreamDefaultControllerCanCloseOrEnqueue");function Ji(n,i,l,d,b,v,_){i._controlledReadableStream=n,i._queue=void 0,i._queueTotalSize=void 0,nt(i),i._started=!1,i._closeRequested=!1,i._pullAgain=!1,i._pulling=!1,i._strategySizeAlgorithm=_,i._strategyHWM=v,i._pullAlgorithm=d,i._cancelAlgorithm=b,n._readableStreamController=i;let T=l();R(y(T),()=>(i._started=!0,hr(i),null),L=>(Be(i,L),null))}u(Ji,"SetUpReadableStreamDefaultController");function Yl(n,i,l,d){let b=Object.create(at.prototype),v,_,T;i.start!==void 0?v=u(()=>i.start(b),"startAlgorithm"):v=u(()=>{},"startAlgorithm"),i.pull!==void 0?_=u(()=>i.pull(b),"pullAlgorithm"):_=u(()=>y(void 0),"pullAlgorithm"),i.cancel!==void 0?T=u(L=>i.cancel(L),"cancelAlgorithm"):T=u(()=>y(void 0),"cancelAlgorithm"),Ji(n,b,v,_,T,l,d)}u(Yl,"SetUpReadableStreamDefaultControllerFromUnderlyingSource");function en(n){return new TypeError(`ReadableStreamDefaultController.prototype.${n} can only be used on a ReadableStreamDefaultController`)}u(en,"defaultControllerBrandCheckException$1");function Xl(n,i){return yt(n._readableStreamController)?Kl(n):Jl(n)}u(Xl,"ReadableStreamTee");function Jl(n,i){let l=Dt(n),d=!1,b=!1,v=!1,_=!1,T,L,F,z,U,K=p(se=>{U=se});function Ee(){return d?(b=!0,y(void 0)):(d=!0,or(l,{_chunkSteps:se=>{H(()=>{b=!1;let me=se,Se=se;v||Ut(F._readableStreamController,me),_||Ut(z._readableStreamController,Se),d=!1,b&&Ee()})},_closeSteps:()=>{d=!1,v||Pt(F._readableStreamController),_||Pt(z._readableStreamController),(!v||!_)&&U(void 0)},_errorSteps:()=>{d=!1}}),y(void 0))}u(Ee,"pullAlgorithm");function ct(se){if(v=!0,T=se,_){let me=ir([T,L]),Se=qe(n,me);U(Se)}return K}u(ct,"cancel1Algorithm");function De(se){if(_=!0,L=se,v){let me=ir([T,L]),Se=qe(n,me);U(Se)}return K}u(De,"cancel2Algorithm");function Le(){}return u(Le,"startAlgorithm"),F=dr(Le,Ee,ct),z=dr(Le,Ee,De),O(l._closedPromise,se=>(Be(F._readableStreamController,se),Be(z._readableStreamController,se),(!v||!_)&&U(void 0),null)),[F,z]}u(Jl,"ReadableStreamDefaultTee");function Kl(n){let i=Dt(n),l=!1,d=!1,b=!1,v=!1,_=!1,T,L,F,z,U,K=p(j=>{U=j});function Ee(j){O(j._closedPromise,Q=>(j!==i||(Ae(F._readableStreamController,Q),Ae(z._readableStreamController,Q),(!v||!_)&&U(void 0)),null))}u(Ee,"forwardReaderError");function ct(){Et(i)&&(ve(i),i=Dt(n),Ee(i)),or(i,{_chunkSteps:j=>{H(()=>{d=!1,b=!1;let Q=j,X=j;if(!v&&!_)try{X=gi(j)}catch(pe){Ae(F._readableStreamController,pe),Ae(z._readableStreamController,pe),U(qe(n,pe));return}v||Dr(F._readableStreamController,Q),_||Dr(z._readableStreamController,X),l=!1,d?Le():b&&se()})},_closeSteps:()=>{l=!1,v||ar(F._readableStreamController),_||ar(z._readableStreamController),F._readableStreamController._pendingPullIntos.length>0&&Nr(F._readableStreamController,0),z._readableStreamController._pendingPullIntos.length>0&&Nr(z._readableStreamController,0),(!v||!_)&&U(void 0)},_errorSteps:()=>{l=!1}})}u(ct,"pullWithDefaultReader");function De(j,Q){tt(i)&&(ve(i),i=xi(n),Ee(i));let X=Q?z:F,pe=Q?F:z;Bi(i,j,1,{_chunkSteps:Ct=>{H(()=>{d=!1,b=!1;let pr=Q?_:v;if(Q?v:_)pr||Mr(X._readableStreamController,Ct);else{let gr;try{gr=gi(Ct)}catch(fa){Ae(X._readableStreamController,fa),Ae(pe._readableStreamController,fa),U(qe(n,fa));return}pr||Mr(X._readableStreamController,Ct),Dr(pe._readableStreamController,gr)}l=!1,d?Le():b&&se()})},_closeSteps:Ct=>{l=!1;let pr=Q?_:v,gr=Q?v:_;pr||ar(X._readableStreamController),gr||ar(pe._readableStreamController),Ct!==void 0&&(pr||Mr(X._readableStreamController,Ct),!gr&&pe._readableStreamController._pendingPullIntos.length>0&&Nr(pe._readableStreamController,0)),(!pr||!gr)&&U(void 0)},_errorSteps:()=>{l=!1}})}u(De,"pullWithBYOBReader");function Le(){if(l)return d=!0,y(void 0);l=!0;let j=$n(F._readableStreamController);return j===null?ct():De(j._view,!1),y(void 0)}u(Le,"pull1Algorithm");function se(){if(l)return b=!0,y(void 0);l=!0;let j=$n(z._readableStreamController);return j===null?ct():De(j._view,!0),y(void 0)}u(se,"pull2Algorithm");function me(j){if(v=!0,T=j,_){let Q=ir([T,L]),X=qe(n,Q);U(X)}return K}u(me,"cancel1Algorithm");function Se(j){if(_=!0,L=j,v){let Q=ir([T,L]),X=qe(n,Q);U(X)}return K}u(Se,"cancel2Algorithm");function ut(){}return u(ut,"startAlgorithm"),F=Zi(ut,Le,me),z=Zi(ut,se,Se),Ee(i),[F,z]}u(Kl,"ReadableByteStreamTee");function Zl(n){return a(n)&&typeof n.getReader<"u"}u(Zl,"isReadableStreamLike");function ec(n){return Zl(n)?rc(n.getReader()):tc(n)}u(ec,"ReadableStreamFrom");function tc(n){let i,l=pi(n,"async"),d=o;function b(){let _;try{_=Ns(l)}catch(L){return E(L)}let T=y(_);return P(T,L=>{if(!a(L))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(Ms(L))Pt(i._readableStreamController);else{let F=Ws(L);Ut(i._readableStreamController,F)}})}u(b,"pullAlgorithm");function v(_){let T=l.iterator,L;try{L=jr(T,"return")}catch(U){return E(U)}if(L===void 0)return y(void 0);let F;try{F=x(L,T,[_])}catch(U){return E(U)}let z=y(F);return P(z,U=>{if(!a(U))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return u(v,"cancelAlgorithm"),i=dr(d,b,v,0),i}u(tc,"ReadableStreamFromIterable");function rc(n){let i,l=o;function d(){let v;try{v=n.read()}catch(_){return E(_)}return P(v,_=>{if(!a(_))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(_.done)Pt(i._readableStreamController);else{let T=_.value;Ut(i._readableStreamController,T)}})}u(d,"pullAlgorithm");function b(v){try{return y(n.cancel(v))}catch(_){return E(_)}}return u(b,"cancelAlgorithm"),i=dr(l,d,b,0),i}u(rc,"ReadableStreamFromDefaultReader");function nc(n,i){Fe(n,i);let l=n,d=l?.autoAllocateChunkSize,b=l?.cancel,v=l?.pull,_=l?.start,T=l?.type;return{autoAllocateChunkSize:d===void 0?void 0:xn(d,`${i} has member 'autoAllocateChunkSize' that`),cancel:b===void 0?void 0:oc(b,l,`${i} has member 'cancel' that`),pull:v===void 0?void 0:ic(v,l,`${i} has member 'pull' that`),start:_===void 0?void 0:ac(_,l,`${i} has member 'start' that`),type:T===void 0?void 0:sc(T,`${i} has member 'type' that`)}}u(nc,"convertUnderlyingDefaultOrByteSource");function oc(n,i,l){return Te(n,l),d=>$(n,i,[d])}u(oc,"convertUnderlyingSourceCancelCallback");function ic(n,i,l){return Te(n,l),d=>$(n,i,[d])}u(ic,"convertUnderlyingSourcePullCallback");function ac(n,i,l){return Te(n,l),d=>x(n,i,[d])}u(ac,"convertUnderlyingSourceStartCallback");function sc(n,i){if(n=`${n}`,n!=="bytes")throw new TypeError(`${i} '${n}' is not a valid enumeration value for ReadableStreamType`);return n}u(sc,"convertReadableStreamType");function lc(n,i){return Fe(n,i),{preventCancel:!!n?.preventCancel}}u(lc,"convertIteratorOptions");function Ki(n,i){Fe(n,i);let l=n?.preventAbort,d=n?.preventCancel,b=n?.preventClose,v=n?.signal;return v!==void 0&&cc(v,`${i} has member 'signal' that`),{preventAbort:!!l,preventCancel:!!d,preventClose:!!b,signal:v}}u(Ki,"convertPipeOptions");function cc(n,i){if(!ml(n))throw new TypeError(`${i} is not an AbortSignal.`)}u(cc,"assertAbortSignal");function uc(n,i){Fe(n,i);let l=n?.readable;An(l,"readable","ReadableWritablePair"),In(l,`${i} has member 'readable' that`);let d=n?.writable;return An(d,"writable","ReadableWritablePair"),Li(d,`${i} has member 'writable' that`),{readable:l,writable:d}}u(uc,"convertReadableWritablePair");let fc=class{constructor(i={},l={}){i===void 0?i=null:ri(i,"First parameter");let d=Ur(l,"Second parameter"),b=nc(i,"First parameter");if(Kn(this),b.type==="bytes"){if(d.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let v=lr(d,0);el(this,b,v)}else{let v=zr(d),_=lr(d,1);Yl(this,b,_,v)}}get locked(){if(!st(this))throw Tt("locked");return lt(this)}cancel(i=void 0){return st(this)?lt(this)?E(new TypeError("Cannot cancel a stream that already has a reader")):qe(this,i):E(Tt("cancel"))}getReader(i=void 0){if(!st(this))throw Tt("getReader");return rl(i,"First parameter").mode===void 0?Dt(this):xi(this)}pipeThrough(i,l={}){if(!st(this))throw Tt("pipeThrough");He(i,1,"pipeThrough");let d=uc(i,"First parameter"),b=Ki(l,"Second parameter");if(lt(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(zt(d.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let v=Yi(this,d.writable,b.preventClose,b.preventAbort,b.preventCancel,b.signal);return V(v),d.readable}pipeTo(i,l={}){if(!st(this))return E(Tt("pipeTo"));if(i===void 0)return E("Parameter 1 is required in 'pipeTo'.");if(!Wt(i))return E(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let d;try{d=Ki(l,"Second parameter")}catch(b){return E(b)}return lt(this)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):zt(i)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Yi(this,i,d.preventClose,d.preventAbort,d.preventCancel,d.signal)}tee(){if(!st(this))throw Tt("tee");let i=Xl(this);return ir(i)}values(i=void 0){if(!st(this))throw Tt("values");let l=lc(i,"First parameter");return Fs(this,l.preventCancel)}[mi](i){return this.values(i)}static from(i){return ec(i)}};u(fc,"ReadableStream");let he=fc;Object.defineProperties(he,{from:{enumerable:!0}}),Object.defineProperties(he.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),c(he.from,"from"),c(he.prototype.cancel,"cancel"),c(he.prototype.getReader,"getReader"),c(he.prototype.pipeThrough,"pipeThrough"),c(he.prototype.pipeTo,"pipeTo"),c(he.prototype.tee,"tee"),c(he.prototype.values,"values"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(he.prototype,Symbol.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(he.prototype,mi,{value:he.prototype.values,writable:!0,configurable:!0});function dr(n,i,l,d=1,b=()=>1){let v=Object.create(he.prototype);Kn(v);let _=Object.create(at.prototype);return Ji(v,_,n,i,l,d,b),v}u(dr,"CreateReadableStream");function Zi(n,i,l){let d=Object.create(he.prototype);Kn(d);let b=Object.create(ot.prototype);return Ci(d,b,n,i,l,0,void 0),d}u(Zi,"CreateReadableByteStream");function Kn(n){n._state="readable",n._reader=void 0,n._storedError=void 0,n._disturbed=!1}u(Kn,"InitializeReadableStream");function st(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_readableStreamController")?!1:n instanceof he}u(st,"IsReadableStream");function lt(n){return n._reader!==void 0}u(lt,"IsReadableStreamLocked");function qe(n,i){if(n._disturbed=!0,n._state==="closed")return y(void 0);if(n._state==="errored")return E(n._storedError);mr(n);let l=n._reader;if(l!==void 0&&Et(l)){let b=l._readIntoRequests;l._readIntoRequests=new G,b.forEach(v=>{v._closeSteps(void 0)})}let d=n._readableStreamController[fe](i);return P(d,o)}u(qe,"ReadableStreamCancel");function mr(n){n._state="closed";let i=n._reader;if(i!==void 0&&(ti(i),tt(i))){let l=i._readRequests;i._readRequests=new G,l.forEach(d=>{d._closeSteps()})}}u(mr,"ReadableStreamClose");function ea(n,i){n._state="errored",n._storedError=i;let l=n._reader;l!==void 0&&(Tn(l,i),tt(l)?ai(l,i):qi(l,i))}u(ea,"ReadableStreamError");function Tt(n){return new TypeError(`ReadableStream.prototype.${n} can only be used on a ReadableStream`)}u(Tt,"streamBrandCheckException$1");function ta(n,i){Fe(n,i);let l=n?.highWaterMark;return An(l,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Cn(l)}}u(ta,"convertQueuingStrategyInit");let hc=u(n=>n.byteLength,"byteLengthSizeFunction");c(hc,"size");let dc=class{constructor(i){He(i,1,"ByteLengthQueuingStrategy"),i=ta(i,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=i.highWaterMark}get highWaterMark(){if(!na(this))throw ra("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!na(this))throw ra("size");return hc}};u(dc,"ByteLengthQueuingStrategy");let Zn=dc;Object.defineProperties(Zn.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Zn.prototype,Symbol.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function ra(n){return new TypeError(`ByteLengthQueuingStrategy.prototype.${n} can only be used on a ByteLengthQueuingStrategy`)}u(ra,"byteLengthBrandCheckException");function na(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_byteLengthQueuingStrategyHighWaterMark")?!1:n instanceof Zn}u(na,"IsByteLengthQueuingStrategy");let mc=u(()=>1,"countSizeFunction");c(mc,"size");let pc=class{constructor(i){He(i,1,"CountQueuingStrategy"),i=ta(i,"First parameter"),this._countQueuingStrategyHighWaterMark=i.highWaterMark}get highWaterMark(){if(!ia(this))throw oa("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!ia(this))throw oa("size");return mc}};u(pc,"CountQueuingStrategy");let eo=pc;Object.defineProperties(eo.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(eo.prototype,Symbol.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function oa(n){return new TypeError(`CountQueuingStrategy.prototype.${n} can only be used on a CountQueuingStrategy`)}u(oa,"countBrandCheckException");function ia(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_countQueuingStrategyHighWaterMark")?!1:n instanceof eo}u(ia,"IsCountQueuingStrategy");function gc(n,i){Fe(n,i);let l=n?.cancel,d=n?.flush,b=n?.readableType,v=n?.start,_=n?.transform,T=n?.writableType;return{cancel:l===void 0?void 0:vc(l,n,`${i} has member 'cancel' that`),flush:d===void 0?void 0:bc(d,n,`${i} has member 'flush' that`),readableType:b,start:v===void 0?void 0:yc(v,n,`${i} has member 'start' that`),transform:_===void 0?void 0:wc(_,n,`${i} has member 'transform' that`),writableType:T}}u(gc,"convertTransformer");function bc(n,i,l){return Te(n,l),d=>$(n,i,[d])}u(bc,"convertTransformerFlushCallback");function yc(n,i,l){return Te(n,l),d=>x(n,i,[d])}u(yc,"convertTransformerStartCallback");function wc(n,i,l){return Te(n,l),(d,b)=>$(n,i,[d,b])}u(wc,"convertTransformerTransformCallback");function vc(n,i,l){return Te(n,l),d=>$(n,i,[d])}u(vc,"convertTransformerCancelCallback");let Ec=class{constructor(i={},l={},d={}){i===void 0&&(i=null);let b=Ur(l,"Second parameter"),v=Ur(d,"Third parameter"),_=gc(i,"First parameter");if(_.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(_.writableType!==void 0)throw new RangeError("Invalid writableType specified");let T=lr(v,0),L=zr(v),F=lr(b,1),z=zr(b),U,K=p(Ee=>{U=Ee});Sc(this,K,F,z,T,L),Pc(this,_),_.start!==void 0?U(_.start(this._transformStreamController)):U(void 0)}get readable(){if(!aa(this))throw ua("readable");return this._readable}get writable(){if(!aa(this))throw ua("writable");return this._writable}};u(Ec,"TransformStream");let to=Ec;Object.defineProperties(to.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(to.prototype,Symbol.toStringTag,{value:"TransformStream",configurable:!0});function Sc(n,i,l,d,b,v){function _(){return i}u(_,"startAlgorithm");function T(K){return Cc(n,K)}u(T,"writeAlgorithm");function L(K){return xc(n,K)}u(L,"abortAlgorithm");function F(){return Ic(n)}u(F,"closeAlgorithm"),n._writable=bl(_,T,F,L,l,d);function z(){return kc(n)}u(z,"pullAlgorithm");function U(K){return Bc(n,K)}u(U,"cancelAlgorithm"),n._readable=dr(_,z,U,b,v),n._backpressure=void 0,n._backpressureChangePromise=void 0,n._backpressureChangePromise_resolve=void 0,tn(n,!0),n._transformStreamController=void 0}u(Sc,"InitializeTransformStream");function aa(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_transformStreamController")?!1:n instanceof to}u(aa,"IsTransformStream");function sa(n,i){Be(n._readable._readableStreamController,i),ro(n,i)}u(sa,"TransformStreamError");function ro(n,i){nn(n._transformStreamController),ur(n._writable._writableStreamController,i),no(n)}u(ro,"TransformStreamErrorWritableAndUnblockWrite");function no(n){n._backpressure&&tn(n,!1)}u(no,"TransformStreamUnblockWrite");function tn(n,i){n._backpressureChangePromise!==void 0&&n._backpressureChangePromise_resolve(),n._backpressureChangePromise=p(l=>{n._backpressureChangePromise_resolve=l}),n._backpressure=i}u(tn,"TransformStreamSetBackpressure");let _c=class{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!rn(this))throw on("desiredSize");let i=this._controlledTransformStream._readable._readableStreamController;return Jn(i)}enqueue(i=void 0){if(!rn(this))throw on("enqueue");la(this,i)}error(i=void 0){if(!rn(this))throw on("error");Tc(this,i)}terminate(){if(!rn(this))throw on("terminate");Ac(this)}};u(_c,"TransformStreamDefaultController");let At=_c;Object.defineProperties(At.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),c(At.prototype.enqueue,"enqueue"),c(At.prototype.error,"error"),c(At.prototype.terminate,"terminate"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(At.prototype,Symbol.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function rn(n){return!a(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledTransformStream")?!1:n instanceof At}u(rn,"IsTransformStreamDefaultController");function Rc(n,i,l,d,b){i._controlledTransformStream=n,n._transformStreamController=i,i._transformAlgorithm=l,i._flushAlgorithm=d,i._cancelAlgorithm=b,i._finishPromise=void 0,i._finishPromise_resolve=void 0,i._finishPromise_reject=void 0}u(Rc,"SetUpTransformStreamDefaultController");function Pc(n,i){let l=Object.create(At.prototype),d,b,v;i.transform!==void 0?d=u(_=>i.transform(_,l),"transformAlgorithm"):d=u(_=>{try{return la(l,_),y(void 0)}catch(T){return E(T)}},"transformAlgorithm"),i.flush!==void 0?b=u(()=>i.flush(l),"flushAlgorithm"):b=u(()=>y(void 0),"flushAlgorithm"),i.cancel!==void 0?v=u(_=>i.cancel(_),"cancelAlgorithm"):v=u(()=>y(void 0),"cancelAlgorithm"),Rc(n,l,d,b,v)}u(Pc,"SetUpTransformStreamDefaultControllerFromTransformer");function nn(n){n._transformAlgorithm=void 0,n._flushAlgorithm=void 0,n._cancelAlgorithm=void 0}u(nn,"TransformStreamDefaultControllerClearAlgorithms");function la(n,i){let l=n._controlledTransformStream,d=l._readable._readableStreamController;if(!Ht(d))throw new TypeError("Readable side is not in a state that permits enqueue");try{Ut(d,i)}catch(b){throw ro(l,b),l._readable._storedError}Ql(d)!==l._backpressure&&tn(l,!0)}u(la,"TransformStreamDefaultControllerEnqueue");function Tc(n,i){sa(n._controlledTransformStream,i)}u(Tc,"TransformStreamDefaultControllerError");function ca(n,i){let l=n._transformAlgorithm(i);return P(l,void 0,d=>{throw sa(n._controlledTransformStream,d),d})}u(ca,"TransformStreamDefaultControllerPerformTransform");function Ac(n){let i=n._controlledTransformStream,l=i._readable._readableStreamController;Pt(l);let d=new TypeError("TransformStream terminated");ro(i,d)}u(Ac,"TransformStreamDefaultControllerTerminate");function Cc(n,i){let l=n._transformStreamController;if(n._backpressure){let d=n._backpressureChangePromise;return P(d,()=>{let b=n._writable;if(b._state==="erroring")throw b._storedError;return ca(l,i)})}return ca(l,i)}u(Cc,"TransformStreamDefaultSinkWriteAlgorithm");function xc(n,i){let l=n._transformStreamController;if(l._finishPromise!==void 0)return l._finishPromise;let d=n._readable;l._finishPromise=p((v,_)=>{l._finishPromise_resolve=v,l._finishPromise_reject=_});let b=l._cancelAlgorithm(i);return nn(l),R(b,()=>(d._state==="errored"?Gt(l,d._storedError):(Be(d._readableStreamController,i),oo(l)),null),v=>(Be(d._readableStreamController,v),Gt(l,v),null)),l._finishPromise}u(xc,"TransformStreamDefaultSinkAbortAlgorithm");function Ic(n){let i=n._transformStreamController;if(i._finishPromise!==void 0)return i._finishPromise;let l=n._readable;i._finishPromise=p((b,v)=>{i._finishPromise_resolve=b,i._finishPromise_reject=v});let d=i._flushAlgorithm();return nn(i),R(d,()=>(l._state==="errored"?Gt(i,l._storedError):(Pt(l._readableStreamController),oo(i)),null),b=>(Be(l._readableStreamController,b),Gt(i,b),null)),i._finishPromise}u(Ic,"TransformStreamDefaultSinkCloseAlgorithm");function kc(n){return tn(n,!1),n._backpressureChangePromise}u(kc,"TransformStreamDefaultSourcePullAlgorithm");function Bc(n,i){let l=n._transformStreamController;if(l._finishPromise!==void 0)return l._finishPromise;let d=n._writable;l._finishPromise=p((v,_)=>{l._finishPromise_resolve=v,l._finishPromise_reject=_});let b=l._cancelAlgorithm(i);return nn(l),R(b,()=>(d._state==="errored"?Gt(l,d._storedError):(ur(d._writableStreamController,i),no(n),oo(l)),null),v=>(ur(d._writableStreamController,v),no(n),Gt(l,v),null)),l._finishPromise}u(Bc,"TransformStreamDefaultSourceCancelAlgorithm");function on(n){return new TypeError(`TransformStreamDefaultController.prototype.${n} can only be used on a TransformStreamDefaultController`)}u(on,"defaultControllerBrandCheckException");function oo(n){n._finishPromise_resolve!==void 0&&(n._finishPromise_resolve(),n._finishPromise_resolve=void 0,n._finishPromise_reject=void 0)}u(oo,"defaultControllerFinishPromiseResolve");function Gt(n,i){n._finishPromise_reject!==void 0&&(V(n._finishPromise),n._finishPromise_reject(i),n._finishPromise_resolve=void 0,n._finishPromise_reject=void 0)}u(Gt,"defaultControllerFinishPromiseReject");function ua(n){return new TypeError(`TransformStream.prototype.${n} can only be used on a TransformStream`)}u(ua,"streamBrandCheckException"),r.ByteLengthQueuingStrategy=Zn,r.CountQueuingStrategy=eo,r.ReadableByteStreamController=ot,r.ReadableStream=he,r.ReadableStreamBYOBReader=vt,r.ReadableStreamBYOBRequest=Nt,r.ReadableStreamDefaultController=at,r.ReadableStreamDefaultReader=gt,r.TransformStream=to,r.TransformStreamDefaultController=At,r.WritableStream=St,r.WritableStreamDefaultController=cr,r.WritableStreamDefaultWriter=it})}(Ja,Ja.exports)),Ja.exports}async function*$o(e,t=!0){for(let r of e)if("stream"in r)yield*r.stream();else if(ArrayBuffer.isView(r))if(t){let o=r.byteOffset,a=r.byteOffset+r.byteLength;for(;o!==a;){let s=Math.min(a-o,Ih),c=r.buffer.slice(o,o+s);o+=c.byteLength,yield new Uint8Array(c)}}else yield r;else{let o=0,a=r;for(;o!==a.size;){let s=await a.slice(o,Math.min(a.size,o+Ih)).arrayBuffer();o+=s.byteLength,yield new Uint8Array(s)}}}function Nh(e,t=rr){var r=`${kh()}${kh()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),o=[],a=`--${r}\r
Content-Disposition: form-data; name="`;return e.forEach((s,c)=>typeof s=="string"?o.push(a+Ka(c)+`"\r
\r
${s.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):o.push(a+Ka(c)+`"; filename="${Ka(s.name,1)}"\r
Content-Type: ${s.type||"application/octet-stream"}\r
\r
`,s,`\r
`)),o.push(`--${r}--`),new t(o,{type:"multipart/form-data; boundary="+r})}async function Do(e){if(e[Re].disturbed)throw new TypeError(`body used already for: ${e.url}`);if(e[Re].disturbed=!0,e[Re].error)throw e[Re].error;let{body:t}=e;if(t===null)return de.alloc(0);if(!(t instanceof Ze))return de.alloc(0);let r=[],o=0;try{for await(let a of t){if(e.size>0&&o+a.length>e.size){let s=new ze(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(s),s}o+=a.length,r.push(a)}}catch(a){throw a instanceof Xo?a:new ze(`Invalid response body while trying to fetch ${e.url}: ${a.message}`,"system",a)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return r.every(a=>typeof a=="string")?de.from(r.join("")):de.concat(r,o)}catch(a){throw new ze(`Could not create Buffer from response body for ${e.url}: ${a.message}`,"system",a)}else throw new ze(`Premature close of server response while trying to fetch ${e.url}`)}function Qh(e=[]){return new pt(e.reduce((t,r,o,a)=>(o%2===0&&t.push(a.slice(o,o+2)),t),[]).filter(([t,r])=>{try{return No(t),Za(t,String(r)),!0}catch{return!1}}))}function es(e,t=!1){return e==null||(e=new URL(e),/^(about|blob|data):$/.test(e.protocol))?"no-referrer":(e.username="",e.password="",e.hash="",t&&(e.pathname="",e.search=""),e)}function Jh(e){if(!Xh.has(e))throw new TypeError(`Invalid referrerPolicy: ${e}`);return e}function Kh(e){if(/^(http|ws)s:$/.test(e.protocol))return!0;let t=e.host.replace(/(^\[)|(]$)/g,""),r=M0(t);return r===4&&/^127\./.test(t)||r===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:e.host==="localhost"||e.host.endsWith(".localhost")?!1:e.protocol==="file:"}function er(e){return/^about:(blank|srcdoc)$/.test(e)||e.protocol==="data:"||/^(blob|filesystem):$/.test(e.protocol)?!0:Kh(e)}function Zh(e,{referrerURLCallback:t,referrerOriginCallback:r}={}){if(e.referrer==="no-referrer"||e.referrerPolicy==="")return null;let o=e.referrerPolicy;if(e.referrer==="about:client")return"no-referrer";let a=e.referrer,s=es(a),c=es(a,!0);s.toString().length>4096&&(s=c),t&&(s=t(s)),r&&(c=r(c));let f=new URL(e.url);switch(o){case"no-referrer":return"no-referrer";case"origin":return c;case"unsafe-url":return s;case"strict-origin":return er(s)&&!er(f)?"no-referrer":c.toString();case"strict-origin-when-cross-origin":return s.origin===f.origin?s:er(s)&&!er(f)?"no-referrer":c;case"same-origin":return s.origin===f.origin?s:"no-referrer";case"origin-when-cross-origin":return s.origin===f.origin?s:c;case"no-referrer-when-downgrade":return er(s)&&!er(f)?"no-referrer":s;default:throw new TypeError(`Invalid referrerPolicy: ${o}`)}}function ed(e){let t=(e.get("referrer-policy")||"").split(/[,\s]+/),r="";for(let o of t)o&&Xh.has(o)&&(r=o);return r}async function us(e,t){return new Promise((r,o)=>{let a=new Sn(e,t),{parsedURL:s,options:c}=cy(a);if(!gy.has(s.protocol))throw new TypeError(`node-fetch cannot load ${e}. URL scheme "${s.protocol.replace(/:$/,"")}" is not supported.`);if(s.protocol==="data:"){let R=Fh(a.url),B=new Je(R,{headers:{"Content-Type":R.typeFull}});r(B);return}let f=(s.protocol==="https:"?$0:En).request,{signal:m}=a,g=null,p=u(()=>{let R=new od("The operation was aborted.");o(R),a.body&&a.body instanceof Ze.Readable&&a.body.destroy(R),!(!g||!g.body)&&g.body.emit("error",R)},"abort");if(m&&m.aborted){p();return}let y=u(()=>{p(),I()},"abortAndFinalize"),E=f(s.toString(),c);m&&m.addEventListener("abort",y);let I=u(()=>{E.abort(),m&&m.removeEventListener("abort",y)},"finalize");E.on("error",R=>{o(new ze(`request to ${a.url} failed, reason: ${R.message}`,"system",R)),I()}),ud(E,R=>{g&&g.body&&g.body.destroy(R)}),process.version<"v14"&&E.on("socket",R=>{let B;R.prependListener("end",()=>{B=R._eventsCount}),R.prependListener("close",O=>{if(g&&B<R._eventsCount&&!O){let P=new Error("Premature close");P.code="ERR_STREAM_PREMATURE_CLOSE",g.body.emit("error",P)}})}),E.on("response",R=>{E.setTimeout(0);let B=Qh(R.rawHeaders);if(ls(R.statusCode)){let x=B.get("Location"),$=null;try{$=x===null?null:new URL(x,a.url)}catch{if(a.redirect!=="manual"){o(new ze(`uri requested responds with an invalid redirect URL: ${x}`,"invalid-redirect")),I();return}}switch(a.redirect){case"error":o(new ze(`uri requested responds with a redirect, redirect mode is set to error: ${a.url}`,"no-redirect")),I();return;case"manual":break;case"follow":{if($===null)break;if(a.counter>=a.follow){o(new ze(`maximum redirect reached at: ${a.url}`,"max-redirect")),I();return}let N={headers:new pt(a.headers),follow:a.follow,counter:a.counter+1,agent:a.agent,compress:a.compress,method:a.method,body:ss(a),signal:a.signal,size:a.size,referrer:a.referrer,referrerPolicy:a.referrerPolicy};if(!Z0(a.url,$)||!ey(a.url,$))for(let G of["authorization","www-authenticate","cookie","cookie2"])N.headers.delete(G);if(R.statusCode!==303&&a.body&&t.body instanceof Ze.Readable){o(new ze("Cannot follow redirect with body being a readable stream","unsupported-redirect")),I();return}(R.statusCode===303||(R.statusCode===301||R.statusCode===302)&&a.method==="POST")&&(N.method="GET",N.body=void 0,N.headers.delete("content-length"));let M=ed(B);M&&(N.referrerPolicy=M),r(us(new Sn($,N))),I();return}default:return o(new TypeError(`Redirect option '${a.redirect}' is not a valid value of RequestRedirect`))}}m&&R.once("end",()=>{m.removeEventListener("abort",y)});let O=xr(R,new Wo,x=>{x&&o(x)});process.version<"v12.10"&&R.on("aborted",y);let P={url:a.url,status:R.statusCode,statusText:R.statusMessage,headers:B,size:a.size,counter:a.counter,highWaterMark:a.highWaterMark},V=B.get("Content-Encoding");if(!a.compress||a.method==="HEAD"||V===null||R.statusCode===204||R.statusCode===304){g=new Je(O,P),r(g);return}let H={flush:Cr.Z_SYNC_FLUSH,finishFlush:Cr.Z_SYNC_FLUSH};if(V==="gzip"||V==="x-gzip"){O=xr(O,Cr.createGunzip(H),x=>{x&&o(x)}),g=new Je(O,P),r(g);return}if(V==="deflate"||V==="x-deflate"){let x=xr(R,new Wo,$=>{$&&o($)});x.once("data",$=>{($[0]&15)===8?O=xr(O,Cr.createInflate(),N=>{N&&o(N)}):O=xr(O,Cr.createInflateRaw(),N=>{N&&o(N)}),g=new Je(O,P),r(g)}),x.once("end",()=>{g||(g=new Je(O,P),r(g))});return}if(V==="br"){O=xr(O,Cr.createBrotliDecompress(),x=>{x&&o(x)}),g=new Je(O,P),r(g);return}g=new Je(O,P),r(g)}),oy(E,a).catch(o)})}function ud(e,t){let r=de.from(`0\r
\r
`),o=!1,a=!1,s;e.on("response",c=>{let{headers:f}=c;o=f["transfer-encoding"]==="chunked"&&!f["content-length"]}),e.on("socket",c=>{let f=u(()=>{if(o&&!a){let g=new Error("Premature close");g.code="ERR_STREAM_PREMATURE_CLOSE",t(g)}},"onSocketClose"),m=u(g=>{a=de.compare(g.slice(-5),r)===0,!a&&s&&(a=de.compare(s.slice(-3),r.slice(0,3))===0&&de.compare(g.slice(-2),r.slice(3))===0),s=g},"onData");c.prependListener("close",f),c.on("data",m),e.on("close",()=>{c.removeListener("close",f),c.removeListener("data",m)})})}function te(e){let t=fd.get(e);return console.assert(t!=null,"'this' is expected an Event object, but got",e),t}function rs(e){if(e.passiveListener!=null){typeof console<"u"&&typeof console.error=="function"&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener);return}e.event.cancelable&&(e.canceled=!0,typeof e.event.preventDefault=="function"&&e.event.preventDefault())}function tr(e,t){fd.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let r=Object.keys(t);for(let o=0;o<r.length;++o){let a=r[o];a in this||Object.defineProperty(this,a,fs(a))}}function fs(e){return{get(){return te(this).event[e]},set(t){te(this).event[e]=t},configurable:!0,enumerable:!0}}function hd(e){return{value(){let t=te(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function dd(e,t){let r=Object.keys(t);if(r.length===0)return e;function o(a,s){e.call(this,a,s)}u(o,"CustomEvent"),o.prototype=Object.create(e.prototype,{constructor:{value:o,configurable:!0,writable:!0}});for(let a=0;a<r.length;++a){let s=r[a];if(!(s in e.prototype)){let c=typeof Object.getOwnPropertyDescriptor(t,s).value=="function";Object.defineProperty(o.prototype,s,c?hd(s):fs(s))}}return o}function hs(e){if(e==null||e===Object.prototype)return tr;let t=ts.get(e);return t==null&&(t=dd(hs(Object.getPrototypeOf(e)),e),ts.set(e,t)),t}function md(e,t){let r=hs(Object.getPrototypeOf(t));return new r(e,t)}function pd(e){return te(e).immediateStopped}function gd(e,t){te(e).eventPhase=t}function bd(e,t){te(e).currentTarget=t}function ns(e,t){te(e).passiveListener=t}function vn(e){return e!==null&&typeof e=="object"}function Br(e){let t=yd.get(e);if(t==null)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function wd(e){return{get(){let t=Br(this).get(e);for(;t!=null;){if(t.listenerType===Mo)return t.listener;t=t.next}return null},set(t){typeof t!="function"&&!vn(t)&&(t=null);let r=Br(this),o=null,a=r.get(e);for(;a!=null;)a.listenerType===Mo?o!==null?o.next=a.next:a.next!==null?r.set(e,a.next):r.delete(e):o=a,a=a.next;if(t!==null){let s={listener:t,listenerType:Mo,passive:!1,once:!1,next:null};o===null?r.set(e,s):o.next=s}},configurable:!0,enumerable:!0}}function ds(e,t){Object.defineProperty(e,`on${t}`,wd(t))}function os(e){function t(){Ke.call(this)}u(t,"CustomEventTarget"),t.prototype=Object.create(Ke.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let r=0;r<e.length;++r)ds(t.prototype,e[r]);return t}function Ke(){if(this instanceof Ke){yd.set(this,new Map);return}if(arguments.length===1&&Array.isArray(arguments[0]))return os(arguments[0]);if(arguments.length>0){let e=new Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return os(e)}throw new TypeError("Cannot call a class as a function")}function Ed(){let e=Object.create(Vo.prototype);return Ke.call(e),Qo.set(e,!1),e}function Sd(e){Qo.get(e)===!1&&(Qo.set(e,!0),e.dispatchEvent({type:"abort"}))}function is(e){let t=_d.get(e);if(t==null)throw new TypeError(`Expected 'this' to be an 'AbortController' object, but got ${e===null?"null":typeof e}`);return t}function as(){!globalThis.process?.versions?.node&&!globalThis.process?.env.DISABLE_NODE_FETCH_NATIVE_WARN&&console.warn("[node-fetch-native] Node.js compatible build of `node-fetch-native` is being used in a non-Node.js environment. Please make sure you are using proper export conditions or report this issue to https://github.com/unjs/node-fetch-native. You can set `process.env.DISABLE_NODE_FETCH_NATIVE_WARN` to disable this warning.")}var F0,u,Oh,oe,mt,We,jt,Oo,Ar,Va,pn,jo,Fo,Qa,Ne,Ya,Ir,kr,Xa,Ja,xh,H0,Ih,Dh,G0,rr,V0,Q0,Tr,yn,Y0,X0,kh,J0,Bh,Ka,Zt,Kt,Mh,Xo,Wh,ze,Ho,zh,Go,K0,Z0,ey,ty,Re,Uh,wn,ss,ry,Hh,ny,oy,No,Za,Gh,pt,iy,ls,Me,Yh,Je,ay,Xh,sy,ue,gn,ly,td,Sn,cy,nd,od,uy,fy,cs,hy,dy,my,py,id,ad,sd,cd,gy,fd,ts,yd,qh,Lh,Mo,vd,Vo,Qo,Yo,_d,by,yy,Rd,Lo=da(()=>{ko();F0=Object.defineProperty,u=(e,t)=>F0(e,"name",{value:t,configurable:!0}),Oh=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},oe=(e,t,r)=>(Oh(e,t,"read from private field"),r?r.call(e):t.get(e)),mt=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},We=(e,t,r,o)=>(Oh(e,t,"write to private field"),o?o.call(e,r):t.set(e,r),r);u(Fh,"dataUriToBuffer");Ja={exports:{}};u($h,"requirePonyfill_es2018");H0=65536;if(!globalThis.ReadableStream)try{let e=Z("node:process"),{emitWarning:t}=e;try{e.emitWarning=()=>{},Object.assign(globalThis,Z("node:stream/web")),e.emitWarning=t}catch(r){throw e.emitWarning=t,r}}catch{Object.assign(globalThis,$h())}try{let{Blob:e}=Z("buffer");e&&!e.prototype.stream&&(e.prototype.stream=u(function(t){let r=0,o=this;return new ReadableStream({type:"bytes",async pull(a){let s=await o.slice(r,Math.min(o.size,r+H0)).arrayBuffer();r+=s.byteLength,a.enqueue(new Uint8Array(s)),r===o.size&&a.close()}})},"name"))}catch{}Ih=65536;u($o,"toIterator");Dh=(pn=class{constructor(e=[],t={}){if(mt(this,jt,[]),mt(this,Oo,""),mt(this,Ar,0),mt(this,Va,"transparent"),typeof e!="object"||e===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof e[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof t!="object"&&typeof t!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");t===null&&(t={});let r=new TextEncoder;for(let a of e){let s;ArrayBuffer.isView(a)?s=new Uint8Array(a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength)):a instanceof ArrayBuffer?s=new Uint8Array(a.slice(0)):a instanceof pn?s=a:s=r.encode(`${a}`),We(this,Ar,oe(this,Ar)+(ArrayBuffer.isView(s)?s.byteLength:s.size)),oe(this,jt).push(s)}We(this,Va,`${t.endings===void 0?"transparent":t.endings}`);let o=t.type===void 0?"":String(t.type);We(this,Oo,/^[\x20-\x7E]*$/.test(o)?o:"")}get size(){return oe(this,Ar)}get type(){return oe(this,Oo)}async text(){let e=new TextDecoder,t="";for await(let r of $o(oe(this,jt),!1))t+=e.decode(r,{stream:!0});return t+=e.decode(),t}async arrayBuffer(){let e=new Uint8Array(this.size),t=0;for await(let r of $o(oe(this,jt),!1))e.set(r,t),t+=r.length;return e.buffer}stream(){let e=$o(oe(this,jt),!0);return new globalThis.ReadableStream({type:"bytes",async pull(t){let r=await e.next();r.done?t.close():t.enqueue(r.value)},async cancel(){await e.return()}})}slice(e=0,t=this.size,r=""){let{size:o}=this,a=e<0?Math.max(o+e,0):Math.min(e,o),s=t<0?Math.max(o+t,0):Math.min(t,o),c=Math.max(s-a,0),f=oe(this,jt),m=[],g=0;for(let y of f){if(g>=c)break;let E=ArrayBuffer.isView(y)?y.byteLength:y.size;if(a&&E<=a)a-=E,s-=E;else{let I;ArrayBuffer.isView(y)?(I=y.subarray(a,Math.min(E,s)),g+=I.byteLength):(I=y.slice(a,Math.min(E,s)),g+=I.size),s-=E,m.push(I),a=0}}let p=new pn([],{type:String(r).toLowerCase()});return We(p,Ar,c),We(p,jt,m),p}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&typeof e=="object"&&typeof e.constructor=="function"&&(typeof e.stream=="function"||typeof e.arrayBuffer=="function")&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}},jt=new WeakMap,Oo=new WeakMap,Ar=new WeakMap,Va=new WeakMap,u(pn,"Blob"),pn);Object.defineProperties(Dh.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});G0=Dh,rr=G0,V0=(Qa=class extends rr{constructor(e,t,r={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(e,r),mt(this,jo,0),mt(this,Fo,""),r===null&&(r={});let o=r.lastModified===void 0?Date.now():Number(r.lastModified);Number.isNaN(o)||We(this,jo,o),We(this,Fo,String(t))}get name(){return oe(this,Fo)}get lastModified(){return oe(this,jo)}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](e){return!!e&&e instanceof rr&&/^(File)$/.test(e[Symbol.toStringTag])}},jo=new WeakMap,Fo=new WeakMap,u(Qa,"File"),Qa),Q0=V0,Tr=Q0;({toStringTag:yn,iterator:Y0,hasInstance:X0}=Symbol),kh=Math.random,J0="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),Bh=u((e,t,r)=>(e+="",/^(Blob|File)$/.test(t&&t[yn])?[(r=r!==void 0?r+"":t[yn]=="File"?t.name:"blob",e),t.name!==r||t[yn]=="blob"?new Tr([t],r,t):t]:[e,t+""]),"f"),Ka=u((e,t)=>(t?e:e.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),"e$1"),Zt=u((e,t,r)=>{if(t.length<r)throw new TypeError(`Failed to execute '${e}' on 'FormData': ${r} arguments required, but only ${t.length} present.`)},"x"),Kt=(Ya=class{constructor(...e){if(mt(this,Ne,[]),e.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[yn](){return"FormData"}[Y0](){return this.entries()}static[X0](e){return e&&typeof e=="object"&&e[yn]==="FormData"&&!J0.some(t=>typeof e[t]!="function")}append(...e){Zt("append",arguments,2),oe(this,Ne).push(Bh(...e))}delete(e){Zt("delete",arguments,1),e+="",We(this,Ne,oe(this,Ne).filter(([t])=>t!==e))}get(e){Zt("get",arguments,1),e+="";for(var t=oe(this,Ne),r=t.length,o=0;o<r;o++)if(t[o][0]===e)return t[o][1];return null}getAll(e,t){return Zt("getAll",arguments,1),t=[],e+="",oe(this,Ne).forEach(r=>r[0]===e&&t.push(r[1])),t}has(e){return Zt("has",arguments,1),e+="",oe(this,Ne).some(t=>t[0]===e)}forEach(e,t){Zt("forEach",arguments,1);for(var[r,o]of this)e.call(t,o,r,this)}set(...e){Zt("set",arguments,2);var t=[],r=!0;e=Bh(...e),oe(this,Ne).forEach(o=>{o[0]===e[0]?r&&(r=!t.push(e)):t.push(o)}),r&&t.push(e),We(this,Ne,t)}*entries(){yield*oe(this,Ne)}*keys(){for(var[e]of this)yield e}*values(){for(var[,e]of this)yield e}},Ne=new WeakMap,u(Ya,"FormData"),Ya);u(Nh,"formDataToBlob");Mh=class extends Error{constructor(t,r){super(t),Error.captureStackTrace(this,this.constructor),this.type=r}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};u(Mh,"FetchBaseError");Xo=Mh,Wh=class extends Xo{constructor(t,r,o){super(t,r),o&&(this.code=this.errno=o.code,this.erroredSysCall=o.syscall)}};u(Wh,"FetchError");ze=Wh,Ho=Symbol.toStringTag,zh=u(e=>typeof e=="object"&&typeof e.append=="function"&&typeof e.delete=="function"&&typeof e.get=="function"&&typeof e.getAll=="function"&&typeof e.has=="function"&&typeof e.set=="function"&&typeof e.sort=="function"&&e[Ho]==="URLSearchParams","isURLSearchParameters"),Go=u(e=>e&&typeof e=="object"&&typeof e.arrayBuffer=="function"&&typeof e.type=="string"&&typeof e.stream=="function"&&typeof e.constructor=="function"&&/^(Blob|File)$/.test(e[Ho]),"isBlob"),K0=u(e=>typeof e=="object"&&(e[Ho]==="AbortSignal"||e[Ho]==="EventTarget"),"isAbortSignal"),Z0=u((e,t)=>{let r=new URL(t).hostname,o=new URL(e).hostname;return r===o||r.endsWith(`.${o}`)},"isDomainOrSubdomain"),ey=u((e,t)=>{let r=new URL(t).protocol,o=new URL(e).protocol;return r===o},"isSameProtocol"),ty=D0(Ze.pipeline),Re=Symbol("Body internals"),Uh=class{constructor(t,{size:r=0}={}){let o=null;t===null?t=null:zh(t)?t=de.from(t.toString()):Go(t)||de.isBuffer(t)||(zo.isAnyArrayBuffer(t)?t=de.from(t):ArrayBuffer.isView(t)?t=de.from(t.buffer,t.byteOffset,t.byteLength):t instanceof Ze||(t instanceof Kt?(t=Nh(t),o=t.type.split("=")[1]):t=de.from(String(t))));let a=t;de.isBuffer(t)?a=Ze.Readable.from(t):Go(t)&&(a=Ze.Readable.from(t.stream())),this[Re]={body:t,stream:a,boundary:o,disturbed:!1,error:null},this.size=r,t instanceof Ze&&t.on("error",s=>{let c=s instanceof Xo?s:new ze(`Invalid response body while trying to fetch ${this.url}: ${s.message}`,"system",s);this[Re].error=c})}get body(){return this[Re].stream}get bodyUsed(){return this[Re].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:r,byteLength:o}=await Do(this);return t.slice(r,r+o)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let o=new Kt,a=new URLSearchParams(await this.text());for(let[s,c]of a)o.append(s,c);return o}let{toFormData:r}=await Promise.resolve().then(()=>(Ch(),Ah));return r(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[Re].body&&this[Re].body.type||"",r=await this.arrayBuffer();return new rr([r],{type:t})}async json(){let t=await this.text();return JSON.parse(t)}async text(){let t=await Do(this);return new TextDecoder().decode(t)}buffer(){return Do(this)}};u(Uh,"Body");wn=Uh;wn.prototype.buffer=Uo(wn.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer"),Object.defineProperties(wn.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:Uo(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});u(Do,"consumeBody");ss=u((e,t)=>{let r,o,{body:a}=e[Re];if(e.bodyUsed)throw new Error("cannot clone body after it is used");return a instanceof Ze&&typeof a.getBoundary!="function"&&(r=new Wo({highWaterMark:t}),o=new Wo({highWaterMark:t}),a.pipe(r),a.pipe(o),e[Re].stream=r,a=o),a},"clone"),ry=Uo(e=>e.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Hh=u((e,t)=>e===null?null:typeof e=="string"?"text/plain;charset=UTF-8":zh(e)?"application/x-www-form-urlencoded;charset=UTF-8":Go(e)?e.type||null:de.isBuffer(e)||zo.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e instanceof Kt?`multipart/form-data; boundary=${t[Re].boundary}`:e&&typeof e.getBoundary=="function"?`multipart/form-data;boundary=${ry(e)}`:e instanceof Ze?null:"text/plain;charset=UTF-8","extractContentType"),ny=u(e=>{let{body:t}=e[Re];return t===null?0:Go(t)?t.size:de.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},"getTotalBytes"),oy=u(async(e,{body:t})=>{t===null?e.end():await ty(t,e)},"writeToStream"),No=typeof En.validateHeaderName=="function"?En.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let t=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},Za=typeof En.validateHeaderValue=="function"?En.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let r=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_CHAR"}),r}},Gh=class Vh extends URLSearchParams{constructor(t){let r=[];if(t instanceof Vh){let o=t.raw();for(let[a,s]of Object.entries(o))r.push(...s.map(c=>[a,c]))}else if(t!=null)if(typeof t=="object"&&!zo.isBoxedPrimitive(t)){let o=t[Symbol.iterator];if(o==null)r.push(...Object.entries(t));else{if(typeof o!="function")throw new TypeError("Header pairs must be iterable");r=[...t].map(a=>{if(typeof a!="object"||zo.isBoxedPrimitive(a))throw new TypeError("Each header pair must be an iterable object");return[...a]}).map(a=>{if(a.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...a]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return r=r.length>0?r.map(([o,a])=>(No(o),Za(o,String(a)),[String(o).toLowerCase(),String(a)])):void 0,super(r),new Proxy(this,{get(o,a,s){switch(a){case"append":case"set":return(c,f)=>(No(c),Za(c,String(f)),URLSearchParams.prototype[a].call(o,String(c).toLowerCase(),String(f)));case"delete":case"has":case"getAll":return c=>(No(c),URLSearchParams.prototype[a].call(o,String(c).toLowerCase()));case"keys":return()=>(o.sort(),new Set(URLSearchParams.prototype.keys.call(o)).keys());default:return Reflect.get(o,a,s)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let r=this.getAll(t);if(r.length===0)return null;let o=r.join(", ");return/^content-encoding$/i.test(t)&&(o=o.toLowerCase()),o}forEach(t,r=void 0){for(let o of this.keys())Reflect.apply(t,r,[this.get(o),o,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,r)=>(t[r]=this.getAll(r),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,r)=>{let o=this.getAll(r);return r==="host"?t[r]=o[0]:t[r]=o.length>1?o:o[0],t},{})}};u(Gh,"Headers");pt=Gh;Object.defineProperties(pt.prototype,["get","entries","forEach","values"].reduce((e,t)=>(e[t]={enumerable:!0},e),{}));u(Qh,"fromRawHeaders");iy=new Set([301,302,303,307,308]),ls=u(e=>iy.has(e),"isRedirect"),Me=Symbol("Response internals"),Yh=class bn extends wn{constructor(t=null,r={}){super(t,r);let o=r.status!=null?r.status:200,a=new pt(r.headers);if(t!==null&&!a.has("Content-Type")){let s=Hh(t,this);s&&a.append("Content-Type",s)}this[Me]={type:"default",url:r.url,status:o,statusText:r.statusText||"",headers:a,counter:r.counter,highWaterMark:r.highWaterMark}}get type(){return this[Me].type}get url(){return this[Me].url||""}get status(){return this[Me].status}get ok(){return this[Me].status>=200&&this[Me].status<300}get redirected(){return this[Me].counter>0}get statusText(){return this[Me].statusText}get headers(){return this[Me].headers}get highWaterMark(){return this[Me].highWaterMark}clone(){return new bn(ss(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,r=302){if(!ls(r))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new bn(null,{headers:{location:new URL(t).toString()},status:r})}static error(){let t=new bn(null,{status:0,statusText:""});return t[Me].type="error",t}static json(t=void 0,r={}){let o=JSON.stringify(t);if(o===void 0)throw new TypeError("data is not JSON serializable");let a=new pt(r&&r.headers);return a.has("content-type")||a.set("content-type","application/json"),new bn(o,{...r,headers:a})}get[Symbol.toStringTag](){return"Response"}};u(Yh,"Response");Je=Yh;Object.defineProperties(Je.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});ay=u(e=>{if(e.search)return e.search;let t=e.href.length-1,r=e.hash||(e.href[t]==="#"?"#":"");return e.href[t-r.length]==="?"?"?":""},"getSearch");u(es,"stripURLForUseAsAReferrer");Xh=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),sy="strict-origin-when-cross-origin";u(Jh,"validateReferrerPolicy");u(Kh,"isOriginPotentiallyTrustworthy");u(er,"isUrlPotentiallyTrustworthy");u(Zh,"determineRequestsReferrer");u(ed,"parseReferrerPolicyFromHeader");ue=Symbol("Request internals"),gn=u(e=>typeof e=="object"&&typeof e[ue]=="object","isRequest"),ly=Uo(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),td=class rd extends wn{constructor(t,r={}){let o;if(gn(t)?o=new URL(t.url):(o=new URL(t),t={}),o.username!==""||o.password!=="")throw new TypeError(`${o} is an url with embedded credentials.`);let a=r.method||t.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(a)&&(a=a.toUpperCase()),!gn(r)&&"data"in r&&ly(),(r.body!=null||gn(t)&&t.body!==null)&&(a==="GET"||a==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let s=r.body?r.body:gn(t)&&t.body!==null?ss(t):null;super(s,{size:r.size||t.size||0});let c=new pt(r.headers||t.headers||{});if(s!==null&&!c.has("Content-Type")){let g=Hh(s,this);g&&c.set("Content-Type",g)}let f=gn(t)?t.signal:null;if("signal"in r&&(f=r.signal),f!=null&&!K0(f))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let m=r.referrer==null?t.referrer:r.referrer;if(m==="")m="no-referrer";else if(m){let g=new URL(m);m=/^about:(\/\/)?client$/.test(g)?"client":g}else m=void 0;this[ue]={method:a,redirect:r.redirect||t.redirect||"follow",headers:c,parsedURL:o,signal:f,referrer:m},this.follow=r.follow===void 0?t.follow===void 0?20:t.follow:r.follow,this.compress=r.compress===void 0?t.compress===void 0?!0:t.compress:r.compress,this.counter=r.counter||t.counter||0,this.agent=r.agent||t.agent,this.highWaterMark=r.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=r.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=r.referrerPolicy||t.referrerPolicy||""}get method(){return this[ue].method}get url(){return N0(this[ue].parsedURL)}get headers(){return this[ue].headers}get redirect(){return this[ue].redirect}get signal(){return this[ue].signal}get referrer(){if(this[ue].referrer==="no-referrer")return"";if(this[ue].referrer==="client")return"about:client";if(this[ue].referrer)return this[ue].referrer.toString()}get referrerPolicy(){return this[ue].referrerPolicy}set referrerPolicy(t){this[ue].referrerPolicy=Jh(t)}clone(){return new rd(this)}get[Symbol.toStringTag](){return"Request"}};u(td,"Request");Sn=td;Object.defineProperties(Sn.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});cy=u(e=>{let{parsedURL:t}=e[ue],r=new pt(e[ue].headers);r.has("Accept")||r.set("Accept","*/*");let o=null;if(e.body===null&&/^(post|put)$/i.test(e.method)&&(o="0"),e.body!==null){let f=ny(e);typeof f=="number"&&!Number.isNaN(f)&&(o=String(f))}o&&r.set("Content-Length",o),e.referrerPolicy===""&&(e.referrerPolicy=sy),e.referrer&&e.referrer!=="no-referrer"?e[ue].referrer=Zh(e):e[ue].referrer="no-referrer",e[ue].referrer instanceof URL&&r.set("Referer",e.referrer),r.has("User-Agent")||r.set("User-Agent","node-fetch"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip, deflate, br");let{agent:a}=e;typeof a=="function"&&(a=a(t));let s=ay(t),c={path:t.pathname+s,method:e.method,headers:r[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:a};return{parsedURL:t,options:c}},"getNodeRequestOptions"),nd=class extends Xo{constructor(t,r="aborted"){super(t,r)}};u(nd,"AbortError");od=nd;if(!globalThis.DOMException)try{let{MessageChannel:e}=Z("worker_threads"),t=new e().port1,r=new ArrayBuffer;t.postMessage(r,[r,r])}catch(e){e.constructor.name==="DOMException"&&(globalThis.DOMException=e.constructor)}uy=globalThis.DOMException,fy=Ga(uy),{stat:cs}=z0,hy=u((e,t)=>id(jh(e),e,t),"blobFromSync"),dy=u((e,t)=>cs(e).then(r=>id(r,e,t)),"blobFrom"),my=u((e,t)=>cs(e).then(r=>ad(r,e,t)),"fileFrom"),py=u((e,t)=>ad(jh(e),e,t),"fileFromSync"),id=u((e,t,r="")=>new rr([new cd({path:t,size:e.size,lastModified:e.mtimeMs,start:0})],{type:r}),"fromBlob"),ad=u((e,t,r="")=>new Tr([new cd({path:t,size:e.size,lastModified:e.mtimeMs,start:0})],U0(t),{type:r,lastModified:e.mtimeMs}),"fromFile"),sd=class ld{constructor(t){mt(this,Ir,void 0),mt(this,kr,void 0),We(this,Ir,t.path),We(this,kr,t.start),this.size=t.size,this.lastModified=t.lastModified}slice(t,r){return new ld({path:oe(this,Ir),lastModified:this.lastModified,size:r-t,start:oe(this,kr)+t})}async*stream(){let{mtimeMs:t}=await cs(oe(this,Ir));if(t>this.lastModified)throw new fy("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*W0(oe(this,Ir),{start:oe(this,kr),end:oe(this,kr)+this.size-1})}get[Symbol.toStringTag](){return"Blob"}};Ir=new WeakMap,kr=new WeakMap,u(sd,"BlobDataItem");cd=sd,gy=new Set(["data:","http:","https:"]);u(us,"fetch$1");u(ud,"fixResponseChunkedTransferBadEnding");fd=new WeakMap,ts=new WeakMap;u(te,"pd");u(rs,"setCancelFlag");u(tr,"Event"),tr.prototype={get type(){return te(this).event.type},get target(){return te(this).eventTarget},get currentTarget(){return te(this).currentTarget},composedPath(){let e=te(this).currentTarget;return e==null?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return te(this).eventPhase},stopPropagation(){let e=te(this);e.stopped=!0,typeof e.event.stopPropagation=="function"&&e.event.stopPropagation()},stopImmediatePropagation(){let e=te(this);e.stopped=!0,e.immediateStopped=!0,typeof e.event.stopImmediatePropagation=="function"&&e.event.stopImmediatePropagation()},get bubbles(){return!!te(this).event.bubbles},get cancelable(){return!!te(this).event.cancelable},preventDefault(){rs(te(this))},get defaultPrevented(){return te(this).canceled},get composed(){return!!te(this).event.composed},get timeStamp(){return te(this).timeStamp},get srcElement(){return te(this).eventTarget},get cancelBubble(){return te(this).stopped},set cancelBubble(e){if(!e)return;let t=te(this);t.stopped=!0,typeof t.event.cancelBubble=="boolean"&&(t.event.cancelBubble=!0)},get returnValue(){return!te(this).canceled},set returnValue(e){e||rs(te(this))},initEvent(){}},Object.defineProperty(tr.prototype,"constructor",{value:tr,configurable:!0,writable:!0}),typeof window<"u"&&typeof window.Event<"u"&&(Object.setPrototypeOf(tr.prototype,window.Event.prototype),ts.set(window.Event.prototype,tr));u(fs,"defineRedirectDescriptor");u(hd,"defineCallDescriptor");u(dd,"defineWrapper");u(hs,"getWrapper");u(md,"wrapEvent");u(pd,"isStopped");u(gd,"setEventPhase");u(bd,"setCurrentTarget");u(ns,"setPassiveListener");yd=new WeakMap,qh=1,Lh=2,Mo=3;u(vn,"isObject");u(Br,"getListeners");u(wd,"defineEventAttributeDescriptor");u(ds,"defineEventAttribute");u(os,"defineCustomEventTarget");u(Ke,"EventTarget"),Ke.prototype={addEventListener(e,t,r){if(t==null)return;if(typeof t!="function"&&!vn(t))throw new TypeError("'listener' should be a function or an object.");let o=Br(this),a=vn(r),s=(a?r.capture:r)?qh:Lh,c={listener:t,listenerType:s,passive:a&&!!r.passive,once:a&&!!r.once,next:null},f=o.get(e);if(f===void 0){o.set(e,c);return}let m=null;for(;f!=null;){if(f.listener===t&&f.listenerType===s)return;m=f,f=f.next}m.next=c},removeEventListener(e,t,r){if(t==null)return;let o=Br(this),a=(vn(r)?r.capture:r)?qh:Lh,s=null,c=o.get(e);for(;c!=null;){if(c.listener===t&&c.listenerType===a){s!==null?s.next=c.next:c.next!==null?o.set(e,c.next):o.delete(e);return}s=c,c=c.next}},dispatchEvent(e){if(e==null||typeof e.type!="string")throw new TypeError('"event.type" should be a string.');let t=Br(this),r=e.type,o=t.get(r);if(o==null)return!0;let a=md(this,e),s=null;for(;o!=null;){if(o.once?s!==null?s.next=o.next:o.next!==null?t.set(r,o.next):t.delete(r):s=o,ns(a,o.passive?o.listener:null),typeof o.listener=="function")try{o.listener.call(this,a)}catch(c){typeof console<"u"&&typeof console.error=="function"&&console.error(c)}else o.listenerType!==Mo&&typeof o.listener.handleEvent=="function"&&o.listener.handleEvent(a);if(pd(a))break;o=o.next}return ns(a,null),gd(a,0),bd(a,null),!a.defaultPrevented}},Object.defineProperty(Ke.prototype,"constructor",{value:Ke,configurable:!0,writable:!0}),typeof window<"u"&&typeof window.EventTarget<"u"&&Object.setPrototypeOf(Ke.prototype,window.EventTarget.prototype);vd=class extends Ke{constructor(){throw super(),new TypeError("AbortSignal cannot be constructed directly")}get aborted(){let t=Qo.get(this);if(typeof t!="boolean")throw new TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`);return t}};u(vd,"AbortSignal");Vo=vd;ds(Vo.prototype,"abort");u(Ed,"createAbortSignal");u(Sd,"abortSignal");Qo=new WeakMap;Object.defineProperties(Vo.prototype,{aborted:{enumerable:!0}}),typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Vo.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});Yo=(Xa=class{constructor(){_d.set(this,Ed())}get signal(){return is(this)}abort(){Sd(is(this))}},u(Xa,"AbortController"),Xa),_d=new WeakMap;u(is,"getSignal"),Object.defineProperties(Yo.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Yo.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"});by=Object.defineProperty,yy=u((e,t)=>by(e,"name",{value:t,configurable:!0}),"e"),Rd=us;as();u(as,"s"),yy(as,"checkNodeEnvironment")});var Pe=qc(Na(),1),Dd=qc(Sh(),1);import{promises as Rn}from"fs";import _s from"path";import sw from"node:http";import lw from"node:https";Lo();Lo();ko();var wy=Object.defineProperty,Pd=(e,t)=>wy(e,"name",{value:t,configurable:!0}),vy=Object.defineProperty,Ey=Pd((e,t)=>vy(e,"name",{value:t,configurable:!0}),"e"),Ft=!!globalThis.process?.env?.FORCE_NODE_FETCH;function ms(){return!Ft&&globalThis.fetch?globalThis.fetch:Rd}Pd(ms,"p"),Ey(ms,"_getFetch");var ps=ms(),u1=!Ft&&globalThis.Blob||rr,f1=!Ft&&globalThis.File||Tr,h1=!Ft&&globalThis.FormData||Kt,Td=!Ft&&globalThis.Headers||pt,d1=!Ft&&globalThis.Request||Sn,m1=!Ft&&globalThis.Response||Je,Ad=!Ft&&globalThis.AbortController||Yo;var Sy=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,_y=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Ry=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Py(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Ty(e);return}return t}function Ty(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function Cd(e,t={}){if(typeof e!="string")return e;let r=e.trim();if(e[0]==='"'&&e.endsWith('"')&&!e.includes("\\"))return r.slice(1,-1);if(r.length<=9){let o=r.toLowerCase();if(o==="true")return!0;if(o==="false")return!1;if(o==="undefined")return;if(o==="null")return null;if(o==="nan")return Number.NaN;if(o==="infinity")return Number.POSITIVE_INFINITY;if(o==="-infinity")return Number.NEGATIVE_INFINITY}if(!Ry.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(Sy.test(e)||_y.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,Py)}return JSON.parse(e)}catch(o){if(t.strict)throw o;return e}}var y1=String.fromCharCode;var Ay=/#/g,Cy=/&/g,xy=/\//g,Iy=/=/g;var ws=/\+/g,ky=/%5e/gi,By=/%60/gi;var qy=/%7c/gi;var Ly=/%20/gi;function Oy(e){return encodeURI(""+e).replace(qy,"|")}function bs(e){return Oy(typeof e=="string"?e:JSON.stringify(e)).replace(ws,"%2B").replace(Ly,"+").replace(Ay,"%23").replace(Cy,"%26").replace(By,"`").replace(ky,"^").replace(xy,"%2F")}function gs(e){return bs(e).replace(Iy,"%3D")}function Id(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function jy(e){return Id(e.replace(ws," "))}function Fy(e){return Id(e.replace(ws," "))}function $y(e=""){let t={};e[0]==="?"&&(e=e.slice(1));for(let r of e.split("&")){let o=r.match(/([^=]+)=?(.*)/)||[];if(o.length<2)continue;let a=jy(o[1]);if(a==="__proto__"||a==="constructor")continue;let s=Fy(o[2]||"");t[a]===void 0?t[a]=s:Array.isArray(t[a])?t[a].push(s):t[a]=[t[a],s]}return t}function Dy(e,t){return(typeof t=="number"||typeof t=="boolean")&&(t=String(t)),t?Array.isArray(t)?t.map(r=>`${gs(e)}=${bs(r)}`).join("&"):`${gs(e)}=${bs(t)}`:gs(e)}function Ny(e){return Object.keys(e).filter(t=>e[t]!==void 0).map(t=>Dy(t,e[t])).filter(Boolean).join("&")}var My=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,Wy=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,zy=/^([/\\]\s*){2,}[^/\\]/;var Uy=/\/$|\/\?|\/#/,Hy=/^\.?\//;function kd(e,t={}){return typeof t=="boolean"&&(t={acceptRelative:t}),t.strict?My.test(e):Wy.test(e)||(t.acceptRelative?zy.test(e):!1)}function ys(e="",t){return t?Uy.test(e):e.endsWith("/")}function Gy(e="",t){if(!t)return(ys(e)?e.slice(0,-1):e)||"/";if(!ys(e,!0))return e||"/";let r=e,o="",a=e.indexOf("#");a>=0&&(r=e.slice(0,a),o=e.slice(a));let[s,...c]=r.split("?");return((s.endsWith("/")?s.slice(0,-1):s)||"/")+(c.length>0?`?${c.join("?")}`:"")+o}function Vy(e="",t){if(!t)return e.endsWith("/")?e:e+"/";if(ys(e,!0))return e||"/";let r=e,o="",a=e.indexOf("#");if(a>=0&&(r=e.slice(0,a),o=e.slice(a),!r))return o;let[s,...c]=r.split("?");return s+"/"+(c.length>0?`?${c.join("?")}`:"")+o}function Bd(e,t){if(Qy(t)||kd(e))return e;let r=Gy(t);return e.startsWith(r)?e:Xy(r,e)}function qd(e,t){let r=Od(e),o={...$y(r.search),...t};return r.search=Ny(o),Jy(r)}function Qy(e){return!e||e==="/"}function Yy(e){return e&&e!=="/"}function Xy(e,...t){let r=e||"";for(let o of t.filter(a=>Yy(a)))if(r){let a=o.replace(Hy,"");r=Vy(r)+a}else r=o;return r}var Ld=Symbol.for("ufo:protocolRelative");function Od(e="",t){let r=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(r){let[,y,E=""]=r;return{protocol:y.toLowerCase(),pathname:E,href:y+E,auth:"",host:"",search:"",hash:""}}if(!kd(e,{acceptRelative:!0}))return t?Od(t+e):xd(e);let[,o="",a,s=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,c="",f=""]=s.match(/([^#/?]*)(.*)?/)||[];o==="file:"&&(f=f.replace(/\/(?=[A-Za-z]:)/,""));let{pathname:m,search:g,hash:p}=xd(f);return{protocol:o.toLowerCase(),auth:a?a.slice(0,Math.max(0,a.length-1)):"",host:c,pathname:m,search:g,hash:p,[Ld]:!o}}function xd(e=""){let[t="",r="",o=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:r,hash:o}}function Jy(e){let t=e.pathname||"",r=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",o=e.hash||"",a=e.auth?e.auth+"@":"",s=e.host||"";return(e.protocol||e[Ld]?(e.protocol||"")+"//":"")+a+s+t+r+o}var qr=class extends Error{constructor(t,r){super(t,r),this.name="FetchError",r?.cause&&!this.cause&&(this.cause=r.cause)}};function Fd(e){let t=e.error?.message||e.error?.toString()||"",r=e.request?.method||e.options?.method||"GET",o=e.request?.url||String(e.request)||"/",a=`[${r}] ${JSON.stringify(o)}`,s=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",c=`${a}: ${s}${t?` ${t}`:""}`,f=new qr(c,e.error?{cause:e.error}:void 0);for(let m of["request","options","response"])Object.defineProperty(f,m,{get(){return e[m]}});for(let[m,g]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(f,m,{get(){return e.response&&e.response[g]}});return f}var Ky=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function jd(e="GET"){return Ky.has(e.toUpperCase())}function Zy(e){if(e===void 0)return!1;let t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}var ew=new Set(["image/svg","application/xml","application/xhtml","application/html"]),tw=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function rw(e=""){if(!e)return"json";let t=e.split(";").shift()||"";return tw.test(t)?"json":ew.has(t)||t.startsWith("text/")?"text":"blob"}function nw(e,t,r,o){let a=ow(t?.headers??e?.headers,r?.headers,o),s;return(r?.query||r?.params||t?.params||t?.query)&&(s={...r?.params,...r?.query,...t?.params,...t?.query}),{...r,...t,query:s,params:s,headers:a}}function ow(e,t,r){if(!t)return new r(e);let o=new r(t);if(e)for(let[a,s]of Symbol.iterator in e||Array.isArray(e)?e:new r(e))o.set(a,s);return o}async function Jo(e,t){if(t)if(Array.isArray(t))for(let r of t)await r(e);else await t(e)}var iw=new Set([408,409,425,429,500,502,503,504]),aw=new Set([101,204,205,304]);function vs(e={}){let{fetch:t=globalThis.fetch,Headers:r=globalThis.Headers,AbortController:o=globalThis.AbortController}=e;async function a(f){let m=f.error&&f.error.name==="AbortError"&&!f.options.timeout||!1;if(f.options.retry!==!1&&!m){let p;typeof f.options.retry=="number"?p=f.options.retry:p=jd(f.options.method)?0:1;let y=f.response&&f.response.status||500;if(p>0&&(Array.isArray(f.options.retryStatusCodes)?f.options.retryStatusCodes.includes(y):iw.has(y))){let E=typeof f.options.retryDelay=="function"?f.options.retryDelay(f):f.options.retryDelay||0;return E>0&&await new Promise(I=>setTimeout(I,E)),s(f.request,{...f.options,retry:p-1})}}let g=Fd(f);throw Error.captureStackTrace&&Error.captureStackTrace(g,s),g}let s=async function(m,g={}){let p={request:m,options:nw(m,g,e.defaults,r),response:void 0,error:void 0};p.options.method&&(p.options.method=p.options.method.toUpperCase()),p.options.onRequest&&await Jo(p,p.options.onRequest),typeof p.request=="string"&&(p.options.baseURL&&(p.request=Bd(p.request,p.options.baseURL)),p.options.query&&(p.request=qd(p.request,p.options.query),delete p.options.query),"query"in p.options&&delete p.options.query,"params"in p.options&&delete p.options.params),p.options.body&&jd(p.options.method)&&(Zy(p.options.body)?(p.options.body=typeof p.options.body=="string"?p.options.body:JSON.stringify(p.options.body),p.options.headers=new r(p.options.headers||{}),p.options.headers.has("content-type")||p.options.headers.set("content-type","application/json"),p.options.headers.has("accept")||p.options.headers.set("accept","application/json")):("pipeTo"in p.options.body&&typeof p.options.body.pipeTo=="function"||typeof p.options.body.pipe=="function")&&("duplex"in p.options||(p.options.duplex="half")));let y;if(!p.options.signal&&p.options.timeout){let I=new o;y=setTimeout(()=>{let R=new Error("[TimeoutError]: The operation was aborted due to timeout");R.name="TimeoutError",R.code=23,I.abort(R)},p.options.timeout),p.options.signal=I.signal}try{p.response=await t(p.request,p.options)}catch(I){return p.error=I,p.options.onRequestError&&await Jo(p,p.options.onRequestError),await a(p)}finally{y&&clearTimeout(y)}if((p.response.body||p.response._bodyInit)&&!aw.has(p.response.status)&&p.options.method!=="HEAD"){let I=(p.options.parseResponse?"json":p.options.responseType)||rw(p.response.headers.get("content-type")||"");switch(I){case"json":{let R=await p.response.text(),B=p.options.parseResponse||Cd;p.response._data=B(R);break}case"stream":{p.response._data=p.response.body||p.response._bodyInit;break}default:p.response._data=await p.response[I]()}}return p.options.onResponse&&await Jo(p,p.options.onResponse),!p.options.ignoreResponseError&&p.response.status>=400&&p.response.status<600?(p.options.onResponseError&&await Jo(p,p.options.onResponseError),await a(p)):p.response},c=async function(m,g){return(await s(m,g))._data};return c.raw=s,c.native=(...f)=>t(...f),c.create=(f={},m={})=>vs({...e,...m,defaults:{...e.defaults,...m.defaults,...f}}),c}function cw(){if(!JSON.parse(process.env.FETCH_KEEP_ALIVE||"false"))return ps;let t={keepAlive:!0},r=new sw.Agent(t),o=new lw.Agent(t),a={agent(s){return s.protocol==="http:"?r:o}};return function(c,f){return ps(c,{...a,...f})}}var uw=globalThis.fetch?(...e)=>globalThis.fetch(...e):cw(),fw=globalThis.Headers||Td,hw=globalThis.AbortController||Ad,Ko=vs({fetch:uw,Headers:fw,AbortController:hw});import{z as Ue}from"zod";var dw={default:{labelColour:"#dff6f5",valueColour:"#f2bd59",usernameColour:"#dff6f5"},christmas:{labelColour:"#ffffff",valueColour:"#94edff",usernameColour:"#ffffff"}},Es=Ue.string().regex(/^#[0-9a-f]{6}$/),k1=Ue.object({ext:Ue.union([Ue.literal(".gif"),Ue.literal(".webp")]).default(".gif"),stats:Ue.union([Ue.literal("dragons"),Ue.literal("garden")]).default("garden"),style:Ue.union([Ue.literal("default"),Ue.literal("christmas")]).default("default"),usernameColour:Es.optional(),labelColour:Es.optional(),valueColour:Es.optional()}).transform(e=>({...dw[e.style],...e}));function Ss(e){if(e.grow!=="0")return"Adult";if(e.grow==="0"&&e.hatch!=="0")return"Hatchling";if(e.hatch==="0")return"Egg"}function $d(e){let t=e.start==="0",r=e.hoursleft===-2,o=!t&&e.hoursleft===-1&&Ss(e)!=="Adult";return{dead:r,hidden:t,frozen:o}}async function mw(e){let t=await(async()=>{switch(e.data.stats){case"dragons":return e.data.data=await Sw(e.data),yw;case"garden":return bw;default:throw new Error("Invalid handler")}})(),r=await pw(e.data,o=>t(o,e.data));if(r.error&&console.error(r.error),r.error==="API Timeout")throw new Error(r.error);return{performanceData:r}}var Rs=327,Ps=61,_n=106;async function pw(e,t){let r={dragonsIncluded:null,dragonsOmitted:null,statGenTime:null,dragonFetchTime:null,dragonGenTime:null,frameGenTime:null,gifGenTime:null,totalTime:null,error:null},o=performance.now(),a=()=>o=performance.now(),s=()=>performance.now()-o;try{let c=_s.dirname(e.filePath);await Rn.mkdir(c,{recursive:!0});let f=o;a();let m=await gw(e),g=await Zo(Rs,Ps).composite(await t(m)).png().toBuffer();if(r.statGenTime=s(),e.dragons.length>0){a();let{dragonsIncluded:p,dragonsOmitted:y,dragonBuffers:E}=await ww(e.dragons,e.secret);r.dragonFetchTime=s(),r.dragonsIncluded=p,r.dragonsOmitted=y,a();let{stripBuffer:I,stripWidth:R,stripHeight:B}=await vw(E);r.dragonGenTime=s(),a();let O=await Ew(g,I,R,B);r.frameGenTime=s(),a(),await(await Dd.default.createGif({delay:100,repeat:0,format:"rgb444"}).addFrame(O).toSharp()).toFile(`${e.filePath}.tmp`),r.gifGenTime=s()}else r.dragonsIncluded=[],r.dragonsOmitted=[],r.dragonFetchTime=0,r.dragonGenTime=0,r.frameGenTime=0,a(),await(0,Pe.default)(g).gif().toFile(`${e.filePath}.tmp`),r.gifGenTime=s();r.totalTime=performance.now()-f,await Rw(e.filePath)}catch(c){r.error=c===23?"API Timeout":c,await Rn.unlink(`${e.filePath}.tmp`).catch(()=>{})}return r}async function gw(e){let t=[{input:_s.resolve("/src/resources/public/share/scroll/",e.requestParameters.style+".webp"),top:0,left:0}],r=await Ts(e.user.username,"16px Alkhemikal",`fill: ${e.requestParameters.usernameColour};`),{height:o,width:a}=await(0,Pe.default)(r).metadata();if(t.push({input:r,top:25-(o??0),left:118}),e.user.flairPath){let s=_s.resolve("/src/resources/public",e.user.flairPath),c=(0,Pe.default)(s).greyscale().threshold(255).composite([{input:Buffer.from([255,255,255,Math.ceil(255/5)]),raw:{width:1,height:1,channels:4},tile:!0,blend:"dest-in"}]).extend({top:1,left:1,extendWith:"background",background:"transparent"}).png(),[{height:f},m]=await Promise.all([(0,Pe.default)(s).png().metadata(),c.toBuffer()]),g=await(0,Pe.default)(m).composite([{input:s,left:0,top:0}]).png().toBuffer();t.push({input:g,left:121+(a??0),top:16-Math.floor((f??0)/2)})}return t}async function bw(e,t){let r=f=>Ts(`
        <tspan fill="${t.requestParameters.labelColour}">Ranked</tspan> 
        <tspan fill="${t.requestParameters.valueColour}">#${f}</tspan>
      `,"8px Nokia Cellphone FC",""),[o,a,s,c]=await Promise.all([nr(t,"Weekly Clicks",t.data.weeklyClicks),t.data.weeklyRank?r(t.data.weeklyRank):null,nr(t,"All-time Clicks",t.data.allTimeClicks),t.data.allTimeRank?r(t.data.allTimeRank):null]);return e.push({input:o,left:118,top:28},{input:s,left:118,top:40}),a&&e.push({input:a,left:245,top:29}),c&&e.push({input:c,left:245,top:41}),e}async function yw(e,t){let[r,o,a,s,c]=await Promise.all([nr(t,"Total",t.data.total),nr(t,"Frozen",t.data.frozen),nr(t,"Eggs",t.data.eggs),nr(t,"Hatch",t.data.hatch),nr(t,"Adults",t.data.adult)]);return e.push({input:r,left:118,top:28},{input:o,left:118,top:40},{input:a,left:190,top:28},{input:s,left:190,top:40},{input:c,left:240,top:28}),e}async function ww(e,t){try{let o=[],a=[],{errors:s,dragons:c}=await Ko("https://dragcave.net/api/v2/dragons",{headers:{Authorization:`Bearer ${t}`},query:{ids:e.join(",")},retry:3,retryDelay:1e3,timeout:1e4});if(s.length>0)throw new Error("Errors getting bulk dragons: "+s);Object.keys(c).forEach(m=>{("hoursleft"in c[m]&&c[m].hoursleft>0?o:a).push(m)});let f=await Promise.all(o.map(async m=>Buffer.from(await Ko(`https://dragcave.net/image/${m}.gif`,{retry:3,retryDelay:1e3,timeout:1e4,responseType:"arrayBuffer"}))));return{dragonsIncluded:o,dragonsOmitted:a,dragonBuffers:f}}catch(r){throw r instanceof qr&&(r.cause?.code??0)===23?23:r}}async function vw(e){let t=await Promise.all(e.map(g=>(0,Pe.default)(g).metadata())),r=2,o=49,a=t.reduce((g,p)=>g+(p.width??0)+r,0),s=Zo(a,o),c=[],f=[0];return t.forEach(g=>{let p=f[f.length-1];f.push(p+(g.width??0)+r)}),e.forEach((g,p)=>{c.push({input:g,top:o-(t[p].height??0),left:f[p]})}),{stripBuffer:await s.composite(c).png().toBuffer(),stripWidth:a,stripHeight:o}}async function Ew(e,t,r,o){let a=[];if(r<_n){let s=await Zo(Rs,Ps).composite([{input:e,top:0,left:0},{input:t,top:5,left:Math.floor(_n/2)-Math.floor(r/2)+5}]).png().toBuffer();a.push((0,Pe.default)(s))}else for(let s=0;s<r;s+=2)a.push(_w(s,e,t,r,o));return Promise.all(a)}async function Sw(e){let{errors:t,dragons:r}=await Ko("https://dragcave.net/api/v2/user",{headers:{Authorization:`Bearer ${e.secret}`},query:{username:e.user.username,limit:99999,filter:"ALL"},retry:3,retryDelay:1e3}),o={female:0,male:0,eggs:0,hatch:0,adult:0,frozen:0,total:0};for(let a in r){let s=r[a];s.gender==="Female"?o.female++:s.gender==="Male"&&o.male++;let c=Ss(s),f=$d(s);o.total++,!f.hidden&&(f.frozen?o.frozen++:c==="Adult"?o.adult++:c==="Hatchling"&&!f.dead?o.hatch++:c==="Egg"&&!f.dead&&o.eggs++)}if(t.length>0)throw new Error("Errors getting stats: "+t);return o}function nr(e,t,r){return Ts(`
      <tspan fill="${e.requestParameters.labelColour}">${t}:</tspan> 
      <tspan fill="${e.requestParameters.valueColour}">${Intl.NumberFormat().format(r)}</tspan>
    `,"8px Nokia Cellphone FC","")}async function Ts(e,t,r){let{width:o,height:a}=await(0,Pe.default)(Buffer.from(`<svg>
        <text style="font: ${t};">${e}</text>
      </svg>`)).png().metadata();return(0,Pe.default)(Buffer.from(`<svg width="${(o??0)+1}" height="${(a??0)+4}">
        <style>
          .text {
            font: ${t};
            filter: drop-shadow(1px 1px 0px rgba(0, 0, 0, 0.25));
            ${r}
          }
        </style>
        <text y="${(a??0)+1}" class="text">${e}</text>
      </svg>`)).png().toBuffer()}function Zo(e,t){return(0,Pe.default)({create:{width:e,height:t,channels:4,background:{r:0,g:0,b:0,alpha:0}}})}async function _w(e,t,r,o,a){let s=e%o,c=Math.min(_n,o-s),f=(0,Pe.default)(r).extract({left:s,top:0,width:c,height:a}),m=Zo(Rs,Ps),g=[{input:t,top:0,left:0},{input:await f.toBuffer(),top:5,left:5}];if(c<_n){let p=_n-c,y=Math.min(p,o),E=(0,Pe.default)(r).extract({left:0,top:0,width:y,height:a});g.push({input:await E.toBuffer(),top:5,left:c+5})}return(0,Pe.default)(await m.composite(g).png().toBuffer())}async function Rw(e){await Pw(e)&&await Rn.unlink(e),await Rn.rename(`${e}.tmp`,e)}async function Pw(e){try{return await Rn.stat(e),!0}catch{return!1}}export{mw as default};
/*! Bundled license information:

node-fetch-native/dist/node.mjs:
  (**
  * @license
  * web-streams-polyfill v3.3.3
  * Copyright 2024 Mattias Buelens, Diwank Singh Tomer and other contributors.
  * This code is released under the MIT license.
  * SPDX-License-Identifier: MIT
  *)
  (*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
  (*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
  (*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
*/
